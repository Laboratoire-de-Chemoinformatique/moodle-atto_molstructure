var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(n){var E=0;return function(){return E<n.length?{done:!1,value:n[E++]}:{done:!0}}};$jscomp.arrayIterator=function(n){return{next:$jscomp.arrayIteratorImpl(n)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(n,E,x){if(n==Array.prototype||n==Object.prototype)return n;n[E]=x.value;return n};$jscomp.getGlobal=function(n){n=["object"==typeof globalThis&&globalThis,n,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var E=0;E<n.length;++E){var x=n[E];if(x&&x.Math==Math)return x}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(n,E){var x=$jscomp.propertyToPolyfillSymbol[E];if(null==x)return n[E];x=n[x];return void 0!==x?x:n[E]};
$jscomp.polyfill=function(n,E,x,v){E&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(n,E,x,v):$jscomp.polyfillUnisolated(n,E,x,v))};$jscomp.polyfillUnisolated=function(n,E,x,v){x=$jscomp.global;n=n.split(".");for(v=0;v<n.length-1;v++){var k=n[v];if(!(k in x))return;x=x[k]}n=n[n.length-1];v=x[n];E=E(v);E!=v&&null!=E&&$jscomp.defineProperty(x,n,{configurable:!0,writable:!0,value:E})};
$jscomp.polyfillIsolated=function(n,E,x,v){var k=n.split(".");n=1===k.length;v=k[0];v=!n&&v in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var p=0;p<k.length-1;p++){var d=k[p];if(!(d in v))return;v=v[d]}k=k[k.length-1];x=$jscomp.IS_SYMBOL_NATIVE&&"es6"===x?v[k]:null;E=E(x);null!=E&&(n?$jscomp.defineProperty($jscomp.polyfills,k,{configurable:!0,writable:!0,value:E}):E!==x&&(void 0===$jscomp.propertyToPolyfillSymbol[k]&&(x=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[k]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(k):$jscomp.POLYFILL_PREFIX+x+"$"+k),$jscomp.defineProperty(v,$jscomp.propertyToPolyfillSymbol[k],{configurable:!0,writable:!0,value:E})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(n){if(n)return n;var E=function(p,d){this.$jscomp$symbol$id_=p;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:d})};E.prototype.toString=function(){return this.$jscomp$symbol$id_};var x="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",v=0,k=function(p){if(this instanceof k)throw new TypeError("Symbol is not a constructor");return new E(x+(p||"")+"_"+v++,p)};return k},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(n){if(n)return n;n=Symbol("Symbol.iterator");for(var E="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),x=0;x<E.length;x++){var v=$jscomp.global[E[x]];"function"===typeof v&&"function"!=typeof v.prototype[n]&&$jscomp.defineProperty(v.prototype,n,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return n},"es6",
"es3");$jscomp.iteratorPrototype=function(n){n={next:n};n[Symbol.iterator]=function(){return this};return n};$jscomp.makeIterator=function(n){var E="undefined"!=typeof Symbol&&Symbol.iterator&&n[Symbol.iterator];return E?E.call(n):$jscomp.arrayIterator(n)};$jscomp.arrayFromIterator=function(n){for(var E,x=[];!(E=n.next()).done;)x.push(E.value);return x};$jscomp.arrayFromIterable=function(n){return n instanceof Array?n:$jscomp.arrayFromIterator($jscomp.makeIterator(n))};
$jscomp.findInternal=function(n,E,x){n instanceof String&&(n=String(n));for(var v=n.length,k=0;k<v;k++){var p=n[k];if(E.call(x,p,k,n))return{i:k,v:p}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(n){return n?n:function(E,x){return $jscomp.findInternal(this,E,x).v}},"es6","es3");
$jscomp.checkStringArgs=function(n,E,x){if(null==n)throw new TypeError("The 'this' value for String.prototype."+x+" must not be null or undefined");if(E instanceof RegExp)throw new TypeError("First argument to String.prototype."+x+" must not be a regular expression");return n+""};
$jscomp.polyfill("String.prototype.startsWith",function(n){return n?n:function(E,x){var v=$jscomp.checkStringArgs(this,E,"startsWith");E+="";var k=v.length,p=E.length;x=Math.max(0,Math.min(x|0,v.length));for(var d=0;d<p&&x<k;)if(v[x++]!=E[d++])return!1;return d>=p}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(n){return n?n:function(E,x,v){var k=this.length||0;0>x&&(x=Math.max(0,k+x));if(null==v||v>k)v=k;v=Number(v);0>v&&(v=Math.max(0,k+v));for(x=Number(x||0);x<v;x++)this[x]=E;return this}},"es6","es3");$jscomp.typedArrayFill=function(n){return n?n:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");var ChemDoodle=function(){var n={iChemLabs:{},informatics:{},io:{},lib:{},notations:{},structures:{}};n.structures.d2={};n.structures.d3={};n.getVersion=function(){return"9.4.0"};return n}();
(function(n,E,x){(function(v,k){"object"===typeof module&&"object"===typeof module.exports?module.exports=v.document?k(v,!0):function(p){if(!p.document)throw Error("jQuery requires a window with a document");return k(p)}:k(v)})("undefined"!==typeof n?n:this,function(v,k){function p(h){var u=!!h&&"length"in h&&h.length,z=C.type(h);return"function"===z||C.isWindow(h)?!1:"array"===z||0===u||"number"===typeof u&&0<u&&u-1 in h}function d(h,u,z){if(C.isFunction(u))return C.grep(h,function(D,H){return!!u.call(D,
H,D)!==z});if(u.nodeType)return C.grep(h,function(D){return D===u!==z});if("string"===typeof u){if(pc.test(u))return C.filter(u,h,z);u=C.filter(u,h)}return C.grep(h,function(D){return-1<Gb.call(u,D)!==z})}function e(h,u){for(;(h=h[u])&&1!==h.nodeType;);return h}function c(h){var u={};C.each(h.match(fb)||[],function(z,D){u[D]=!0});return u}function a(){oa.removeEventListener("DOMContentLoaded",a);v.removeEventListener("load",a);C.ready()}function f(){this.expando=C.expando+f.uid++}function m(h,u,z){if(z===
x&&1===h.nodeType)if(z="data-"+u.replace(Zb,"-$&").toLowerCase(),z=h.getAttribute(z),"string"===typeof z){try{z="true"===z?!0:"false"===z?!1:"null"===z?null:+z+""===z?+z:qc.test(z)?C.parseJSON(z):z}catch(D){}Oa.set(h,u,z)}else z=x;return z}function q(h,u,z,D){var H=1,J=20,M=D?function(){return D.cur()}:function(){return C.css(h,u,"")},Q=M(),R=z&&z[3]||(C.cssNumber[u]?"":"px"),T=(C.cssNumber[u]||"px"!==R&&+Q)&&vb.exec(C.css(h,u));if(T&&T[3]!==R){R=R||T[3];z=z||[];T=+Q||1;do H=H||".5",T/=H,C.style(h,
u,T+R);while(H!==(H=M()/Q)&&1!==H&&--J)}if(z){T=+T||+Q||0;var ha=z[1]?T+(z[1]+1)*z[2]:+z[2];D&&(D.unit=R,D.start=T,D.end=ha)}return ha}function l(h,u){var z="undefined"!==typeof h.getElementsByTagName?h.getElementsByTagName(u||"*"):"undefined"!==typeof h.querySelectorAll?h.querySelectorAll(u||"*"):[];return u===x||u&&C.nodeName(h,u)?C.merge([h],z):z}function r(h,u){for(var z=0,D=h.length;z<D;z++)wa.set(h[z],"globalEval",!u||wa.get(u[z],"globalEval"))}function y(h,u,z,D,H){for(var J,M,Q,R=u.createDocumentFragment(),
T=[],ha=0,na=h.length;ha<na;ha++)if((J=h[ha])||0===J)if("object"===C.type(J))C.merge(T,J.nodeType?[J]:J);else if(Pc.test(J)){M=M||R.appendChild(u.createElement("div"));Q=($b.exec(J)||["",""])[1].toLowerCase();Q=ab[Q]||ab._default;M.innerHTML=Q[1]+C.htmlPrefilter(J)+Q[2];for(Q=Q[0];Q--;)M=M.lastChild;C.merge(T,M.childNodes);M=R.firstChild;M.textContent=""}else T.push(u.createTextNode(J));R.textContent="";for(ha=0;J=T[ha++];)if(D&&-1<C.inArray(J,D))H&&H.push(J);else if(h=C.contains(J.ownerDocument,
J),M=l(R.appendChild(J),"script"),h&&r(M),z)for(Q=0;J=M[Q++];)Hb.test(J.type||"")&&z.push(J);return R}function w(){return!0}function A(){return!1}function G(){try{return oa.activeElement}catch(h){}}function b(h,u,z,D,H,J){var M;if("object"===typeof u){"string"!==typeof z&&(D=D||z,z=x);for(M in u)b(h,M,z,D,u[M],J);return h}null==D&&null==H?(H=z,D=z=x):null==H&&("string"===typeof z?(H=D,D=x):(H=D,D=z,z=x));if(!1===H)H=A;else if(!H)return h;if(1===J){var Q=H;H=function(R){C().off(R);return Q.apply(this,
arguments)};H.guid=Q.guid||(Q.guid=C.guid++)}return h.each(function(){C.event.add(this,u,H,D,z)})}function g(h,u){return C.nodeName(h,"table")&&C.nodeName(11!==u.nodeType?u:u.firstChild,"tr")?h.getElementsByTagName("tbody")[0]||h.appendChild(h.ownerDocument.createElement("tbody")):h}function t(h){h.type=(null!==h.getAttribute("type"))+"/"+h.type;return h}function B(h){var u=Qc.exec(h.type);u?h.type=u[1]:h.removeAttribute("type");return h}function F(h,u){var z,D;if(1===u.nodeType){if(wa.hasData(h)){var H=
wa.access(h);var J=wa.set(u,H);if(H=H.events)for(D in delete J.handle,J.events={},H)for(J=0,z=H[D].length;J<z;J++)C.event.add(u,D,H[D][J])}Oa.hasData(h)&&(h=Oa.access(h),h=C.extend({},h),Oa.set(u,h))}}function I(h,u,z,D){u=rc.apply([],u);var H,J=0,M=h.length,Q=M-1,R=u[0],T=C.isFunction(R);if(T||1<M&&"string"===typeof R&&!Ia.checkClone&&Rc.test(R))return h.each(function(Pa){var Fa=h.eq(Pa);T&&(u[0]=R.call(this,Pa,Fa.html()));I(Fa,u,z,D)});if(M){var ha=y(u,h[0].ownerDocument,!1,h,D);var na=ha.firstChild;
1===ha.childNodes.length&&(ha=na);if(na||D){na=C.map(l(ha,"script"),t);for(H=na.length;J<M;J++){var pa=ha;J!==Q&&(pa=C.clone(pa,!0,!0),H&&C.merge(na,l(pa,"script")));z.call(h[J],pa,J)}if(H)for(ha=na[na.length-1].ownerDocument,C.map(na,B),J=0;J<H;J++)pa=na[J],Hb.test(pa.type||"")&&!wa.access(pa,"globalEval")&&C.contains(ha,pa)&&(pa.src?C._evalUrl&&C._evalUrl(pa.src):C.globalEval(pa.textContent.replace(Ib,"")))}}return h}function L(h,u,z){for(var D=u?C.filter(u,h):h,H=0;null!=(u=D[H]);H++)z||1!==u.nodeType||
C.cleanData(l(u)),u.parentNode&&(z&&C.contains(u.ownerDocument,u)&&r(l(u,"script")),u.parentNode.removeChild(u));return h}function O(h,u){h=C(u.createElement(h)).appendTo(u.body);u=C.css(h[0],"display");h.detach();return u}function S(h){var u=oa,z=gb[h];z||(z=O(h,u),"none"!==z&&z||(Jb=(Jb||C("<iframe frameborder='0' width='0' height='0'/>")).appendTo(u.documentElement),u=Jb[0].contentDocument,u.write(),u.close(),z=O(h,u),Jb.detach()),gb[h]=z);return z}function W(h,u,z){var D=h.style;var H=(z=z||Ga(h))?
z.getPropertyValue(u)||z[u]:x;""!==H&&H!==x||C.contains(h.ownerDocument,h)||(H=C.style(h,u));if(z&&!Ia.pixelMarginRight()&&Vb.test(H)&&hb.test(u)){h=D.width;u=D.minWidth;var J=D.maxWidth;D.minWidth=D.maxWidth=D.width=H;H=z.width;D.width=h;D.minWidth=u;D.maxWidth=J}return H!==x?H+"":H}function V(h,u){return{get:function(){if(h())delete this.get;else return(this.get=u).apply(this,arguments)}}}function Z(h){if(h in sc)return h;for(var u=h[0].toUpperCase()+h.slice(1),z=tc.length;z--;)if(h=tc[z]+u,h in
sc)return h}function ba(h,u,z){return(h=vb.exec(u))?Math.max(0,h[2]-(z||0))+(h[3]||"px"):u}function X(h,u,z,D,H){u=z===(D?"border":"content")?4:"width"===u?1:0;for(var J=0;4>u;u+=2)"margin"===z&&(J+=C.css(h,z+qb[u],!0,H)),D?("content"===z&&(J-=C.css(h,"padding"+qb[u],!0,H)),"margin"!==z&&(J-=C.css(h,"border"+qb[u]+"Width",!0,H))):(J+=C.css(h,"padding"+qb[u],!0,H),"padding"!==z&&(J+=C.css(h,"border"+qb[u]+"Width",!0,H)));return J}function ea(h,u,z){var D=!0,H="width"===u?h.offsetWidth:h.offsetHeight,
J=Ga(h),M="border-box"===C.css(h,"boxSizing",!1,J);if(0>=H||null==H){H=W(h,u,J);if(0>H||null==H)H=h.style[u];if(Vb.test(H))return H;D=M&&(Ia.boxSizingReliable()||H===h.style[u]);H=parseFloat(H)||0}return H+X(h,u,z||(M?"border":"content"),D,J)+"px"}function Y(h,u){for(var z,D,H,J=[],M=0,Q=h.length;M<Q;M++)D=h[M],D.style&&(J[M]=wa.get(D,"olddisplay"),z=D.style.display,u?(J[M]||"none"!==z||(D.style.display=""),""===D.style.display&&rb(D)&&(J[M]=wa.access(D,"olddisplay",S(D.nodeName)))):(H=rb(D),"none"===
z&&H||wa.set(D,"olddisplay",H?z:C.css(D,"display"))));for(M=0;M<Q;M++)D=h[M],!D.style||u&&"none"!==D.style.display&&""!==D.style.display||(D.style.display=u?J[M]||"":"none");return h}function aa(h,u,z,D,H){return new aa.prototype.init(h,u,z,D,H)}function da(){v.setTimeout(function(){Bb=x});return Bb=C.now()}function ia(h,u){var z=0,D={height:h};for(u=u?1:0;4>z;z+=2-u){var H=qb[z];D["margin"+H]=D["padding"+H]=h}u&&(D.opacity=D.width=h);return D}function ja(h,u,z){for(var D,H=(ra.tweeners[u]||[]).concat(ra.tweeners["*"]),
J=0,M=H.length;J<M;J++)if(D=H[J].call(z,u,h))return D}function la(h,u){var z,D;for(z in h){var H=C.camelCase(z);var J=u[H];var M=h[z];C.isArray(M)&&(J=M[1],M=h[z]=M[0]);z!==H&&(h[H]=M,delete h[z]);if((D=C.cssHooks[H])&&"expand"in D)for(z in M=D.expand(M),delete h[H],M)z in h||(h[z]=M[z],u[z]=J);else u[H]=J}}function ra(h,u,z){var D,H=0,J=ra.prefilters.length,M=C.Deferred().always(function(){delete Q.elem}),Q=function(){if(D)return!1;var T=Bb||da();T=Math.max(0,R.startTime+R.duration-T);for(var ha=
1-(T/R.duration||0),na=0,pa=R.tweens.length;na<pa;na++)R.tweens[na].run(ha);M.notifyWith(h,[R,ha,T]);if(1>ha&&pa)return T;M.resolveWith(h,[R]);return!1},R=M.promise({elem:h,props:C.extend({},u),opts:C.extend(!0,{specialEasing:{},easing:C.easing._default},z),originalProperties:u,originalOptions:z,startTime:Bb||da(),duration:z.duration,tweens:[],createTween:function(T,ha){T=C.Tween(h,R.opts,T,ha,R.opts.specialEasing[T]||R.opts.easing);R.tweens.push(T);return T},stop:function(T){var ha=0,na=T?R.tweens.length:
0;if(D)return this;for(D=!0;ha<na;ha++)R.tweens[ha].run(1);T?(M.notifyWith(h,[R,1,0]),M.resolveWith(h,[R,T])):M.rejectWith(h,[R,T]);return this}});z=R.props;for(la(z,R.opts.specialEasing);H<J;H++)if(u=ra.prefilters[H].call(R,h,z,R.opts))return C.isFunction(u.stop)&&(C._queueHooks(R.elem,R.opts.queue).stop=C.proxy(u.stop,u)),u;C.map(z,ja,R);C.isFunction(R.opts.start)&&R.opts.start.call(h,R);C.fx.timer(C.extend(Q,{elem:h,anim:R,queue:R.opts.queue}));return R.progress(R.opts.progress).done(R.opts.done,
R.opts.complete).fail(R.opts.fail).always(R.opts.always)}function za(h){return h.getAttribute&&h.getAttribute("class")||""}function Ba(h){return function(u,z){"string"!==typeof u&&(z=u,u="*");var D=0,H=u.toLowerCase().match(fb)||[];if(C.isFunction(z))for(;u=H[D++];)"+"===u[0]?(u=u.slice(1)||"*",(h[u]=h[u]||[]).unshift(z)):(h[u]=h[u]||[]).push(z)}}function Ra(h,u,z,D){function H(Q){var R;J[Q]=!0;C.each(h[Q]||[],function(T,ha){T=ha(u,z,D);if("string"===typeof T&&!M&&!J[T])return u.dataTypes.unshift(T),
H(T),!1;if(M)return!(R=T)});return R}var J={},M=h===ac;return H(u.dataTypes[0])||!J["*"]&&H("*")}function Sa(h,u){var z,D,H=C.ajaxSettings.flatOptions||{};for(z in u)u[z]!==x&&((H[z]?h:D||(D={}))[z]=u[z]);D&&C.extend(!0,h,D);return h}function Ta(h,u,z,D){var H;if(C.isArray(u))C.each(u,function(J,M){z||uc.test(h)?D(h,M):Ta(h+"["+("object"===typeof M&&null!=M?J:"")+"]",M,z,D)});else if(z||"object"!==C.type(u))D(h,u);else for(H in u)Ta(h+"["+H+"]",u[H],z,D)}function Qa(h){return C.isWindow(h)?h:9===
h.nodeType&&h.defaultView}var Va=[],oa=v.document,mb=Va.slice,rc=Va.concat,bc=Va.push,Gb=Va.indexOf,Kb={},cc=Kb.toString,wb=Kb.hasOwnProperty,Ia={},C=function(h,u){return new C.fn.init(h,u)},Sc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Tc=/^-ms-/,vc=/-([\da-z])/gi,wc=function(h,u){return u.toUpperCase()};C.fn=C.prototype={jquery:"2.2.4",constructor:C,selector:"",length:0,toArray:function(){return mb.call(this)},get:function(h){return null!=h?0>h?this[h+this.length]:this[h]:mb.call(this)},pushStack:function(h){h=
C.merge(this.constructor(),h);h.prevObject=this;h.context=this.context;return h},each:function(h){return C.each(this,h)},map:function(h){return this.pushStack(C.map(this,function(u,z){return h.call(u,z,u)}))},slice:function(){return this.pushStack(mb.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(h){var u=this.length;h=+h+(0>h?u:0);return this.pushStack(0<=h&&h<u?[this[h]]:[])},end:function(){return this.prevObject||this.constructor()},
push:bc,sort:Va.sort,splice:Va.splice};C.extend=C.fn.extend=function(){var h,u,z,D=arguments[0]||{},H=1,J=arguments.length,M=!1;"boolean"===typeof D&&(M=D,D=arguments[H]||{},H++);"object"===typeof D||C.isFunction(D)||(D={});H===J&&(D=this,H--);for(;H<J;H++)if(null!=(h=arguments[H]))for(u in h){var Q=D[u];var R=h[u];D!==R&&(M&&R&&(C.isPlainObject(R)||(z=C.isArray(R)))?(z?(z=!1,Q=Q&&C.isArray(Q)?Q:[]):Q=Q&&C.isPlainObject(Q)?Q:{},D[u]=C.extend(M,Q,R)):R!==x&&(D[u]=R))}return D};C.extend({expando:"jQuery"+
("2.2.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(h){throw Error(h);},noop:function(){},isFunction:function(h){return"function"===C.type(h)},isArray:Array.isArray,isWindow:function(h){return null!=h&&h===h.window},isNumeric:function(h){var u=h&&h.toString();return!C.isArray(h)&&0<=u-parseFloat(u)+1},isPlainObject:function(h){var u;if("object"!==C.type(h)||h.nodeType||C.isWindow(h)||h.constructor&&!wb.call(h,"constructor")&&!wb.call(h.constructor.prototype||{},"isPrototypeOf"))return!1;
for(u in h);return u===x||wb.call(h,u)},isEmptyObject:function(h){for(var u in h)return!1;return!0},type:function(h){return null==h?h+"":"object"===typeof h||"function"===typeof h?Kb[cc.call(h)]||"object":typeof h},globalEval:function(h){var u=eval;if(h=C.trim(h))1===h.indexOf("use strict")?(u=oa.createElement("script"),u.text=h,oa.head.appendChild(u).parentNode.removeChild(u)):u(h)},camelCase:function(h){return h.replace(Tc,"ms-").replace(vc,wc)},nodeName:function(h,u){return h.nodeName&&h.nodeName.toLowerCase()===
u.toLowerCase()},each:function(h,u){var z,D=0;if(p(h))for(z=h.length;D<z&&!1!==u.call(h[D],D,h[D]);D++);else for(D in h)if(!1===u.call(h[D],D,h[D]))break;return h},trim:function(h){return null==h?"":(h+"").replace(Sc,"")},makeArray:function(h,u){u=u||[];null!=h&&(p(Object(h))?C.merge(u,"string"===typeof h?[h]:h):bc.call(u,h));return u},inArray:function(h,u,z){return null==u?-1:Gb.call(u,h,z)},merge:function(h,u){for(var z=+u.length,D=0,H=h.length;D<z;D++)h[H++]=u[D];h.length=H;return h},grep:function(h,
u,z){for(var D=[],H=0,J=h.length,M=!z;H<J;H++)z=!u(h[H],H),z!==M&&D.push(h[H]);return D},map:function(h,u,z){var D,H=0,J=[];if(p(h))for(D=h.length;H<D;H++){var M=u(h[H],H,z);null!=M&&J.push(M)}else for(H in h)M=u(h[H],H,z),null!=M&&J.push(M);return rc.apply([],J)},guid:1,proxy:function(h,u){if("string"===typeof u){var z=h[u];u=h;h=z}if(!C.isFunction(h))return x;var D=mb.call(arguments,2);z=function(){return h.apply(u||this,D.concat(mb.call(arguments)))};z.guid=h.guid=h.guid||C.guid++;return z},now:Date.now,
support:Ia});"function"===typeof Symbol&&(C.fn[Symbol.iterator]=Va[Symbol.iterator]);C.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(h,u){Kb["[object "+u+"]"]=u.toLowerCase()});var Ab=function(h){function u(K,P,N,U){var ca,ka,fa,qa,ma=P&&P.ownerDocument,ta=P?P.nodeType:9;N=N||[];if("string"!==typeof K||!K||1!==ta&&9!==ta&&11!==ta)return N;if(!U&&((P?P.ownerDocument||P:Ha)!==ua&&Lb(P),P=P||ua,Ja)){if(11!==ta&&(qa=rd.exec(K)))if(ca=qa[1])if(9===ta)if(ka=
P.getElementById(ca)){if(ka.id===ca)return N.push(ka),N}else return N;else{if(ma&&(ka=ma.getElementById(ca))&&db(P,ka)&&ka.id===ca)return N.push(ka),N}else{if(qa[2])return Cb.apply(N,P.getElementsByTagName(K)),N;if((ca=qa[3])&&Ka.getElementsByClassName&&P.getElementsByClassName)return Cb.apply(N,P.getElementsByClassName(ca)),N}if(!(!Ka.qsa||bb[K+" "]||Da&&Da.test(K))){if(1!==ta){ma=P;var Aa=K}else if("object"!==P.nodeName.toLowerCase()){(fa=P.getAttribute("id"))?fa=fa.replace(sd,"\\$&"):P.setAttribute("id",
fa=Ca);qa=xc(K);ca=qa.length;for(ka=nd.test(fa)?"#"+fa:"[id='"+fa+"']";ca--;)qa[ca]=ka+" "+pa(qa[ca]);Aa=qa.join(",");ma=Uc.test(K)&&ha(P.parentNode)||P}if(Aa)try{return Cb.apply(N,ma.querySelectorAll(Aa)),N}catch(sa){}finally{fa===Ca&&P.removeAttribute("id")}}}return td(K.replace(yc,"$1"),P,N,U)}function z(){function K(N,U){P.push(N+" ")>Ea.cacheLength&&delete K[P.shift()];return K[N+" "]=U}var P=[];return K}function D(K){K[Ca]=!0;return K}function H(K){var P=ua.createElement("div");try{return!!K(P)}catch(N){return!1}finally{P.parentNode&&
P.parentNode.removeChild(P)}}function J(K,P){K=K.split("|");for(var N=K.length;N--;)Ea.attrHandle[K[N]]=P}function M(K,P){var N=P&&K,U=N&&1===K.nodeType&&1===P.nodeType&&(~P.sourceIndex||-2147483648)-(~K.sourceIndex||-2147483648);if(U)return U;if(N)for(;N=N.nextSibling;)if(N===P)return-1;return K?1:-1}function Q(K){return function(P){return"input"===P.nodeName.toLowerCase()&&P.type===K}}function R(K){return function(P){var N=P.nodeName.toLowerCase();return("input"===N||"button"===N)&&P.type===K}}
function T(K){return D(function(P){P=+P;return D(function(N,U){for(var ca,ka=K([],N.length,P),fa=ka.length;fa--;)N[ca=ka[fa]]&&(N[ca]=!(U[ca]=N[ca]))})})}function ha(K){return K&&"undefined"!==typeof K.getElementsByTagName&&K}function na(){}function pa(K){for(var P=0,N=K.length,U="";P<N;P++)U+=K[P].value;return U}function Pa(K,P,N){var U=P.dir,ca=N&&"parentNode"===U,ka=nb++;return P.first?function(fa,qa,ma){for(;fa=fa[U];)if(1===fa.nodeType||ca)return K(fa,qa,ma)}:function(fa,qa,ma){var ta,Aa=[Xa,
ka];if(ma)for(;fa=fa[U];){if((1===fa.nodeType||ca)&&K(fa,qa,ma))return!0}else for(;fa=fa[U];)if(1===fa.nodeType||ca){var sa=fa[Ca]||(fa[Ca]={});sa=sa[fa.uniqueID]||(sa[fa.uniqueID]={});if((ta=sa[U])&&ta[0]===Xa&&ta[1]===ka)return Aa[2]=ta[2];sa[U]=Aa;if(Aa[2]=K(fa,qa,ma))return!0}}}function Fa(K){return 1<K.length?function(P,N,U){for(var ca=K.length;ca--;)if(!K[ca](P,N,U))return!1;return!0}:K[0]}function jb(K,P,N,U,ca){for(var ka,fa=[],qa=0,ma=K.length,ta=null!=P;qa<ma;qa++)if(ka=K[qa])if(!N||N(ka,
U,ca))fa.push(ka),ta&&P.push(qa);return fa}function ib(K,P,N,U,ca,ka){U&&!U[Ca]&&(U=ib(U));ca&&!ca[Ca]&&(ca=ib(ca,ka));return D(function(fa,qa,ma,ta){var Aa,sa=[],La=[],Ya=qa.length,Wa;if(!(Wa=fa)){Wa=P||"*";for(var va=ma.nodeType?[ma]:ma,sb=[],Na=0,zc=va.length;Na<zc;Na++)u(Wa,va[Na],sb);Wa=sb}Wa=!K||!fa&&P?Wa:jb(Wa,sa,K,ma,ta);va=N?ca||(fa?K:Ya||U)?[]:qa:Wa;N&&N(Wa,va,ma,ta);if(U){var ob=jb(va,La);U(ob,[],ma,ta);for(ma=ob.length;ma--;)if(Aa=ob[ma])va[La[ma]]=!(Wa[La[ma]]=Aa)}if(fa){if(ca||K){if(ca){ob=
[];for(ma=va.length;ma--;)(Aa=va[ma])&&ob.push(Wa[ma]=Aa);ca(null,va=[],ob,ta)}for(ma=va.length;ma--;)(Aa=va[ma])&&-1<(ob=ca?Mb(fa,Aa):sa[ma])&&(fa[ob]=!(qa[ob]=Aa))}}else va=jb(va===qa?va.splice(Ya,va.length):va),ca?ca(null,qa,va,ta):Cb.apply(qa,va)})}function eb(K){var P,N,U=K.length,ca=Ea.relative[K[0].type];var ka=ca||Ea.relative[" "];for(var fa=ca?1:0,qa=Pa(function(Aa){return Aa===P},ka,!0),ma=Pa(function(Aa){return-1<Mb(P,Aa)},ka,!0),ta=[function(Aa,sa,La){Aa=!ca&&(La||sa!==cb)||((P=sa).nodeType?
qa(Aa,sa,La):ma(Aa,sa,La));P=null;return Aa}];fa<U;fa++)if(ka=Ea.relative[K[fa].type])ta=[Pa(Fa(ta),ka)];else{ka=Ea.filter[K[fa].type].apply(null,K[fa].matches);if(ka[Ca]){for(N=++fa;N<U&&!Ea.relative[K[N].type];N++);return ib(1<fa&&Fa(ta),1<fa&&pa(K.slice(0,fa-1).concat({value:" "===K[fa-2].type?"*":""})).replace(yc,"$1"),ka,fa<N&&eb(K.slice(fa,N)),N<U&&eb(K=K.slice(N)),N<U&&pa(K))}ta.push(ka)}return Fa(ta)}function Ac(K,P){var N=0<P.length,U=0<K.length,ca=function(ka,fa,qa,ma,ta){var Aa,sa,La=0,
Ya="0",Wa=ka&&[],va=[],sb=cb,Na=ka||U&&Ea.find.TAG("*",ta),zc=Xa+=null==sb?1:Math.random()||.1,ob=Na.length;for(ta&&(cb=fa===ua||fa||ta);Ya!==ob&&null!=(Aa=Na[Ya]);Ya++){if(U&&Aa){var Vc=0;fa||Aa.ownerDocument===ua||(Lb(Aa),qa=!Ja);for(;sa=K[Vc++];)if(sa(Aa,fa||ua,qa)){ma.push(Aa);break}ta&&(Xa=zc)}N&&((Aa=!sa&&Aa)&&La--,ka&&Wa.push(Aa))}La+=Ya;if(N&&Ya!==La){for(Vc=0;sa=P[Vc++];)sa(Wa,va,fa,qa);if(ka){if(0<La)for(;Ya--;)Wa[Ya]||va[Ya]||(va[Ya]=ud.call(ma));va=jb(va)}Cb.apply(ma,va);ta&&!ka&&0<va.length&&
1<La+P.length&&u.uniqueSort(ma)}ta&&(Xa=zc,cb=sb);return Wa};return N?D(ca):ca}var xa,cb,ya,Ma,ua,Ua,Ja,Da,Za,$a,db,Ca="sizzle"+1*new Date,Ha=h.document,Xa=0,nb=0,Nb=z(),tb=z(),bb=z(),Wb=function(K,P){K===P&&(Ma=!0);return 0},Xb={}.hasOwnProperty,xb=[],ud=xb.pop,vd=xb.push,Cb=xb.push,od=xb.slice,Mb=function(K,P){for(var N=0,U=K.length;N<U;N++)if(K[N]===P)return N;return-1},wd=RegExp("[\\x20\\t\\r\\n\\f]+","g"),yc=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),xd=
RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"),yd=RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"),zd=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),Ad=RegExp(":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
nd=RegExp("^(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+$"),Bc={ID:RegExp("^#((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)"),CLASS:RegExp("^\\.((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)"),TAG:RegExp("^((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+|[*])"),ATTR:RegExp("^\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\]"),PSEUDO:RegExp("^:((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)"),
CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)","i"),bool:RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$","i"),needsContext:RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)",
"i")},Bd=/^(?:input|select|textarea|button)$/i,Cd=/^h\d$/i,dc=/^[^{]+\{\s*\[native \w/,rd=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Uc=/[+~]/,sd=/'|\\/g,yb=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),zb=function(K,P,N){K="0x"+P-65536;return K!==K||N?P:0>K?String.fromCharCode(K+65536):String.fromCharCode(K>>10|55296,K&1023|56320)},pd=function(){Lb()};try{Cb.apply(xb=od.call(Ha.childNodes),Ha.childNodes),xb[Ha.childNodes.length].nodeType}catch(K){Cb={apply:xb.length?function(P,
N){vd.apply(P,od.call(N))}:function(P,N){for(var U=P.length,ca=0;P[U++]=N[ca++];);P.length=U-1}}}var Ka=u.support={};var Dd=u.isXML=function(K){return(K=K&&(K.ownerDocument||K).documentElement)?"HTML"!==K.nodeName:!1};var Lb=u.setDocument=function(K){var P;K=K?K.ownerDocument||K:Ha;if(K===ua||9!==K.nodeType||!K.documentElement)return ua;ua=K;Ua=ua.documentElement;Ja=!Dd(ua);(P=ua.defaultView)&&P.top!==P&&(P.addEventListener?P.addEventListener("unload",pd,!1):P.attachEvent&&P.attachEvent("onunload",
pd));Ka.attributes=H(function(N){N.className="i";return!N.getAttribute("className")});Ka.getElementsByTagName=H(function(N){N.appendChild(ua.createComment(""));return!N.getElementsByTagName("*").length});Ka.getElementsByClassName=dc.test(ua.getElementsByClassName);Ka.getById=H(function(N){Ua.appendChild(N).id=Ca;return!ua.getElementsByName||!ua.getElementsByName(Ca).length});Ka.getById?(Ea.find.ID=function(N,U){if("undefined"!==typeof U.getElementById&&Ja)return(N=U.getElementById(N))?[N]:[]},Ea.filter.ID=
function(N){var U=N.replace(yb,zb);return function(ca){return ca.getAttribute("id")===U}}):(delete Ea.find.ID,Ea.filter.ID=function(N){var U=N.replace(yb,zb);return function(ca){return(ca="undefined"!==typeof ca.getAttributeNode&&ca.getAttributeNode("id"))&&ca.value===U}});Ea.find.TAG=Ka.getElementsByTagName?function(N,U){if("undefined"!==typeof U.getElementsByTagName)return U.getElementsByTagName(N);if(Ka.qsa)return U.querySelectorAll(N)}:function(N,U){var ca=[],ka=0;U=U.getElementsByTagName(N);
if("*"===N){for(;N=U[ka++];)1===N.nodeType&&ca.push(N);return ca}return U};Ea.find.CLASS=Ka.getElementsByClassName&&function(N,U){if("undefined"!==typeof U.getElementsByClassName&&Ja)return U.getElementsByClassName(N)};Za=[];Da=[];if(Ka.qsa=dc.test(ua.querySelectorAll))H(function(N){Ua.appendChild(N).innerHTML="<a id='"+Ca+"'></a><select id='"+Ca+"-\r\\' msallowcapture=''><option selected=''></option></select>";N.querySelectorAll("[msallowcapture^='']").length&&Da.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");
N.querySelectorAll("[selected]").length||Da.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)");N.querySelectorAll("[id~="+Ca+"-]").length||Da.push("~=");N.querySelectorAll(":checked").length||Da.push(":checked");N.querySelectorAll("a#"+Ca+"+*").length||Da.push(".#.+[+~]")}),H(function(N){var U=ua.createElement("input");U.setAttribute("type","hidden");N.appendChild(U).setAttribute("name",
"D");N.querySelectorAll("[name=d]").length&&Da.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");N.querySelectorAll(":enabled").length||Da.push(":enabled",":disabled");N.querySelectorAll("*,:x");Da.push(",.*:")});(Ka.matchesSelector=dc.test($a=Ua.matches||Ua.webkitMatchesSelector||Ua.mozMatchesSelector||Ua.oMatchesSelector||Ua.msMatchesSelector))&&H(function(N){Ka.disconnectedMatch=$a.call(N,"div");$a.call(N,"[s!='']:x");Za.push("!=",":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+))|)[\\x20\\t\\r\\n\\f]*\\])*)|.*)\\)|)")});
Da=Da.length&&new RegExp(Da.join("|"));Za=Za.length&&new RegExp(Za.join("|"));db=(P=dc.test(Ua.compareDocumentPosition))||dc.test(Ua.contains)?function(N,U){var ca=9===N.nodeType?N.documentElement:N;U=U&&U.parentNode;return N===U||!!(U&&1===U.nodeType&&(ca.contains?ca.contains(U):N.compareDocumentPosition&&N.compareDocumentPosition(U)&16))}:function(N,U){if(U)for(;U=U.parentNode;)if(U===N)return!0;return!1};Wb=P?function(N,U){if(N===U)return Ma=!0,0;var ca=!N.compareDocumentPosition-!U.compareDocumentPosition;
if(ca)return ca;ca=(N.ownerDocument||N)===(U.ownerDocument||U)?N.compareDocumentPosition(U):1;return ca&1||!Ka.sortDetached&&U.compareDocumentPosition(N)===ca?N===ua||N.ownerDocument===Ha&&db(Ha,N)?-1:U===ua||U.ownerDocument===Ha&&db(Ha,U)?1:ya?Mb(ya,N)-Mb(ya,U):0:ca&4?-1:1}:function(N,U){if(N===U)return Ma=!0,0;var ca=0,ka=N.parentNode,fa=U.parentNode,qa=[N],ma=[U];if(!ka||!fa)return N===ua?-1:U===ua?1:ka?-1:fa?1:ya?Mb(ya,N)-Mb(ya,U):0;if(ka===fa)return M(N,U);for(;N=N.parentNode;)qa.unshift(N);
for(N=U;N=N.parentNode;)ma.unshift(N);for(;qa[ca]===ma[ca];)ca++;return ca?M(qa[ca],ma[ca]):qa[ca]===Ha?-1:ma[ca]===Ha?1:0};return ua};u.matches=function(K,P){return u(K,null,null,P)};u.matchesSelector=function(K,P){(K.ownerDocument||K)!==ua&&Lb(K);P=P.replace(zd,"='$1']");if(!(!Ka.matchesSelector||!Ja||bb[P+" "]||Za&&Za.test(P)||Da&&Da.test(P)))try{var N=$a.call(K,P);if(N||Ka.disconnectedMatch||K.document&&11!==K.document.nodeType)return N}catch(U){}return 0<u(P,ua,null,[K]).length};u.contains=function(K,
P){(K.ownerDocument||K)!==ua&&Lb(K);return db(K,P)};u.attr=function(K,P){(K.ownerDocument||K)!==ua&&Lb(K);var N=Ea.attrHandle[P.toLowerCase()];N=N&&Xb.call(Ea.attrHandle,P.toLowerCase())?N(K,P,!Ja):x;return N!==x?N:Ka.attributes||!Ja?K.getAttribute(P):(N=K.getAttributeNode(P))&&N.specified?N.value:null};u.error=function(K){throw Error("Syntax error, unrecognized expression: "+K);};u.uniqueSort=function(K){var P,N=[],U=0,ca=0;Ma=!Ka.detectDuplicates;ya=!Ka.sortStable&&K.slice(0);K.sort(Wb);if(Ma){for(;P=
K[ca++];)P===K[ca]&&(U=N.push(ca));for(;U--;)K.splice(N[U],1)}ya=null;return K};var Wc=u.getText=function(K){var P="",N=0;var U=K.nodeType;if(!U)for(;U=K[N++];)P+=Wc(U);else if(1===U||9===U||11===U){if("string"===typeof K.textContent)return K.textContent;for(K=K.firstChild;K;K=K.nextSibling)P+=Wc(K)}else if(3===U||4===U)return K.nodeValue;return P};var Ea=u.selectors={cacheLength:50,createPseudo:D,match:Bc,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",
first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(K){K[1]=K[1].replace(yb,zb);K[3]=(K[3]||K[4]||K[5]||"").replace(yb,zb);"~="===K[2]&&(K[3]=" "+K[3]+" ");return K.slice(0,4)},CHILD:function(K){K[1]=K[1].toLowerCase();"nth"===K[1].slice(0,3)?(K[3]||u.error(K[0]),K[4]=+(K[4]?K[5]+(K[6]||1):2*("even"===K[3]||"odd"===K[3])),K[5]=+(K[7]+K[8]||"odd"===K[3])):K[3]&&u.error(K[0]);return K},PSEUDO:function(K){var P,N=!K[6]&&K[2];if(Bc.CHILD.test(K[0]))return null;K[3]?K[2]=K[4]||K[5]||"":N&&
Ad.test(N)&&(P=xc(N,!0))&&(P=N.indexOf(")",N.length-P)-N.length)&&(K[0]=K[0].slice(0,P),K[2]=N.slice(0,P));return K.slice(0,3)}},filter:{TAG:function(K){var P=K.replace(yb,zb).toLowerCase();return"*"===K?function(){return!0}:function(N){return N.nodeName&&N.nodeName.toLowerCase()===P}},CLASS:function(K){var P=Nb[K+" "];return P||(P=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+K+"([\\x20\\t\\r\\n\\f]|$)"),Nb(K,function(N){return P.test("string"===typeof N.className&&N.className||"undefined"!==typeof N.getAttribute&&
N.getAttribute("class")||"")}))},ATTR:function(K,P,N){return function(U){U=u.attr(U,K);if(null==U)return"!="===P;if(!P)return!0;U+="";return"="===P?U===N:"!="===P?U!==N:"^="===P?N&&0===U.indexOf(N):"*="===P?N&&-1<U.indexOf(N):"$="===P?N&&U.slice(-N.length)===N:"~="===P?-1<(" "+U.replace(wd," ")+" ").indexOf(N):"|="===P?U===N||U.slice(0,N.length+1)===N+"-":!1}},CHILD:function(K,P,N,U,ca){var ka="nth"!==K.slice(0,3),fa="last"!==K.slice(-4),qa="of-type"===P;return 1===U&&0===ca?function(ma){return!!ma.parentNode}:
function(ma,ta,Aa){var sa,La;ta=ka!==fa?"nextSibling":"previousSibling";var Ya=ma.parentNode,Wa=qa&&ma.nodeName.toLowerCase();Aa=!Aa&&!qa;var va=!1;if(Ya){if(ka){for(;ta;){for(sa=ma;sa=sa[ta];)if(qa?sa.nodeName.toLowerCase()===Wa:1===sa.nodeType)return!1;var sb=ta="only"===K&&!sb&&"nextSibling"}return!0}sb=[fa?Ya.firstChild:Ya.lastChild];if(fa&&Aa){sa=Ya;var Na=sa[Ca]||(sa[Ca]={});Na=Na[sa.uniqueID]||(Na[sa.uniqueID]={});va=Na[K]||[];va=(La=va[0]===Xa&&va[1])&&va[2];for(sa=La&&Ya.childNodes[La];sa=
++La&&sa&&sa[ta]||(va=La=0)||sb.pop();)if(1===sa.nodeType&&++va&&sa===ma){Na[K]=[Xa,La,va];break}}else if(Aa&&(sa=ma,Na=sa[Ca]||(sa[Ca]={}),Na=Na[sa.uniqueID]||(Na[sa.uniqueID]={}),va=Na[K]||[],va=La=va[0]===Xa&&va[1]),!1===va)for(;(sa=++La&&sa&&sa[ta]||(va=La=0)||sb.pop())&&((qa?sa.nodeName.toLowerCase()!==Wa:1!==sa.nodeType)||!++va||(Aa&&(Na=sa[Ca]||(sa[Ca]={}),Na=Na[sa.uniqueID]||(Na[sa.uniqueID]={}),Na[K]=[Xa,va]),sa!==ma)););va-=ca;return va===U||0===va%U&&0<=va/U}}},PSEUDO:function(K,P){var N=
Ea.pseudos[K]||Ea.setFilters[K.toLowerCase()]||u.error("unsupported pseudo: "+K);if(N[Ca])return N(P);if(1<N.length){var U=[K,K,"",P];return Ea.setFilters.hasOwnProperty(K.toLowerCase())?D(function(ca,ka){for(var fa,qa=N(ca,P),ma=qa.length;ma--;)fa=Mb(ca,qa[ma]),ca[fa]=!(ka[fa]=qa[ma])}):function(ca){return N(ca,0,U)}}return N}},pseudos:{not:D(function(K){var P=[],N=[],U=qd(K.replace(yc,"$1"));return U[Ca]?D(function(ca,ka,fa,qa){qa=U(ca,null,qa,[]);for(var ma=ca.length;ma--;)if(fa=qa[ma])ca[ma]=
!(ka[ma]=fa)}):function(ca,ka,fa){P[0]=ca;U(P,null,fa,N);P[0]=null;return!N.pop()}}),has:D(function(K){return function(P){return 0<u(K,P).length}}),contains:D(function(K){K=K.replace(yb,zb);return function(P){return-1<(P.textContent||P.innerText||Wc(P)).indexOf(K)}}),lang:D(function(K){nd.test(K||"")||u.error("unsupported lang: "+K);K=K.replace(yb,zb).toLowerCase();return function(P){var N;do if(N=Ja?P.lang:P.getAttribute("xml:lang")||P.getAttribute("lang"))return N=N.toLowerCase(),N===K||0===N.indexOf(K+
"-");while((P=P.parentNode)&&1===P.nodeType);return!1}}),target:function(K){var P=h.location&&h.location.hash;return P&&P.slice(1)===K.id},root:function(K){return K===Ua},focus:function(K){return K===ua.activeElement&&(!ua.hasFocus||ua.hasFocus())&&!!(K.type||K.href||~K.tabIndex)},enabled:function(K){return!1===K.disabled},disabled:function(K){return!0===K.disabled},checked:function(K){var P=K.nodeName.toLowerCase();return"input"===P&&!!K.checked||"option"===P&&!!K.selected},selected:function(K){K.parentNode&&
K.parentNode.selectedIndex;return!0===K.selected},empty:function(K){for(K=K.firstChild;K;K=K.nextSibling)if(6>K.nodeType)return!1;return!0},parent:function(K){return!Ea.pseudos.empty(K)},header:function(K){return Cd.test(K.nodeName)},input:function(K){return Bd.test(K.nodeName)},button:function(K){var P=K.nodeName.toLowerCase();return"input"===P&&"button"===K.type||"button"===P},text:function(K){var P;return"input"===K.nodeName.toLowerCase()&&"text"===K.type&&(null==(P=K.getAttribute("type"))||"text"===
P.toLowerCase())},first:T(function(){return[0]}),last:T(function(K,P){return[P-1]}),eq:T(function(K,P,N){return[0>N?N+P:N]}),even:T(function(K,P){for(var N=0;N<P;N+=2)K.push(N);return K}),odd:T(function(K,P){for(var N=1;N<P;N+=2)K.push(N);return K}),lt:T(function(K,P,N){for(P=0>N?N+P:N;0<=--P;)K.push(P);return K}),gt:T(function(K,P,N){for(N=0>N?N+P:N;++N<P;)K.push(N);return K})}};Ea.pseudos.nth=Ea.pseudos.eq;for(xa in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Ea.pseudos[xa]=Q(xa);for(xa in{submit:!0,
reset:!0})Ea.pseudos[xa]=R(xa);na.prototype=Ea.filters=Ea.pseudos;Ea.setFilters=new na;var xc=u.tokenize=function(K,P){var N,U,ca,ka,fa;if(ka=tb[K+" "])return P?0:ka.slice(0);ka=K;var qa=[];for(fa=Ea.preFilter;ka;){if(!ma||(N=xd.exec(ka)))N&&(ka=ka.slice(N[0].length)||ka),qa.push(U=[]);var ma=!1;if(N=yd.exec(ka))ma=N.shift(),U.push({value:ma,type:N[0].replace(yc," ")}),ka=ka.slice(ma.length);for(ca in Ea.filter)!(N=Bc[ca].exec(ka))||fa[ca]&&!(N=fa[ca](N))||(ma=N.shift(),U.push({value:ma,type:ca,matches:N}),
ka=ka.slice(ma.length));if(!ma)break}return P?ka.length:ka?u.error(K):tb(K,qa).slice(0)};var qd=u.compile=function(K,P){var N,U=[],ca=[],ka=bb[K+" "];if(!ka){P||(P=xc(K));for(N=P.length;N--;)ka=eb(P[N]),ka[Ca]?U.push(ka):ca.push(ka);ka=bb(K,Ac(ca,U));ka.selector=K}return ka};var td=u.select=function(K,P,N,U){var ca,ka,fa,qa="function"===typeof K&&K,ma=!U&&xc(K=qa.selector||K);N=N||[];if(1===ma.length){var ta=ma[0]=ma[0].slice(0);if(2<ta.length&&"ID"===(ka=ta[0]).type&&Ka.getById&&9===P.nodeType&&
Ja&&Ea.relative[ta[1].type]){P=(Ea.find.ID(ka.matches[0].replace(yb,zb),P)||[])[0];if(!P)return N;qa&&(P=P.parentNode);K=K.slice(ta.shift().value.length)}for(ca=Bc.needsContext.test(K)?0:ta.length;ca--;){ka=ta[ca];if(Ea.relative[fa=ka.type])break;if(fa=Ea.find[fa])if(U=fa(ka.matches[0].replace(yb,zb),Uc.test(ta[0].type)&&ha(P.parentNode)||P)){ta.splice(ca,1);K=U.length&&pa(ta);if(!K)return Cb.apply(N,U),N;break}}}(qa||qd(K,ma))(U,P,!Ja,N,!P||Uc.test(K)&&ha(P.parentNode)||P);return N};Ka.sortStable=
Ca.split("").sort(Wb).join("")===Ca;Ka.detectDuplicates=!!Ma;Lb();Ka.sortDetached=H(function(K){return K.compareDocumentPosition(ua.createElement("div"))&1});H(function(K){K.innerHTML="<a href='#'></a>";return"#"===K.firstChild.getAttribute("href")})||J("type|href|height|width",function(K,P,N){if(!N)return K.getAttribute(P,"type"===P.toLowerCase()?1:2)});Ka.attributes&&H(function(K){K.innerHTML="<input/>";K.firstChild.setAttribute("value","");return""===K.firstChild.getAttribute("value")})||J("value",
function(K,P,N){if(!N&&"input"===K.nodeName.toLowerCase())return K.defaultValue});H(function(K){return null==K.getAttribute("disabled")})||J("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",function(K,P,N){var U;if(!N)return!0===K[P]?P.toLowerCase():(U=K.getAttributeNode(P))&&U.specified?U.value:null});return u}(v);C.find=Ab;C.expr=Ab.selectors;C.expr[":"]=C.expr.pseudos;C.uniqueSort=C.unique=Ab.uniqueSort;C.text=Ab.getText;
C.isXMLDoc=Ab.isXML;C.contains=Ab.contains;var kb=function(h,u,z){for(var D=[],H=z!==x;(h=h[u])&&9!==h.nodeType;)if(1===h.nodeType){if(H&&C(h).is(z))break;D.push(h)}return D},Ob=function(h,u){for(var z=[];h;h=h.nextSibling)1===h.nodeType&&h!==u&&z.push(h);return z},Pb=C.expr.match.needsContext,ec=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,pc=/^.[^:#\[\.,]*$/;C.filter=function(h,u,z){var D=u[0];z&&(h=":not("+h+")");return 1===u.length&&1===D.nodeType?C.find.matchesSelector(D,h)?[D]:[]:C.find.matches(h,C.grep(u,
function(H){return 1===H.nodeType}))};C.fn.extend({find:function(h){var u,z=this.length,D=[],H=this;if("string"!==typeof h)return this.pushStack(C(h).filter(function(){for(u=0;u<z;u++)if(C.contains(H[u],this))return!0}));for(u=0;u<z;u++)C.find(h,H[u],D);D=this.pushStack(1<z?C.unique(D):D);D.selector=this.selector?this.selector+" "+h:h;return D},filter:function(h){return this.pushStack(d(this,h||[],!1))},not:function(h){return this.pushStack(d(this,h||[],!0))},is:function(h){return!!d(this,"string"===
typeof h&&Pb.test(h)?C(h):h||[],!1).length}});var Cc=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(C.fn.init=function(h,u,z){if(!h)return this;z=z||fc;if("string"===typeof h){var D="<"===h[0]&&">"===h[h.length-1]&&3<=h.length?[null,h,null]:Cc.exec(h);if(!D||!D[1]&&u)return!u||u.jquery?(u||z).find(h):this.constructor(u).find(h);if(D[1]){if(u=u instanceof C?u[0]:u,C.merge(this,C.parseHTML(D[1],u&&u.nodeType?u.ownerDocument||u:oa,!0)),ec.test(D[1])&&C.isPlainObject(u))for(D in u)if(C.isFunction(this[D]))this[D](u[D]);
else this.attr(D,u[D])}else(u=oa.getElementById(D[2]))&&u.parentNode&&(this.length=1,this[0]=u),this.context=oa,this.selector=h;return this}if(h.nodeType)return this.context=this[0]=h,this.length=1,this;if(C.isFunction(h))return z.ready!==x?z.ready(h):h(C);h.selector!==x&&(this.selector=h.selector,this.context=h.context);return C.makeArray(h,this)}).prototype=C.fn;var fc=C(oa);var gc=/^(?:parents|prev(?:Until|All))/,hc={children:!0,contents:!0,next:!0,prev:!0};C.fn.extend({has:function(h){var u=C(h,
this),z=u.length;return this.filter(function(){for(var D=0;D<z;D++)if(C.contains(this,u[D]))return!0})},closest:function(h,u){for(var z,D=0,H=this.length,J=[],M=Pb.test(h)||"string"!==typeof h?C(h,u||this.context):0;D<H;D++)for(z=this[D];z&&z!==u;z=z.parentNode)if(11>z.nodeType&&(M?-1<M.index(z):1===z.nodeType&&C.find.matchesSelector(z,h))){J.push(z);break}return this.pushStack(1<J.length?C.uniqueSort(J):J)},index:function(h){return h?"string"===typeof h?Gb.call(C(h),this[0]):Gb.call(this,h.jquery?
h[0]:h):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(h,u){return this.pushStack(C.uniqueSort(C.merge(this.get(),C(h,u))))},addBack:function(h){return this.add(null==h?this.prevObject:this.prevObject.filter(h))}});C.each({parent:function(h){return(h=h.parentNode)&&11!==h.nodeType?h:null},parents:function(h){return kb(h,"parentNode")},parentsUntil:function(h,u,z){return kb(h,"parentNode",z)},next:function(h){return e(h,"nextSibling")},prev:function(h){return e(h,"previousSibling")},
nextAll:function(h){return kb(h,"nextSibling")},prevAll:function(h){return kb(h,"previousSibling")},nextUntil:function(h,u,z){return kb(h,"nextSibling",z)},prevUntil:function(h,u,z){return kb(h,"previousSibling",z)},siblings:function(h){return Ob((h.parentNode||{}).firstChild,h)},children:function(h){return Ob(h.firstChild)},contents:function(h){return h.contentDocument||C.merge([],h.childNodes)}},function(h,u){C.fn[h]=function(z,D){var H=C.map(this,u,z);"Until"!==h.slice(-5)&&(D=z);D&&"string"===
typeof D&&(H=C.filter(D,H));1<this.length&&(hc[h]||C.uniqueSort(H),gc.test(h)&&H.reverse());return this.pushStack(H)}});var fb=/\S+/g;C.Callbacks=function(h){h="string"===typeof h?c(h):C.extend({},h);var u,z,D,H,J=[],M=[],Q=-1,R=function(){H=h.once;for(D=u=!0;M.length;Q=-1)for(z=M.shift();++Q<J.length;)!1===J[Q].apply(z[0],z[1])&&h.stopOnFalse&&(Q=J.length,z=!1);h.memory||(z=!1);u=!1;H&&(J=z?[]:"")},T={add:function(){J&&(z&&!u&&(Q=J.length-1,M.push(z)),function pa(na){C.each(na,function(Pa,Fa){C.isFunction(Fa)?
h.unique&&T.has(Fa)||J.push(Fa):Fa&&Fa.length&&"string"!==C.type(Fa)&&pa(Fa)})}(arguments),z&&!u&&R());return this},remove:function(){C.each(arguments,function(ha,na){for(var pa;-1<(pa=C.inArray(na,J,pa));)J.splice(pa,1),pa<=Q&&Q--});return this},has:function(ha){return ha?-1<C.inArray(ha,J):0<J.length},empty:function(){J&&(J=[]);return this},disable:function(){H=M=[];J=z="";return this},disabled:function(){return!J},lock:function(){H=M=[];z||(J=z="");return this},locked:function(){return!!H},fireWith:function(ha,
na){H||(na=na||[],na=[ha,na.slice?na.slice():na],M.push(na),u||R());return this},fire:function(){T.fireWith(this,arguments);return this},fired:function(){return!!D}};return T};C.extend({Deferred:function(h){var u=[["resolve","done",C.Callbacks("once memory"),"resolved"],["reject","fail",C.Callbacks("once memory"),"rejected"],["notify","progress",C.Callbacks("memory")]],z="pending",D={state:function(){return z},always:function(){H.done(arguments).fail(arguments);return this},then:function(){var J=
arguments;return C.Deferred(function(M){C.each(u,function(Q,R){var T=C.isFunction(J[Q])&&J[Q];H[R[1]](function(){var ha=T&&T.apply(this,arguments);if(ha&&C.isFunction(ha.promise))ha.promise().progress(M.notify).done(M.resolve).fail(M.reject);else M[R[0]+"With"](this===D?M.promise():this,T?[ha]:arguments)})});J=null}).promise()},promise:function(J){return null!=J?C.extend(J,D):D}},H={};D.pipe=D.then;C.each(u,function(J,M){var Q=M[2],R=M[3];D[M[1]]=Q.add;R&&Q.add(function(){z=R},u[J^1][2].disable,u[2][2].lock);
H[M[0]]=function(){H[M[0]+"With"](this===H?D:this,arguments);return this};H[M[0]+"With"]=Q.fireWith});D.promise(H);h&&h.call(H,H);return H},when:function(h){var u=0,z=mb.call(arguments),D=z.length,H=1!==D||h&&C.isFunction(h.promise)?D:0,J=1===H?h:C.Deferred(),M=function(ha,na,pa){return function(Pa){na[ha]=this;pa[ha]=1<arguments.length?mb.call(arguments):Pa;pa===R?J.notifyWith(na,pa):--H||J.resolveWith(na,pa)}},Q;if(1<D){var R=Array(D);var T=Array(D);for(Q=Array(D);u<D;u++)z[u]&&C.isFunction(z[u].promise)?
z[u].promise().progress(M(u,T,R)).done(M(u,Q,z)).fail(J.reject):--H}H||J.resolveWith(Q,z);return J.promise()}});var Db;C.fn.ready=function(h){C.ready.promise().done(h);return this};C.extend({isReady:!1,readyWait:1,holdReady:function(h){h?C.readyWait++:C.ready(!0)},ready:function(h){(!0===h?--C.readyWait:C.isReady)||(C.isReady=!0,!0!==h&&0<--C.readyWait||(Db.resolveWith(oa,[C]),C.fn.triggerHandler&&(C(oa).triggerHandler("ready"),C(oa).off("ready"))))}});C.ready.promise=function(h){Db||(Db=C.Deferred(),
"complete"===oa.readyState||"loading"!==oa.readyState&&!oa.documentElement.doScroll?v.setTimeout(C.ready):(oa.addEventListener("DOMContentLoaded",a),v.addEventListener("load",a)));return Db.promise(h)};C.ready.promise();var lb=function(h,u,z,D,H,J,M){var Q=0,R=h.length,T=null==z;if("object"===C.type(z))for(Q in H=!0,z)lb(h,u,Q,z[Q],!0,J,M);else if(D!==x&&(H=!0,C.isFunction(D)||(M=!0),T&&(M?(u.call(h,D),u=null):(T=u,u=function(ha,na,pa){return T.call(C(ha),pa)})),u))for(;Q<R;Q++)u(h[Q],z,M?D:D.call(h[Q],
Q,u(h[Q],z)));return H?h:T?u.call(h):R?u(h[0],z):J},Qb=function(h){return 1===h.nodeType||9===h.nodeType||!+h.nodeType};f.uid=1;f.prototype={register:function(h,u){u=u||{};h.nodeType?h[this.expando]=u:Object.defineProperty(h,this.expando,{value:u,writable:!0,configurable:!0});return h[this.expando]},cache:function(h){if(!Qb(h))return{};var u=h[this.expando];u||(u={},Qb(h)&&(h.nodeType?h[this.expando]=u:Object.defineProperty(h,this.expando,{value:u,configurable:!0})));return u},set:function(h,u,z){var D;
h=this.cache(h);if("string"===typeof u)h[u]=z;else for(D in u)h[D]=u[D];return h},get:function(h,u){return u===x?this.cache(h):h[this.expando]&&h[this.expando][u]},access:function(h,u,z){if(u===x||u&&"string"===typeof u&&z===x)return z=this.get(h,u),z!==x?z:this.get(h,C.camelCase(u));this.set(h,u,z);return z!==x?z:u},remove:function(h,u){var z=h[this.expando];if(z!==x){if(u===x)this.register(h);else{if(C.isArray(u))var D=u.concat(u.map(C.camelCase));else{var H=C.camelCase(u);u in z?D=[u,H]:(D=H,D=
D in z?[D]:D.match(fb)||[])}for(H=D.length;H--;)delete z[D[H]]}if(u===x||C.isEmptyObject(z))h.nodeType?h[this.expando]=x:delete h[this.expando]}},hasData:function(h){h=h[this.expando];return h!==x&&!C.isEmptyObject(h)}};var wa=new f,Oa=new f,qc=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Zb=/[A-Z]/g;C.extend({hasData:function(h){return Oa.hasData(h)||wa.hasData(h)},data:function(h,u,z){return Oa.access(h,u,z)},removeData:function(h,u){Oa.remove(h,u)},_data:function(h,u,z){return wa.access(h,u,z)},_removeData:function(h,
u){wa.remove(h,u)}});C.fn.extend({data:function(h,u){var z,D=this[0],H=D&&D.attributes;if(h===x){if(this.length){var J=Oa.get(D);if(1===D.nodeType&&!wa.get(D,"hasDataAttrs")){for(z=H.length;z--;)if(H[z]){var M=H[z].name;0===M.indexOf("data-")&&(M=C.camelCase(M.slice(5)),m(D,M,J[M]))}wa.set(D,"hasDataAttrs",!0)}}return J}return"object"===typeof h?this.each(function(){Oa.set(this,h)}):lb(this,function(Q){if(D&&Q===x){var R=Oa.get(D,h)||Oa.get(D,h.replace(Zb,"-$&").toLowerCase());if(R!==x)return R;var T=
C.camelCase(h);R=Oa.get(D,T);if(R!==x)return R;R=m(D,T,x);if(R!==x)return R}else T=C.camelCase(h),this.each(function(){var ha=Oa.get(this,T);Oa.set(this,T,Q);-1<h.indexOf("-")&&ha!==x&&Oa.set(this,h,Q)})},null,u,1<arguments.length,null,!0)},removeData:function(h){return this.each(function(){Oa.remove(this,h)})}});C.extend({queue:function(h,u,z){if(h){u=(u||"fx")+"queue";var D=wa.get(h,u);z&&(!D||C.isArray(z)?D=wa.access(h,u,C.makeArray(z)):D.push(z));return D||[]}},dequeue:function(h,u){u=u||"fx";
var z=C.queue(h,u),D=z.length,H=z.shift(),J=C._queueHooks(h,u),M=function(){C.dequeue(h,u)};"inprogress"===H&&(H=z.shift(),D--);H&&("fx"===u&&z.unshift("inprogress"),delete J.stop,H.call(h,M,J));!D&&J&&J.empty.fire()},_queueHooks:function(h,u){var z=u+"queueHooks";return wa.get(h,z)||wa.access(h,z,{empty:C.Callbacks("once memory").add(function(){wa.remove(h,[u+"queue",z])})})}});C.fn.extend({queue:function(h,u){var z=2;"string"!==typeof h&&(u=h,h="fx",z--);return arguments.length<z?C.queue(this[0],
h):u===x?this:this.each(function(){var D=C.queue(this,h,u);C._queueHooks(this,h);"fx"===h&&"inprogress"!==D[0]&&C.dequeue(this,h)})},dequeue:function(h){return this.each(function(){C.dequeue(this,h)})},clearQueue:function(h){return this.queue(h||"fx",[])},promise:function(h,u){var z,D=1,H=C.Deferred(),J=this,M=this.length,Q=function(){--D||H.resolveWith(J,[J])};"string"!==typeof h&&(u=h,h=x);for(h=h||"fx";M--;)(z=wa.get(J[M],h+"queueHooks"))&&z.empty&&(D++,z.empty.add(Q));Q();return H.promise(u)}});
var ic=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,vb=new RegExp("^(?:([+-])=|)("+ic+")([a-z%]*)$","i"),qb=["Top","Right","Bottom","Left"],rb=function(h,u){h=u||h;return"none"===C.css(h,"display")||!C.contains(h.ownerDocument,h)},Eb=/^(?:checkbox|radio)$/i,$b=/<([\w:-]+)/,Hb=/^$|\/(?:java|ecma)script/i,ab={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>",
"</tr></tbody></table>"],_default:[0,"",""]};ab.optgroup=ab.option;ab.tbody=ab.tfoot=ab.colgroup=ab.caption=ab.thead;ab.th=ab.td;var Pc=/<|&#?\w+;/;(function(){var h=oa.createDocumentFragment().appendChild(oa.createElement("div")),u=oa.createElement("input");u.setAttribute("type","radio");u.setAttribute("checked","checked");u.setAttribute("name","t");h.appendChild(u);Ia.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked;h.innerHTML="<textarea>x</textarea>";Ia.noCloneChecked=!!h.cloneNode(!0).lastChild.defaultValue})();
var Xc=/^key/,Yc=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Dc=/^([^.]*)(?:\.(.+)|)/;C.event={global:{},add:function(h,u,z,D,H){var J,M,Q,R,T;if(Q=wa.get(h)){if(z.handler){var ha=z;z=ha.handler;H=ha.selector}z.guid||(z.guid=C.guid++);(M=Q.events)||(M=Q.events={});(J=Q.handle)||(J=Q.handle=function(Fa){return"undefined"!==typeof C&&C.event.triggered!==Fa.type?C.event.dispatch.apply(h,arguments):x});u=(u||"").match(fb)||[""];for(Q=u.length;Q--;){var na=Dc.exec(u[Q])||[];var pa=R=na[1];var Pa=
(na[2]||"").split(".").sort();pa&&(na=C.event.special[pa]||{},pa=(H?na.delegateType:na.bindType)||pa,na=C.event.special[pa]||{},R=C.extend({type:pa,origType:R,data:D,handler:z,guid:z.guid,selector:H,needsContext:H&&C.expr.match.needsContext.test(H),namespace:Pa.join(".")},ha),(T=M[pa])||(T=M[pa]=[],T.delegateCount=0,na.setup&&!1!==na.setup.call(h,D,Pa,J)||h.addEventListener&&h.addEventListener(pa,J)),na.add&&(na.add.call(h,R),R.handler.guid||(R.handler.guid=z.guid)),H?T.splice(T.delegateCount++,0,
R):T.push(R),C.event.global[pa]=!0)}}},remove:function(h,u,z,D,H){var J,M,Q,R,T,ha=wa.hasData(h)&&wa.get(h);if(ha&&(Q=ha.events)){u=(u||"").match(fb)||[""];for(R=u.length;R--;){var na=Dc.exec(u[R])||[];var pa=T=na[1];var Pa=(na[2]||"").split(".").sort();if(pa){var Fa=C.event.special[pa]||{};pa=(D?Fa.delegateType:Fa.bindType)||pa;var jb=Q[pa]||[];na=na[2]&&new RegExp("(^|\\.)"+Pa.join("\\.(?:.*\\.|)")+"(\\.|$)");for(M=J=jb.length;J--;){var ib=jb[J];!H&&T!==ib.origType||z&&z.guid!==ib.guid||na&&!na.test(ib.namespace)||
D&&D!==ib.selector&&("**"!==D||!ib.selector)||(jb.splice(J,1),ib.selector&&jb.delegateCount--,Fa.remove&&Fa.remove.call(h,ib))}M&&!jb.length&&(Fa.teardown&&!1!==Fa.teardown.call(h,Pa,ha.handle)||C.removeEvent(h,pa,ha.handle),delete Q[pa])}else for(pa in Q)C.event.remove(h,pa+u[R],z,D,!0)}C.isEmptyObject(Q)&&wa.remove(h,"handle events")}},dispatch:function(h){h=C.event.fix(h);var u,z,D,H=mb.call(arguments);var J=(wa.get(this,"events")||{})[h.type]||[];var M=C.event.special[h.type]||{};H[0]=h;h.delegateTarget=
this;if(!M.preDispatch||!1!==M.preDispatch.call(this,h)){var Q=C.event.handlers.call(this,h,J);for(J=0;(D=Q[J++])&&!h.isPropagationStopped();)for(h.currentTarget=D.elem,u=0;(z=D.handlers[u++])&&!h.isImmediatePropagationStopped();)if(!h.rnamespace||h.rnamespace.test(z.namespace))h.handleObj=z,h.data=z.data,z=((C.event.special[z.origType]||{}).handle||z.handler).apply(D.elem,H),z!==x&&!1===(h.result=z)&&(h.preventDefault(),h.stopPropagation());M.postDispatch&&M.postDispatch.call(this,h);return h.result}},
handlers:function(h,u){var z,D=[],H=u.delegateCount,J=h.target;if(H&&J.nodeType&&("click"!==h.type||isNaN(h.button)||1>h.button))for(;J!==this;J=J.parentNode||this)if(1===J.nodeType&&(!0!==J.disabled||"click"!==h.type)){var M=[];for(z=0;z<H;z++){var Q=u[z];var R=Q.selector+" ";M[R]===x&&(M[R]=Q.needsContext?-1<C(R,this).index(J):C.find(R,this,null,[J]).length);M[R]&&M.push(Q)}M.length&&D.push({elem:J,handlers:M})}H<u.length&&D.push({elem:this,handlers:u.slice(H)});return D},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(h,u){null==h.which&&(h.which=null!=u.charCode?u.charCode:u.keyCode);return h}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(h,u){var z=u.button;if(null==h.pageX&&null!=u.clientX){var D=h.target.ownerDocument||oa;var H=D.documentElement;D=D.body;h.pageX=u.clientX+(H&&H.scrollLeft||D&&D.scrollLeft||0)-(H&&H.clientLeft||D&&D.clientLeft||
0);h.pageY=u.clientY+(H&&H.scrollTop||D&&D.scrollTop||0)-(H&&H.clientTop||D&&D.clientTop||0)}h.which||z===x||(h.which=z&1?1:z&2?3:z&4?2:0);return h}},fix:function(h){if(h[C.expando])return h;var u=h.type;var z=h,D=this.fixHooks[u];D||(this.fixHooks[u]=D=Yc.test(u)?this.mouseHooks:Xc.test(u)?this.keyHooks:{});var H=D.props?this.props.concat(D.props):this.props;h=new C.Event(z);for(u=H.length;u--;){var J=H[u];h[J]=z[J]}h.target||(h.target=oa);3===h.target.nodeType&&(h.target=h.target.parentNode);return D.filter?
D.filter(h,z):h},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==G()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===G()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&C.nodeName(this,"input"))return this.click(),!1},_default:function(h){return C.nodeName(h.target,"a")}},beforeunload:{postDispatch:function(h){h.result!==x&&h.originalEvent&&(h.originalEvent.returnValue=
h.result)}}}};C.removeEvent=function(h,u,z){h.removeEventListener&&h.removeEventListener(u,z)};C.Event=function(h,u){if(!(this instanceof C.Event))return new C.Event(h,u);h&&h.type?(this.originalEvent=h,this.type=h.type,this.isDefaultPrevented=h.defaultPrevented||h.defaultPrevented===x&&!1===h.returnValue?w:A):this.type=h;u&&C.extend(this,u);this.timeStamp=h&&h.timeStamp||C.now();this[C.expando]=!0};C.Event.prototype={constructor:C.Event,isDefaultPrevented:A,isPropagationStopped:A,isImmediatePropagationStopped:A,
isSimulated:!1,preventDefault:function(){var h=this.originalEvent;this.isDefaultPrevented=w;h&&!this.isSimulated&&h.preventDefault()},stopPropagation:function(){var h=this.originalEvent;this.isPropagationStopped=w;h&&!this.isSimulated&&h.stopPropagation()},stopImmediatePropagation:function(){var h=this.originalEvent;this.isImmediatePropagationStopped=w;h&&!this.isSimulated&&h.stopImmediatePropagation();this.stopPropagation()}};C.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",
pointerleave:"pointerout"},function(h,u){C.event.special[h]={delegateType:u,bindType:u,handle:function(z){var D=z.relatedTarget,H=z.handleObj;if(!D||D!==this&&!C.contains(this,D)){z.type=H.origType;var J=H.handler.apply(this,arguments);z.type=u}return J}}});C.fn.extend({on:function(h,u,z,D){return b(this,h,u,z,D)},one:function(h,u,z,D){return b(this,h,u,z,D,1)},off:function(h,u,z){if(h&&h.preventDefault&&h.handleObj){var D=h.handleObj;C(h.delegateTarget).off(D.namespace?D.origType+"."+D.namespace:
D.origType,D.selector,D.handler);return this}if("object"===typeof h){for(D in h)this.off(D,u,h[D]);return this}if(!1===u||"function"===typeof u)z=u,u=x;!1===z&&(z=A);return this.each(function(){C.event.remove(this,h,z,u)})}});var Zc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,$c=/<script|<style|<link/i,Rc=/checked\s*(?:[^=]|=\s*.checked.)/i,Qc=/^true\/(.*)/,Ib=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;C.extend({htmlPrefilter:function(h){return h.replace(Zc,"<$1></$2>")},
clone:function(h,u,z){var D,H=h.cloneNode(!0),J=C.contains(h.ownerDocument,h);if(!(Ia.noCloneChecked||1!==h.nodeType&&11!==h.nodeType||C.isXMLDoc(h))){var M=l(H);var Q=l(h);var R=0;for(D=Q.length;R<D;R++){var T=Q[R],ha=M[R],na=ha.nodeName.toLowerCase();if("input"===na&&Eb.test(T.type))ha.checked=T.checked;else if("input"===na||"textarea"===na)ha.defaultValue=T.defaultValue}}if(u)if(z)for(Q=Q||l(h),M=M||l(H),R=0,D=Q.length;R<D;R++)F(Q[R],M[R]);else F(h,H);M=l(H,"script");0<M.length&&r(M,!J&&l(h,"script"));
return H},cleanData:function(h){for(var u,z,D,H=C.event.special,J=0;(z=h[J])!==x;J++)if(Qb(z)){if(u=z[wa.expando]){if(u.events)for(D in u.events)H[D]?C.event.remove(z,D):C.removeEvent(z,D,u.handle);z[wa.expando]=x}z[Oa.expando]&&(z[Oa.expando]=x)}}});C.fn.extend({domManip:I,detach:function(h){return L(this,h,!0)},remove:function(h){return L(this,h)},text:function(h){return lb(this,function(u){return u===x?C.text(this):this.empty().each(function(){if(1===this.nodeType||11===this.nodeType||9===this.nodeType)this.textContent=
u})},null,h,arguments.length)},append:function(){return I(this,arguments,function(h){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||g(this,h).appendChild(h)})},prepend:function(){return I(this,arguments,function(h){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var u=g(this,h);u.insertBefore(h,u.firstChild)}})},before:function(){return I(this,arguments,function(h){this.parentNode&&this.parentNode.insertBefore(h,this)})},after:function(){return I(this,arguments,function(h){this.parentNode&&
this.parentNode.insertBefore(h,this.nextSibling)})},empty:function(){for(var h,u=0;null!=(h=this[u]);u++)1===h.nodeType&&(C.cleanData(l(h,!1)),h.textContent="");return this},clone:function(h,u){h=null==h?!1:h;u=null==u?h:u;return this.map(function(){return C.clone(this,h,u)})},html:function(h){return lb(this,function(u){var z=this[0]||{},D=0,H=this.length;if(u===x&&1===z.nodeType)return z.innerHTML;if("string"===typeof u&&!$c.test(u)&&!ab[($b.exec(u)||["",""])[1].toLowerCase()]){u=C.htmlPrefilter(u);
try{for(;D<H;D++)z=this[D]||{},1===z.nodeType&&(C.cleanData(l(z,!1)),z.innerHTML=u);z=0}catch(J){}}z&&this.empty().append(u)},null,h,arguments.length)},replaceWith:function(){var h=[];return I(this,arguments,function(u){var z=this.parentNode;0>C.inArray(this,h)&&(C.cleanData(l(this)),z&&z.replaceChild(u,this))},h)}});C.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(h,u){C.fn[h]=function(z){for(var D=[],H=C(z),J=H.length-1,M=
0;M<=J;M++)z=M===J?this:this.clone(!0),C(H[M])[u](z),bc.apply(D,z.get());return this.pushStack(D)}});var Jb,gb={HTML:"block",BODY:"block"},hb=/^margin/,Vb=new RegExp("^("+ic+")(?!px)[a-z%]+$","i"),Ga=function(h){var u=h.ownerDocument.defaultView;u&&u.opener||(u=v);return u.getComputedStyle(h)},jc=function(h,u,z,D){var H,J={};for(H in u)J[H]=h.style[H],h.style[H]=u[H];z=z.apply(h,D||[]);for(H in u)h.style[H]=J[H];return z},Rb=oa.documentElement;(function(){function h(){M.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";
M.innerHTML="";Rb.appendChild(J);var Q=v.getComputedStyle(M);u="1%"!==Q.top;H="2px"===Q.marginLeft;z="4px"===Q.width;M.style.marginRight="50%";D="4px"===Q.marginRight;Rb.removeChild(J)}var u,z,D,H,J=oa.createElement("div"),M=oa.createElement("div");M.style&&(M.style.backgroundClip="content-box",M.cloneNode(!0).style.backgroundClip="",Ia.clearCloneStyle="content-box"===M.style.backgroundClip,J.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",
J.appendChild(M),C.extend(Ia,{pixelPosition:function(){h();return u},boxSizingReliable:function(){null==z&&h();return z},pixelMarginRight:function(){null==z&&h();return D},reliableMarginLeft:function(){null==z&&h();return H},reliableMarginRight:function(){var Q=M.appendChild(oa.createElement("div"));Q.style.cssText=M.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";Q.style.marginRight=Q.style.width="0";M.style.width="1px";Rb.appendChild(J);
var R=!parseFloat(v.getComputedStyle(Q).marginRight);Rb.removeChild(J);M.removeChild(Q);return R}}))})();var ad=/^(none|table(?!-c[ea]).+)/,bd={position:"absolute",visibility:"hidden",display:"block"},Ec={letterSpacing:"0",fontWeight:"400"},tc=["Webkit","O","Moz","ms"],sc=oa.createElement("div").style;C.extend({cssHooks:{opacity:{get:function(h,u){if(u)return h=W(h,"opacity"),""===h?"1":h}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,
lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(h,u,z,D){if(h&&3!==h.nodeType&&8!==h.nodeType&&h.style){var H,J=C.camelCase(u),M=h.style;u=C.cssProps[J]||(C.cssProps[J]=Z(J)||J);var Q=C.cssHooks[u]||C.cssHooks[J];if(z!==x){var R=typeof z;"string"===R&&(H=vb.exec(z))&&H[1]&&(z=q(h,u,H),R="number");null!=z&&z===z&&("number"===R&&(z+=H&&H[3]||(C.cssNumber[J]?"":"px")),Ia.clearCloneStyle||""!==z||0!==u.indexOf("background")||(M[u]=
"inherit"),Q&&"set"in Q&&(z=Q.set(h,z,D))===x||(M[u]=z))}else return Q&&"get"in Q&&(H=Q.get(h,!1,D))!==x?H:M[u]}},css:function(h,u,z,D){var H;var J=C.camelCase(u);u=C.cssProps[J]||(C.cssProps[J]=Z(J)||J);(J=C.cssHooks[u]||C.cssHooks[J])&&"get"in J&&(H=J.get(h,!0,z));H===x&&(H=W(h,u,D));"normal"===H&&u in Ec&&(H=Ec[u]);return""===z||z?(h=parseFloat(H),!0===z||isFinite(h)?h||0:H):H}});C.each(["height","width"],function(h,u){C.cssHooks[u]={get:function(z,D,H){if(D)return ad.test(C.css(z,"display"))&&
0===z.offsetWidth?jc(z,bd,function(){return ea(z,u,H)}):ea(z,u,H)},set:function(z,D,H){var J,M=H&&Ga(z);(H=H&&X(z,u,H,"border-box"===C.css(z,"boxSizing",!1,M),M))&&(J=vb.exec(D))&&"px"!==(J[3]||"px")&&(z.style[u]=D,D=C.css(z,u));return ba(z,D,H)}}});C.cssHooks.marginLeft=V(Ia.reliableMarginLeft,function(h,u){if(u)return(parseFloat(W(h,"marginLeft"))||h.getBoundingClientRect().left-jc(h,{marginLeft:0},function(){return h.getBoundingClientRect().left}))+"px"});C.cssHooks.marginRight=V(Ia.reliableMarginRight,
function(h,u){if(u)return jc(h,{display:"inline-block"},W,[h,"marginRight"])});C.each({margin:"",padding:"",border:"Width"},function(h,u){C.cssHooks[h+u]={expand:function(z){var D=0,H={};for(z="string"===typeof z?z.split(" "):[z];4>D;D++)H[h+qb[D]+u]=z[D]||z[D-2]||z[0];return H}};hb.test(h)||(C.cssHooks[h+u].set=ba)});C.fn.extend({css:function(h,u){return lb(this,function(z,D,H){var J,M={},Q=0;if(C.isArray(D)){H=Ga(z);for(J=D.length;Q<J;Q++)M[D[Q]]=C.css(z,D[Q],!1,H);return M}return H!==x?C.style(z,
D,H):C.css(z,D)},h,u,1<arguments.length)},show:function(){return Y(this,!0)},hide:function(){return Y(this)},toggle:function(h){return"boolean"===typeof h?h?this.show():this.hide():this.each(function(){rb(this)?C(this).show():C(this).hide()})}});C.Tween=aa;aa.prototype={constructor:aa,init:function(h,u,z,D,H,J){this.elem=h;this.prop=z;this.easing=H||C.easing._default;this.options=u;this.start=this.now=this.cur();this.end=D;this.unit=J||(C.cssNumber[z]?"":"px")},cur:function(){var h=aa.propHooks[this.prop];
return h&&h.get?h.get(this):aa.propHooks._default.get(this)},run:function(h){var u,z=aa.propHooks[this.prop];this.pos=this.options.duration?u=C.easing[this.easing](h,this.options.duration*h,0,1,this.options.duration):u=h;this.now=(this.end-this.start)*u+this.start;this.options.step&&this.options.step.call(this.elem,this.now,this);z&&z.set?z.set(this):aa.propHooks._default.set(this);return this}};aa.prototype.init.prototype=aa.prototype;aa.propHooks={_default:{get:function(h){return 1!==h.elem.nodeType||
null!=h.elem[h.prop]&&null==h.elem.style[h.prop]?h.elem[h.prop]:(h=C.css(h.elem,h.prop,""))&&"auto"!==h?h:0},set:function(h){if(C.fx.step[h.prop])C.fx.step[h.prop](h);else 1!==h.elem.nodeType||null==h.elem.style[C.cssProps[h.prop]]&&!C.cssHooks[h.prop]?h.elem[h.prop]=h.now:C.style(h.elem,h.prop,h.now+h.unit)}}};aa.propHooks.scrollTop=aa.propHooks.scrollLeft={set:function(h){h.elem.nodeType&&h.elem.parentNode&&(h.elem[h.prop]=h.now)}};C.easing={linear:function(h){return h},swing:function(h){return.5-
Math.cos(h*Math.PI)/2},_default:"swing"};C.fx=aa.prototype.init;C.fx.step={};var Bb,pb,Fc=/^(?:toggle|show|hide)$/,Gc=/queueHooks$/;C.Animation=C.extend(ra,{tweeners:{"*":[function(h,u){var z=this.createTween(h,u);q(z.elem,h,vb.exec(u),z);return z}]},tweener:function(h,u){C.isFunction(h)?(u=h,h=["*"]):h=h.match(fb);for(var z,D=0,H=h.length;D<H;D++)z=h[D],ra.tweeners[z]=ra.tweeners[z]||[],ra.tweeners[z].unshift(u)},prefilters:[function(h,u,z){var D,H=this,J={},M=h.style,Q=h.nodeType&&rb(h),R=wa.get(h,
"fxshow");if(!z.queue){var T=C._queueHooks(h,"fx");if(null==T.unqueued){T.unqueued=0;var ha=T.empty.fire;T.empty.fire=function(){T.unqueued||ha()}}T.unqueued++;H.always(function(){H.always(function(){T.unqueued--;C.queue(h,"fx").length||T.empty.fire()})})}if(1===h.nodeType&&("height"in u||"width"in u)){z.overflow=[M.overflow,M.overflowX,M.overflowY];var na=C.css(h,"display");var pa="none"===na?wa.get(h,"olddisplay")||S(h.nodeName):na;"inline"===pa&&"none"===C.css(h,"float")&&(M.display="inline-block")}z.overflow&&
(M.overflow="hidden",H.always(function(){M.overflow=z.overflow[0];M.overflowX=z.overflow[1];M.overflowY=z.overflow[2]}));for(D in u)if(pa=u[D],Fc.exec(pa)){delete u[D];var Pa=Pa||"toggle"===pa;if(pa===(Q?"hide":"show"))if("show"===pa&&R&&R[D]!==x)Q=!0;else continue;J[D]=R&&R[D]||C.style(h,D)}else na=x;if(C.isEmptyObject(J))"inline"===("none"===na?S(h.nodeName):na)&&(M.display=na);else for(D in R?"hidden"in R&&(Q=R.hidden):R=wa.access(h,"fxshow",{}),Pa&&(R.hidden=!Q),Q?C(h).show():H.done(function(){C(h).hide()}),
H.done(function(){var Fa;wa.remove(h,"fxshow");for(Fa in J)C.style(h,Fa,J[Fa])}),J)u=ja(Q?R[D]:0,D,H),D in R||(R[D]=u.start,Q&&(u.end=u.start,u.start="width"===D||"height"===D?1:0))}],prefilter:function(h,u){u?ra.prefilters.unshift(h):ra.prefilters.push(h)}});C.speed=function(h,u,z){var D=h&&"object"===typeof h?C.extend({},h):{complete:z||!z&&u||C.isFunction(h)&&h,duration:h,easing:z&&u||u&&!C.isFunction(u)&&u};D.duration=C.fx.off?0:"number"===typeof D.duration?D.duration:D.duration in C.fx.speeds?
C.fx.speeds[D.duration]:C.fx.speeds._default;if(null==D.queue||!0===D.queue)D.queue="fx";D.old=D.complete;D.complete=function(){C.isFunction(D.old)&&D.old.call(this);D.queue&&C.dequeue(this,D.queue)};return D};C.fn.extend({fadeTo:function(h,u,z,D){return this.filter(rb).css("opacity",0).show().end().animate({opacity:u},h,z,D)},animate:function(h,u,z,D){var H=C.isEmptyObject(h),J=C.speed(u,z,D);u=function(){var M=ra(this,C.extend({},h),J);(H||wa.get(this,"finish"))&&M.stop(!0)};u.finish=u;return H||
!1===J.queue?this.each(u):this.queue(J.queue,u)},stop:function(h,u,z){var D=function(H){var J=H.stop;delete H.stop;J(z)};"string"!==typeof h&&(z=u,u=h,h=x);u&&!1!==h&&this.queue(h||"fx",[]);return this.each(function(){var H=!0,J=null!=h&&h+"queueHooks",M=C.timers,Q=wa.get(this);if(J)Q[J]&&Q[J].stop&&D(Q[J]);else for(J in Q)Q[J]&&Q[J].stop&&Gc.test(J)&&D(Q[J]);for(J=M.length;J--;)M[J].elem!==this||null!=h&&M[J].queue!==h||(M[J].anim.stop(z),H=!1,M.splice(J,1));!H&&z||C.dequeue(this,h)})},finish:function(h){!1!==
h&&(h=h||"fx");return this.each(function(){var u=wa.get(this),z=u[h+"queue"];var D=u[h+"queueHooks"];var H=C.timers,J=z?z.length:0;u.finish=!0;C.queue(this,h,[]);D&&D.stop&&D.stop.call(this,!0);for(D=H.length;D--;)H[D].elem===this&&H[D].queue===h&&(H[D].anim.stop(!0),H.splice(D,1));for(D=0;D<J;D++)z[D]&&z[D].finish&&z[D].finish.call(this);delete u.finish})}});C.each(["toggle","show","hide"],function(h,u){var z=C.fn[u];C.fn[u]=function(D,H,J){return null==D||"boolean"===typeof D?z.apply(this,arguments):
this.animate(ia(u,!0),D,H,J)}});C.each({slideDown:ia("show"),slideUp:ia("hide"),slideToggle:ia("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(h,u){C.fn[h]=function(z,D,H){return this.animate(u,z,D,H)}});C.timers=[];C.fx.tick=function(){var h=0,u=C.timers;for(Bb=C.now();h<u.length;h++){var z=u[h];z()||u[h]!==z||u.splice(h--,1)}u.length||C.fx.stop();Bb=x};C.fx.timer=function(h){C.timers.push(h);h()?C.fx.start():C.timers.pop()};C.fx.interval=13;C.fx.start=
function(){pb||(pb=v.setInterval(C.fx.tick,C.fx.interval))};C.fx.stop=function(){v.clearInterval(pb);pb=null};C.fx.speeds={slow:600,fast:200,_default:400};C.fn.delay=function(h,u){h=C.fx?C.fx.speeds[h]||h:h;return this.queue(u||"fx",function(z,D){var H=v.setTimeout(z,h);D.stop=function(){v.clearTimeout(H)}})};(function(){var h=oa.createElement("input"),u=oa.createElement("select"),z=u.appendChild(oa.createElement("option"));h.type="checkbox";Ia.checkOn=""!==h.value;Ia.optSelected=z.selected;u.disabled=
!0;Ia.optDisabled=!z.disabled;h=oa.createElement("input");h.value="t";h.type="radio";Ia.radioValue="t"===h.value})();var Fb=C.expr.attrHandle;C.fn.extend({attr:function(h,u){return lb(this,C.attr,h,u,1<arguments.length)},removeAttr:function(h){return this.each(function(){C.removeAttr(this,h)})}});C.extend({attr:function(h,u,z){var D,H=h.nodeType;if(3!==H&&8!==H&&2!==H){if("undefined"===typeof h.getAttribute)return C.prop(h,u,z);if(1!==H||!C.isXMLDoc(h)){u=u.toLowerCase();var J=C.attrHooks[u]||(C.expr.match.bool.test(u)?
Hc:x)}if(z!==x){if(null===z){C.removeAttr(h,u);return}if(J&&"set"in J&&(D=J.set(h,z,u))!==x)return D;h.setAttribute(u,z+"");return z}if(J&&"get"in J&&null!==(D=J.get(h,u)))return D;D=C.find.attr(h,u);return null==D?x:D}},attrHooks:{type:{set:function(h,u){if(!Ia.radioValue&&"radio"===u&&C.nodeName(h,"input")){var z=h.value;h.setAttribute("type",u);z&&(h.value=z);return u}}}},removeAttr:function(h,u){var z=0,D=u&&u.match(fb);if(D&&1===h.nodeType)for(;u=D[z++];){var H=C.propFix[u]||u;C.expr.match.bool.test(u)&&
(h[H]=!1);h.removeAttribute(u)}}});var Hc={set:function(h,u,z){!1===u?C.removeAttr(h,z):h.setAttribute(z,z);return z}};C.each(C.expr.match.bool.source.match(/\w+/g),function(h,u){var z=Fb[u]||C.find.attr;Fb[u]=function(D,H,J){if(!J){var M=Fb[H];Fb[H]=Q;var Q=null!=z(D,H,J)?H.toLowerCase():null;Fb[H]=M}return Q}});var Ic=/^(?:input|select|textarea|button)$/i,cd=/^(?:a|area)$/i;C.fn.extend({prop:function(h,u){return lb(this,C.prop,h,u,1<arguments.length)},removeProp:function(h){return this.each(function(){delete this[C.propFix[h]||
h]})}});C.extend({prop:function(h,u,z){var D,H=h.nodeType;if(3!==H&&8!==H&&2!==H){if(1!==H||!C.isXMLDoc(h)){u=C.propFix[u]||u;var J=C.propHooks[u]}return z!==x?J&&"set"in J&&(D=J.set(h,z,u))!==x?D:h[u]=z:J&&"get"in J&&null!==(D=J.get(h,u))?D:h[u]}},propHooks:{tabIndex:{get:function(h){var u=C.find.attr(h,"tabindex");return u?parseInt(u,10):Ic.test(h.nodeName)||cd.test(h.nodeName)&&h.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});Ia.optSelected||(C.propHooks.selected={get:function(h){(h=
h.parentNode)&&h.parentNode&&h.parentNode.selectedIndex;return null},set:function(h){if(h=h.parentNode)h.selectedIndex,h.parentNode&&h.parentNode.selectedIndex}});C.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){C.propFix[this.toLowerCase()]=this});var kc=/[\t\r\n\f]/g;C.fn.extend({addClass:function(h){var u,z,D,H,J,M=0;if(C.isFunction(h))return this.each(function(R){C(this).addClass(h.call(this,R,za(this)))});if("string"===
typeof h&&h)for(u=h.match(fb)||[];z=this[M++];){var Q=za(z);if(D=1===z.nodeType&&(" "+Q+" ").replace(kc," ")){for(J=0;H=u[J++];)0>D.indexOf(" "+H+" ")&&(D+=H+" ");D=C.trim(D);Q!==D&&z.setAttribute("class",D)}}return this},removeClass:function(h){var u,z,D,H,J,M=0;if(C.isFunction(h))return this.each(function(R){C(this).removeClass(h.call(this,R,za(this)))});if(!arguments.length)return this.attr("class","");if("string"===typeof h&&h)for(u=h.match(fb)||[];z=this[M++];){var Q=za(z);if(D=1===z.nodeType&&
(" "+Q+" ").replace(kc," ")){for(J=0;H=u[J++];)for(;-1<D.indexOf(" "+H+" ");)D=D.replace(" "+H+" "," ");D=C.trim(D);Q!==D&&z.setAttribute("class",D)}}return this},toggleClass:function(h,u){var z=typeof h;return"boolean"===typeof u&&"string"===z?u?this.addClass(h):this.removeClass(h):C.isFunction(h)?this.each(function(D){C(this).toggleClass(h.call(this,D,za(this),u),u)}):this.each(function(){var D,H;if("string"===z){var J=0;var M=C(this);for(H=h.match(fb)||[];D=H[J++];)M.hasClass(D)?M.removeClass(D):
M.addClass(D)}else if(h===x||"boolean"===z)(D=za(this))&&wa.set(this,"__className__",D),this.setAttribute&&this.setAttribute("class",D||!1===h?"":wa.get(this,"__className__")||"")})},hasClass:function(h){var u,z=0;for(h=" "+h+" ";u=this[z++];)if(1===u.nodeType&&-1<(" "+za(u)+" ").replace(kc," ").indexOf(h))return!0;return!1}});var dd=/\r/g,ed=/[\x20\t\r\n\f]+/g;C.fn.extend({val:function(h){var u,z,D=this[0];if(arguments.length){var H=C.isFunction(h);return this.each(function(J){1===this.nodeType&&
(J=H?h.call(this,J,C(this).val()):h,null==J?J="":"number"===typeof J?J+="":C.isArray(J)&&(J=C.map(J,function(M){return null==M?"":M+""})),u=C.valHooks[this.type]||C.valHooks[this.nodeName.toLowerCase()],u&&"set"in u&&u.set(this,J,"value")!==x||(this.value=J))})}if(D){if((u=C.valHooks[D.type]||C.valHooks[D.nodeName.toLowerCase()])&&"get"in u&&(z=u.get(D,"value"))!==x)return z;z=D.value;return"string"===typeof z?z.replace(dd,""):null==z?"":z}}});C.extend({valHooks:{option:{get:function(h){var u=C.find.attr(h,
"value");return null!=u?u:C.trim(C.text(h)).replace(ed," ")}},select:{get:function(h){for(var u,z=h.options,D=h.selectedIndex,H=(h="select-one"===h.type||0>D)?null:[],J=h?D+1:z.length,M=0>D?J:h?D:0;M<J;M++)if(u=z[M],!(!u.selected&&M!==D||(Ia.optDisabled?u.disabled:null!==u.getAttribute("disabled"))||u.parentNode.disabled&&C.nodeName(u.parentNode,"optgroup"))){u=C(u).val();if(h)return u;H.push(u)}return H},set:function(h,u){for(var z,D=h.options,H=C.makeArray(u),J=D.length;J--;)if(u=D[J],u.selected=
-1<C.inArray(C.valHooks.option.get(u),H))z=!0;z||(h.selectedIndex=-1);return H}}}});C.each(["radio","checkbox"],function(){C.valHooks[this]={set:function(h,u){if(C.isArray(u))return h.checked=-1<C.inArray(C(h).val(),u)}};Ia.checkOn||(C.valHooks[this].get=function(h){return null===h.getAttribute("value")?"on":h.value})});var Jc=/^(?:focusinfocus|focusoutblur)$/;C.extend(C.event,{trigger:function(h,u,z,D){var H,J,M=[z||oa],Q=wb.call(h,"type")?h.type:h;var R=wb.call(h,"namespace")?h.namespace.split("."):
[];var T=H=z=z||oa;if(3!==z.nodeType&&8!==z.nodeType&&!Jc.test(Q+C.event.triggered)){-1<Q.indexOf(".")&&(R=Q.split("."),Q=R.shift(),R.sort());var ha=0>Q.indexOf(":")&&"on"+Q;h=h[C.expando]?h:new C.Event(Q,"object"===typeof h&&h);h.isTrigger=D?2:3;h.namespace=R.join(".");h.rnamespace=h.namespace?new RegExp("(^|\\.)"+R.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;h.result=x;h.target||(h.target=z);u=null==u?[h]:C.makeArray(u,[h]);R=C.event.special[Q]||{};if(D||!R.trigger||!1!==R.trigger.apply(z,u)){if(!D&&
!R.noBubble&&!C.isWindow(z)){var na=R.delegateType||Q;Jc.test(na+Q)||(T=T.parentNode);for(;T;T=T.parentNode)M.push(T),H=T;H===(z.ownerDocument||oa)&&M.push(H.defaultView||H.parentWindow||v)}for(H=0;(T=M[H++])&&!h.isPropagationStopped();)h.type=1<H?na:R.bindType||Q,(J=(wa.get(T,"events")||{})[h.type]&&wa.get(T,"handle"))&&J.apply(T,u),(J=ha&&T[ha])&&J.apply&&Qb(T)&&(h.result=J.apply(T,u),!1===h.result&&h.preventDefault());h.type=Q;D||h.isDefaultPrevented()||R._default&&!1!==R._default.apply(M.pop(),
u)||!Qb(z)||!ha||!C.isFunction(z[Q])||C.isWindow(z)||((H=z[ha])&&(z[ha]=null),C.event.triggered=Q,z[Q](),C.event.triggered=x,H&&(z[ha]=H));return h.result}}},simulate:function(h,u,z){h=C.extend(new C.Event,z,{type:h,isSimulated:!0});C.event.trigger(h,null,u)}});C.fn.extend({trigger:function(h,u){return this.each(function(){C.event.trigger(h,u,this)})},triggerHandler:function(h,u){var z=this[0];if(z)return C.event.trigger(h,u,z,!0)}});C.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),
function(h,u){C.fn[u]=function(z,D){return 0<arguments.length?this.on(u,null,z,D):this.trigger(u)}});C.fn.extend({hover:function(h,u){return this.mouseenter(h).mouseleave(u||h)}});Ia.focusin="onfocusin"in v;Ia.focusin||C.each({focus:"focusin",blur:"focusout"},function(h,u){var z=function(D){C.event.simulate(u,D.target,C.event.fix(D))};C.event.special[u]={setup:function(){var D=this.ownerDocument||this,H=wa.access(D,u);H||D.addEventListener(h,z,!0);wa.access(D,u,(H||0)+1)},teardown:function(){var D=
this.ownerDocument||this,H=wa.access(D,u)-1;H?wa.access(D,u,H):(D.removeEventListener(h,z,!0),wa.remove(D,u))}}});var Sb=v.location,lc=C.now(),mc=/\?/;C.parseJSON=function(h){return JSON.parse(h+"")};C.parseXML=function(h){if(!h||"string"!==typeof h)return null;try{var u=(new v.DOMParser).parseFromString(h,"text/xml")}catch(z){u=x}u&&!u.getElementsByTagName("parsererror").length||C.error("Invalid XML: "+h);return u};var fd=/#.*$/,Kc=/([?&])_=[^&]*/,gd=/^(.*?):[ \t]*([^\r\n]*)$/mg,hd=/^(?:GET|HEAD)$/,
id=/^\/\//,Lc={},ac={},Mc="*/".concat("*"),nc=oa.createElement("a");nc.href=Sb.href;C.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Sb.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Sb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Mc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,
json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":C.parseJSON,"text xml":C.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(h,u){return u?Sa(Sa(h,C.ajaxSettings),u):Sa(C.ajaxSettings,h)},ajaxPrefilter:Ba(Lc),ajaxTransport:Ba(ac),ajax:function(h,u){function z(ya,Ma,ua,Ua){var Ja=Ma;if(2!==eb){eb=2;M&&v.clearTimeout(M);D=x;H=Ua||"";xa.readyState=0<ya?4:0;Ua=200<=ya&&300>ya||304===ya;if(ua){var Da=
T;for(var Za=xa,$a,db,Ca,Ha,Xa=Da.contents,nb=Da.dataTypes;"*"===nb[0];)nb.shift(),$a===x&&($a=Da.mimeType||Za.getResponseHeader("Content-Type"));if($a)for(db in Xa)if(Xa[db]&&Xa[db].test($a)){nb.unshift(db);break}if(nb[0]in ua)Ca=nb[0];else{for(db in ua){if(!nb[0]||Da.converters[db+" "+nb[0]]){Ca=db;break}Ha||(Ha=db)}Ca=Ca||Ha}Ca?(Ca!==nb[0]&&nb.unshift(Ca),Da=ua[Ca]):Da=void 0}a:{ua=T;$a=Da;db=xa;Ca=Ua;var Nb;Za={};Xa=ua.dataTypes.slice();if(Xa[1])for(bb in ua.converters)Za[bb.toLowerCase()]=ua.converters[bb];
for(Ha=Xa.shift();Ha;){ua.responseFields[Ha]&&(db[ua.responseFields[Ha]]=$a);!tb&&Ca&&ua.dataFilter&&($a=ua.dataFilter($a,ua.dataType));var tb=Ha;if(Ha=Xa.shift())if("*"===Ha)Ha=tb;else if("*"!==tb&&tb!==Ha){var bb=Za[tb+" "+Ha]||Za["* "+Ha];if(!bb)for(Nb in Za)if(Da=Nb.split(" "),Da[1]===Ha&&(bb=Za[tb+" "+Da[0]]||Za["* "+Da[0]])){!0===bb?bb=Za[Nb]:!0!==Za[Nb]&&(Ha=Da[0],Xa.unshift(Da[1]));break}if(!0!==bb)if(bb&&ua.throws)$a=bb($a);else try{$a=bb($a)}catch(xb){Da={state:"parsererror",error:bb?xb:
"No conversion from "+tb+" to "+Ha};break a}}}Da={state:"success",data:$a}}if(Ua)if(T.ifModified&&((Ja=xa.getResponseHeader("Last-Modified"))&&(C.lastModified[cb]=Ja),(Ja=xa.getResponseHeader("etag"))&&(C.etag[cb]=Ja)),204===ya||"HEAD"===T.type)Ja="nocontent";else if(304===ya)Ja="notmodified";else{Ja=Da.state;var Wb=Da.data;var Xb=Da.error;Ua=!Xb}else if(Xb=Ja,ya||!Ja)Ja="error",0>ya&&(ya=0);xa.status=ya;xa.statusText=(Ma||Ja)+"";Ua?pa.resolveWith(ha,[Wb,Ja,xa]):pa.rejectWith(ha,[xa,Ja,Xb]);xa.statusCode(Fa);
Fa=x;Q&&na.trigger(Ua?"ajaxSuccess":"ajaxError",[xa,T,Ua?Wb:Xb]);Pa.fireWith(ha,[xa,Ja]);Q&&(na.trigger("ajaxComplete",[xa,T]),--C.active||C.event.trigger("ajaxStop"))}}"object"===typeof h&&(u=h,h=x);u=u||{};var D,H,J,M,Q,R,T=C.ajaxSetup({},u),ha=T.context||T,na=T.context&&(ha.nodeType||ha.jquery)?C(ha):C.event,pa=C.Deferred(),Pa=C.Callbacks("once memory"),Fa=T.statusCode||{},jb={},ib={},eb=0,Ac="canceled",xa={readyState:0,getResponseHeader:function(ya){var Ma;if(2===eb){if(!J)for(J={};Ma=gd.exec(H);)J[Ma[1].toLowerCase()]=
Ma[2];Ma=J[ya.toLowerCase()]}return null==Ma?null:Ma},getAllResponseHeaders:function(){return 2===eb?H:null},setRequestHeader:function(ya,Ma){var ua=ya.toLowerCase();eb||(ya=ib[ua]=ib[ua]||ya,jb[ya]=Ma);return this},overrideMimeType:function(ya){eb||(T.mimeType=ya);return this},statusCode:function(ya){var Ma;if(ya)if(2>eb)for(Ma in ya)Fa[Ma]=[Fa[Ma],ya[Ma]];else xa.always(ya[xa.status]);return this},abort:function(ya){ya=ya||Ac;D&&D.abort(ya);z(0,ya);return this}};pa.promise(xa).complete=Pa.add;xa.success=
xa.done;xa.error=xa.fail;T.url=((h||T.url||Sb.href)+"").replace(fd,"").replace(id,Sb.protocol+"//");T.type=u.method||u.type||T.method||T.type;T.dataTypes=C.trim(T.dataType||"*").toLowerCase().match(fb)||[""];if(null==T.crossDomain){h=oa.createElement("a");try{h.href=T.url,h.href=h.href,T.crossDomain=nc.protocol+"//"+nc.host!==h.protocol+"//"+h.host}catch(ya){T.crossDomain=!0}}T.data&&T.processData&&"string"!==typeof T.data&&(T.data=C.param(T.data,T.traditional));Ra(Lc,T,u,xa);if(2===eb)return xa;
(Q=C.event&&T.global)&&0===C.active++&&C.event.trigger("ajaxStart");T.type=T.type.toUpperCase();T.hasContent=!hd.test(T.type);var cb=T.url;T.hasContent||(T.data&&(cb=T.url+=(mc.test(cb)?"&":"?")+T.data,delete T.data),!1===T.cache&&(T.url=Kc.test(cb)?cb.replace(Kc,"$1_="+lc++):cb+(mc.test(cb)?"&":"?")+"_="+lc++));T.ifModified&&(C.lastModified[cb]&&xa.setRequestHeader("If-Modified-Since",C.lastModified[cb]),C.etag[cb]&&xa.setRequestHeader("If-None-Match",C.etag[cb]));(T.data&&T.hasContent&&!1!==T.contentType||
u.contentType)&&xa.setRequestHeader("Content-Type",T.contentType);xa.setRequestHeader("Accept",T.dataTypes[0]&&T.accepts[T.dataTypes[0]]?T.accepts[T.dataTypes[0]]+("*"!==T.dataTypes[0]?", "+Mc+"; q=0.01":""):T.accepts["*"]);for(R in T.headers)xa.setRequestHeader(R,T.headers[R]);if(T.beforeSend&&(!1===T.beforeSend.call(ha,xa,T)||2===eb))return xa.abort();Ac="abort";for(R in{success:1,error:1,complete:1})xa[R](T[R]);if(D=Ra(ac,T,u,xa)){xa.readyState=1;Q&&na.trigger("ajaxSend",[xa,T]);if(2===eb)return xa;
T.async&&0<T.timeout&&(M=v.setTimeout(function(){xa.abort("timeout")},T.timeout));try{eb=1,D.send(jb,z)}catch(ya){if(2>eb)z(-1,ya);else throw ya;}}else z(-1,"No Transport");return xa},getJSON:function(h,u,z){return C.get(h,u,z,"json")},getScript:function(h,u){return C.get(h,x,u,"script")}});C.each(["get","post"],function(h,u){C[u]=function(z,D,H,J){C.isFunction(D)&&(J=J||H,H=D,D=x);return C.ajax(C.extend({url:z,type:u,dataType:J,data:D,success:H},C.isPlainObject(z)&&z))}});C._evalUrl=function(h){return C.ajax({url:h,
type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};C.fn.extend({wrapAll:function(h){if(C.isFunction(h))return this.each(function(z){C(this).wrapAll(h.call(this,z))});if(this[0]){var u=C(h,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&u.insertBefore(this[0]);u.map(function(){for(var z=this;z.firstElementChild;)z=z.firstElementChild;return z}).append(this)}return this},wrapInner:function(h){return C.isFunction(h)?this.each(function(u){C(this).wrapInner(h.call(this,u))}):this.each(function(){var u=
C(this),z=u.contents();z.length?z.wrapAll(h):u.append(h)})},wrap:function(h){var u=C.isFunction(h);return this.each(function(z){C(this).wrapAll(u?h.call(this,z):h)})},unwrap:function(){return this.parent().each(function(){C.nodeName(this,"body")||C(this).replaceWith(this.childNodes)}).end()}});C.expr.filters.hidden=function(h){return!C.expr.filters.visible(h)};C.expr.filters.visible=function(h){return 0<h.offsetWidth||0<h.offsetHeight||0<h.getClientRects().length};var ub=/%20/g,uc=/\[\]$/,Tb=/\r?\n/g,
Yb=/^(?:submit|button|image|reset|file)$/i,jd=/^(?:input|select|textarea|keygen)/i;C.param=function(h,u){var z,D=[],H=function(J,M){M=C.isFunction(M)?M():null==M?"":M;D[D.length]=encodeURIComponent(J)+"="+encodeURIComponent(M)};u===x&&(u=C.ajaxSettings&&C.ajaxSettings.traditional);if(C.isArray(h)||h.jquery&&!C.isPlainObject(h))C.each(h,function(){H(this.name,this.value)});else for(z in h)Ta(z,h[z],u,H);return D.join("&").replace(ub,"+")};C.fn.extend({serialize:function(){return C.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var h=C.prop(this,"elements");return h?C.makeArray(h):this}).filter(function(){var h=this.type;return this.name&&!C(this).is(":disabled")&&jd.test(this.nodeName)&&!Yb.test(h)&&(this.checked||!Eb.test(h))}).map(function(h,u){h=C(this).val();return null==h?null:C.isArray(h)?C.map(h,function(z){return{name:u.name,value:z.replace(Tb,"\r\n")}}):{name:u.name,value:h.replace(Tb,"\r\n")}}).get()}});C.ajaxSettings.xhr=function(){try{return new v.XMLHttpRequest}catch(h){}};
var kd={0:200,1223:204},Ub=C.ajaxSettings.xhr();Ia.cors=!!Ub&&"withCredentials"in Ub;Ia.ajax=Ub=!!Ub;C.ajaxTransport(function(h){var u,z;if(Ia.cors||Ub&&!h.crossDomain)return{send:function(D,H){var J,M=h.xhr();M.open(h.type,h.url,h.async,h.username,h.password);if(h.xhrFields)for(J in h.xhrFields)M[J]=h.xhrFields[J];h.mimeType&&M.overrideMimeType&&M.overrideMimeType(h.mimeType);h.crossDomain||D["X-Requested-With"]||(D["X-Requested-With"]="XMLHttpRequest");for(J in D)M.setRequestHeader(J,D[J]);u=function(Q){return function(){u&&
(u=z=M.onload=M.onerror=M.onabort=M.onreadystatechange=null,"abort"===Q?M.abort():"error"===Q?"number"!==typeof M.status?H(0,"error"):H(M.status,M.statusText):H(kd[M.status]||M.status,M.statusText,"text"!==(M.responseType||"text")||"string"!==typeof M.responseText?{binary:M.response}:{text:M.responseText},M.getAllResponseHeaders()))}};M.onload=u();z=M.onerror=u("error");M.onabort!==x?M.onabort=z:M.onreadystatechange=function(){4===M.readyState&&v.setTimeout(function(){u&&z()})};u=u("abort");try{M.send(h.hasContent&&
h.data||null)}catch(Q){if(u)throw Q;}},abort:function(){u&&u()}}});C.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(h){C.globalEval(h);return h}}});C.ajaxPrefilter("script",function(h){h.cache===x&&(h.cache=!1);h.crossDomain&&(h.type="GET")});C.ajaxTransport("script",function(h){if(h.crossDomain){var u,z;return{send:function(D,H){u=C("<script>").prop({charset:h.scriptCharset,
src:h.url}).on("load error",z=function(J){u.remove();z=null;J&&H("error"===J.type?404:200,J.type)});oa.head.appendChild(u[0])},abort:function(){z&&z()}}}});var Nc=[],oc=/(=)\?(?=&|$)|\?\?/;C.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var h=Nc.pop()||C.expando+"_"+lc++;this[h]=!0;return h}});C.ajaxPrefilter("json jsonp",function(h,u,z){var D,H=!1!==h.jsonp&&(oc.test(h.url)?"url":"string"===typeof h.data&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&oc.test(h.data)&&
"data");if(H||"jsonp"===h.dataTypes[0]){var J=h.jsonpCallback=C.isFunction(h.jsonpCallback)?h.jsonpCallback():h.jsonpCallback;H?h[H]=h[H].replace(oc,"$1"+J):!1!==h.jsonp&&(h.url+=(mc.test(h.url)?"&":"?")+h.jsonp+"="+J);h.converters["script json"]=function(){D||C.error(J+" was not called");return D[0]};h.dataTypes[0]="json";var M=v[J];v[J]=function(){D=arguments};z.always(function(){M===x?C(v).removeProp(J):v[J]=M;h[J]&&(h.jsonpCallback=u.jsonpCallback,Nc.push(J));D&&C.isFunction(M)&&M(D[0]);D=M=x});
return"script"}});C.parseHTML=function(h,u,z){if(!h||"string"!==typeof h)return null;"boolean"===typeof u&&(z=u,u=!1);u=u||oa;var D=ec.exec(h);z=!z&&[];if(D)return[u.createElement(D[1])];D=y([h],u,z);z&&z.length&&C(z).remove();return C.merge([],D.childNodes)};var Oc=C.fn.load;C.fn.load=function(h,u,z){if("string"!==typeof h&&Oc)return Oc.apply(this,arguments);var D,H,J=this,M=h.indexOf(" ");if(-1<M){var Q=C.trim(h.slice(M));h=h.slice(0,M)}C.isFunction(u)?(z=u,u=x):u&&"object"===typeof u&&(D="POST");
0<J.length&&C.ajax({url:h,type:D||"GET",dataType:"html",data:u}).done(function(R){H=arguments;J.html(Q?C("<div>").append(C.parseHTML(R)).find(Q):R)}).always(z&&function(R,T){J.each(function(){z.apply(this,H||[R.responseText,T,R])})});return this};C.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(h,u){C.fn[u]=function(z){return this.on(u,z)}});C.expr.filters.animated=function(h){return C.grep(C.timers,function(u){return h===u.elem}).length};C.offset={setOffset:function(h,
u,z){var D=C.css(h,"position"),H=C(h),J={};"static"===D&&(h.style.position="relative");var M=H.offset();var Q=C.css(h,"top");var R=C.css(h,"left");("absolute"===D||"fixed"===D)&&-1<(Q+R).indexOf("auto")?(R=H.position(),Q=R.top,R=R.left):(Q=parseFloat(Q)||0,R=parseFloat(R)||0);C.isFunction(u)&&(u=u.call(h,z,C.extend({},M)));null!=u.top&&(J.top=u.top-M.top+Q);null!=u.left&&(J.left=u.left-M.left+R);"using"in u?u.using.call(h,J):H.css(J)}};C.fn.extend({offset:function(h){if(arguments.length)return h===
x?this:this.each(function(J){C.offset.setOffset(this,h,J)});var u=this[0];var z={top:0,left:0},D=u&&u.ownerDocument;if(D){var H=D.documentElement;if(!C.contains(H,u))return z;z=u.getBoundingClientRect();u=Qa(D);return{top:z.top+u.pageYOffset-H.clientTop,left:z.left+u.pageXOffset-H.clientLeft}}},position:function(){if(this[0]){var h=this[0],u={top:0,left:0};if("fixed"===C.css(h,"position"))var z=h.getBoundingClientRect();else{var D=this.offsetParent();z=this.offset();C.nodeName(D[0],"html")||(u=D.offset());
u.top+=C.css(D[0],"borderTopWidth",!0);u.left+=C.css(D[0],"borderLeftWidth",!0)}return{top:z.top-u.top-C.css(h,"marginTop",!0),left:z.left-u.left-C.css(h,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var h=this.offsetParent;h&&"static"===C.css(h,"position");)h=h.offsetParent;return h||Rb})}});C.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(h,u){var z="pageYOffset"===u;C.fn[h]=function(D){return lb(this,function(H,J,M){var Q=Qa(H);if(M===x)return Q?Q[u]:
H[J];Q?Q.scrollTo(z?Q.pageXOffset:M,z?M:Q.pageYOffset):H[J]=M},h,D,arguments.length)}});C.each(["top","left"],function(h,u){C.cssHooks[u]=V(Ia.pixelPosition,function(z,D){if(D)return D=W(z,u),Vb.test(D)?C(z).position()[u]+"px":D})});C.each({Height:"height",Width:"width"},function(h,u){C.each({padding:"inner"+h,content:u,"":"outer"+h},function(z,D){C.fn[D]=function(H,J){var M=arguments.length&&(z||"boolean"!==typeof H),Q=z||(!0===H||!0===J?"margin":"border");return lb(this,function(R,T,ha){return C.isWindow(R)?
R.document.documentElement["client"+h]:9===R.nodeType?(T=R.documentElement,Math.max(R.body["scroll"+h],T["scroll"+h],R.body["offset"+h],T["offset"+h],T["client"+h])):ha===x?C.css(R,T,Q):C.style(R,T,ha,Q)},u,M?H:x,M,null)}})});C.fn.extend({bind:function(h,u,z){return this.on(h,null,u,z)},unbind:function(h,u){return this.off(h,null,u)},delegate:function(h,u,z,D){return this.on(u,h,z,D)},undelegate:function(h,u,z){return 1===arguments.length?this.off(h,"**"):this.off(u,h||"**",z)},size:function(){return this.length}});
C.fn.andSelf=C.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return C});var ld=v.jQuery,md=v.$;C.noConflict=function(h){v.$===C&&(v.$=md);h&&v.jQuery===C&&(v.jQuery=ld);return C};k||(v.jQuery=v.$=C);return C});E.jQuery=jQuery;jQuery.noConflict(!0)})(window,ChemDoodle.lib);
(function(n){"function"===typeof define&&define.amd?define(["jquery"],n):"object"===typeof exports?module.exports=n:n(ChemDoodle.lib.jQuery)})(function(n){function E(f){var m=f||window.event,q=p.call(arguments,1),l=0,r=0,y=0,w=0;f=n.event.fix(m);f.type="mousewheel";"detail"in m&&(r=-1*m.detail);"wheelDelta"in m&&(r=m.wheelDelta);"wheelDeltaY"in m&&(r=m.wheelDeltaY);"wheelDeltaX"in m&&(l=-1*m.wheelDeltaX);"axis"in m&&m.axis===m.HORIZONTAL_AXIS&&(l=-1*r,r=0);var A=0===r?l:r;"deltaY"in m&&(A=r=-1*m.deltaY);
"deltaX"in m&&(l=m.deltaX,0===r&&(A=-1*l));if(0!==r||0!==l){if(1===m.deltaMode){var G=n.data(this,"mousewheel-line-height");A*=G;r*=G;l*=G}else 2===m.deltaMode&&(G=n.data(this,"mousewheel-page-height"),A*=G,r*=G,l*=G);G=Math.max(Math.abs(r),Math.abs(l));if(!e||G<e)e=G,a.settings.adjustOldDeltas&&"mousewheel"===m.type&&0===G%120&&(e/=40);a.settings.adjustOldDeltas&&"mousewheel"===m.type&&0===G%120&&(A/=40,l/=40,r/=40);A=Math[1<=A?"floor":"ceil"](A/e);l=Math[1<=l?"floor":"ceil"](l/e);r=Math[1<=r?"floor":
"ceil"](r/e);a.settings.normalizeOffset&&this.getBoundingClientRect&&(m=this.getBoundingClientRect(),y=f.clientX-m.left,w=f.clientY-m.top);f.deltaX=l;f.deltaY=r;f.deltaFactor=e;f.offsetX=y;f.offsetY=w;f.deltaMode=0;q.unshift(f,A,l,r);d&&clearTimeout(d);d=setTimeout(x,200);return(n.event.dispatch||n.event.handle).apply(this,q)}}function x(){e=null}var v=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],k="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll",
"MozMousePixelScroll"],p=Array.prototype.slice,d,e;if(n.event.fixHooks)for(var c=v.length;c;)n.event.fixHooks[v[--c]]=n.event.mouseHooks;var a=n.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var f=k.length;f;)this.addEventListener(k[--f],E,!1);else this.onmousewheel=E;n.data(this,"mousewheel-line-height",a.getLineHeight(this));n.data(this,"mousewheel-page-height",a.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var f=k.length;f;)this.removeEventListener(k[--f],
E,!1);else this.onmousewheel=null;n.removeData(this,"mousewheel-line-height");n.removeData(this,"mousewheel-page-height")},getLineHeight:function(f){f=n(f);var m=f["offsetParent"in n.fn?"offsetParent":"parent"]();m.length||(m=n("body"));return parseInt(m.css("fontSize"),10)||parseInt(f.css("fontSize"),10)||16},getPageHeight:function(f){return n(f).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};n.fn.extend({mousewheel:function(f){return f?this.bind("mousewheel",f):this.trigger("mousewheel")},
unmousewheel:function(f){return this.unbind("mousewheel",f)}})});
(function(n,E){"object"===typeof exports?module.exports=E(global):"function"===typeof define&&define.amd?define([],function(){return E(n)}):E(n)})(ChemDoodle.lib,function(n){function E(b){return k=b}function x(){return k="undefined"!==typeof Float32Array?Float32Array:Array}var v={};(function(){if("undefined"!=typeof Float32Array){var b=new Float32Array(1),g=new Int32Array(b.buffer);v.invsqrt=function(t){b[0]=t;g[0]=1597463007-(g[0]>>1);var B=b[0];return B*(1.5-.5*t*B*B)}}else v.invsqrt=function(t){return 1/
Math.sqrt(t)}})();var k=null;x();var p={create:function(b){var g=new k(3);b?(g[0]=b[0],g[1]=b[1],g[2]=b[2]):g[0]=g[1]=g[2]=0;return g},createFrom:function(b,g,t){var B=new k(3);B[0]=b;B[1]=g;B[2]=t;return B},set:function(b,g){g[0]=b[0];g[1]=b[1];g[2]=b[2];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])&&1E-6>Math.abs(b[2]-g[2])},add:function(b,g,t){if(!t||b===t)return b[0]+=g[0],b[1]+=g[1],b[2]+=g[2],b;t[0]=b[0]+g[0];t[1]=b[1]+g[1];t[2]=b[2]+g[2];return t},
subtract:function(b,g,t){if(!t||b===t)return b[0]-=g[0],b[1]-=g[1],b[2]-=g[2],b;t[0]=b[0]-g[0];t[1]=b[1]-g[1];t[2]=b[2]-g[2];return t},multiply:function(b,g,t){if(!t||b===t)return b[0]*=g[0],b[1]*=g[1],b[2]*=g[2],b;t[0]=b[0]*g[0];t[1]=b[1]*g[1];t[2]=b[2]*g[2];return t},negate:function(b,g){g||(g=b);g[0]=-b[0];g[1]=-b[1];g[2]=-b[2];return g},scale:function(b,g,t){if(!t||b===t)return b[0]*=g,b[1]*=g,b[2]*=g,b;t[0]=b[0]*g;t[1]=b[1]*g;t[2]=b[2]*g;return t},normalize:function(b,g){g||(g=b);var t=b[0],
B=b[1];b=b[2];var F=Math.sqrt(t*t+B*B+b*b);if(!F)return g[0]=0,g[1]=0,g[2]=0,g;if(1===F)return g[0]=t,g[1]=B,g[2]=b,g;F=1/F;g[0]=t*F;g[1]=B*F;g[2]=b*F;return g},cross:function(b,g,t){t||(t=b);var B=b[0],F=b[1];b=b[2];var I=g[0],L=g[1];g=g[2];t[0]=F*g-b*L;t[1]=b*I-B*g;t[2]=B*L-F*I;return t},length:function(b){var g=b[0],t=b[1];b=b[2];return Math.sqrt(g*g+t*t+b*b)},squaredLength:function(b){var g=b[0],t=b[1];b=b[2];return g*g+t*t+b*b},dot:function(b,g){return b[0]*g[0]+b[1]*g[1]+b[2]*g[2]},direction:function(b,
g,t){t||(t=b);var B=b[0]-g[0],F=b[1]-g[1];b=b[2]-g[2];g=Math.sqrt(B*B+F*F+b*b);if(!g)return t[0]=0,t[1]=0,t[2]=0,t;g=1/g;t[0]=B*g;t[1]=F*g;t[2]=b*g;return t},lerp:function(b,g,t,B){B||(B=b);B[0]=b[0]+t*(g[0]-b[0]);B[1]=b[1]+t*(g[1]-b[1]);B[2]=b[2]+t*(g[2]-b[2]);return B},dist:function(b,g){var t=g[0]-b[0],B=g[1]-b[1];b=g[2]-b[2];return Math.sqrt(t*t+B*B+b*b)}},d=null,e=new k(4);p.unproject=function(b,g,t,B,F){F||(F=b);d||(d=l.create());var I=d;e[0]=2*(b[0]-B[0])/B[2]-1;e[1]=2*(b[1]-B[1])/B[3]-1;e[2]=
2*b[2]-1;e[3]=1;l.multiply(t,g,I);if(!l.inverse(I))return null;l.multiplyVec4(I,e);if(0===e[3])return null;F[0]=e[0]/e[3];F[1]=e[1]/e[3];F[2]=e[2]/e[3];return F};var c=p.createFrom(1,0,0),a=p.createFrom(0,1,0),f=p.createFrom(0,0,1),m=p.create();p.rotationTo=function(b,g,t){t||(t=r.create());var B=p.dot(b,g);if(1<=B)r.set(y,t);else if(-.999999>B)p.cross(c,b,m),1E-6>p.length(m)&&p.cross(a,b,m),1E-6>p.length(m)&&p.cross(f,b,m),p.normalize(m),r.fromAngleAxis(Math.PI,m,t);else{B=Math.sqrt(2*(1+B));var F=
1/B;p.cross(b,g,m);t[0]=m[0]*F;t[1]=m[1]*F;t[2]=m[2]*F;t[3]=.5*B;r.normalize(t)}1<t[3]?t[3]=1:-1>t[3]&&(t[3]=-1);return t};p.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+"]"};var q={create:function(b){var g=new k(9);b?(g[0]=b[0],g[1]=b[1],g[2]=b[2],g[3]=b[3],g[4]=b[4],g[5]=b[5],g[6]=b[6],g[7]=b[7],g[8]=b[8]):g[0]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=0;return g},createFrom:function(b,g,t,B,F,I,L,O,S){var W=new k(9);W[0]=b;W[1]=g;W[2]=t;W[3]=B;W[4]=F;W[5]=I;W[6]=L;W[7]=O;W[8]=S;return W},determinant:function(b){var g=
b[3],t=b[4],B=b[5],F=b[6],I=b[7],L=b[8];return b[0]*(L*t-B*I)+b[1]*(-L*g+B*F)+b[2]*(I*g-t*F)},inverse:function(b,g){var t=b[0],B=b[1],F=b[2],I=b[3],L=b[4],O=b[5],S=b[6],W=b[7];b=b[8];var V=b*L-O*W,Z=-b*I+O*S,ba=W*I-L*S,X=t*V+B*Z+F*ba;if(!X)return null;X=1/X;g||(g=q.create());g[0]=V*X;g[1]=(-b*B+F*W)*X;g[2]=(O*B-F*L)*X;g[3]=Z*X;g[4]=(b*t-F*S)*X;g[5]=(-O*t+F*I)*X;g[6]=ba*X;g[7]=(-W*t+B*S)*X;g[8]=(L*t-B*I)*X;return g},multiply:function(b,g,t){t||(t=b);var B=b[0],F=b[1],I=b[2],L=b[3],O=b[4],S=b[5],W=
b[6],V=b[7];b=b[8];var Z=g[0],ba=g[1],X=g[2],ea=g[3],Y=g[4],aa=g[5],da=g[6],ia=g[7];g=g[8];t[0]=Z*B+ba*L+X*W;t[1]=Z*F+ba*O+X*V;t[2]=Z*I+ba*S+X*b;t[3]=ea*B+Y*L+aa*W;t[4]=ea*F+Y*O+aa*V;t[5]=ea*I+Y*S+aa*b;t[6]=da*B+ia*L+g*W;t[7]=da*F+ia*O+g*V;t[8]=da*I+ia*S+g*b;return t},multiplyVec2:function(b,g,t){t||(t=g);var B=g[0];g=g[1];t[0]=B*b[0]+g*b[3]+b[6];t[1]=B*b[1]+g*b[4]+b[7];return t},multiplyVec3:function(b,g,t){t||(t=g);var B=g[0],F=g[1];g=g[2];t[0]=B*b[0]+F*b[3]+g*b[6];t[1]=B*b[1]+F*b[4]+g*b[7];t[2]=
B*b[2]+F*b[5]+g*b[8];return t},set:function(b,g){g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];g[4]=b[4];g[5]=b[5];g[6]=b[6];g[7]=b[7];g[8]=b[8];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])&&1E-6>Math.abs(b[2]-g[2])&&1E-6>Math.abs(b[3]-g[3])&&1E-6>Math.abs(b[4]-g[4])&&1E-6>Math.abs(b[5]-g[5])&&1E-6>Math.abs(b[6]-g[6])&&1E-6>Math.abs(b[7]-g[7])&&1E-6>Math.abs(b[8]-g[8])},identity:function(b){b||(b=q.create());b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=1;b[5]=0;b[6]=
0;b[7]=0;b[8]=1;return b},transpose:function(b,g){if(!g||b===g){g=b[1];var t=b[2],B=b[5];b[1]=b[3];b[2]=b[6];b[3]=g;b[5]=b[7];b[6]=t;b[7]=B;return b}g[0]=b[0];g[1]=b[3];g[2]=b[6];g[3]=b[1];g[4]=b[4];g[5]=b[7];g[6]=b[2];g[7]=b[5];g[8]=b[8];return g},toMat4:function(b,g){g||(g=l.create());g[15]=1;g[14]=0;g[13]=0;g[12]=0;g[11]=0;g[10]=b[8];g[9]=b[7];g[8]=b[6];g[7]=0;g[6]=b[5];g[5]=b[4];g[4]=b[3];g[3]=0;g[2]=b[2];g[1]=b[1];g[0]=b[0];return g},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+
", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+"]"}},l={create:function(b){var g=new k(16);b&&(g[0]=b[0],g[1]=b[1],g[2]=b[2],g[3]=b[3],g[4]=b[4],g[5]=b[5],g[6]=b[6],g[7]=b[7],g[8]=b[8],g[9]=b[9],g[10]=b[10],g[11]=b[11],g[12]=b[12],g[13]=b[13],g[14]=b[14],g[15]=b[15]);return g},createFrom:function(b,g,t,B,F,I,L,O,S,W,V,Z,ba,X,ea,Y){var aa=new k(16);aa[0]=b;aa[1]=g;aa[2]=t;aa[3]=B;aa[4]=F;aa[5]=I;aa[6]=L;aa[7]=O;aa[8]=S;aa[9]=W;aa[10]=V;aa[11]=Z;aa[12]=ba;aa[13]=X;aa[14]=ea;aa[15]=Y;return aa},set:function(b,
g){g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];g[4]=b[4];g[5]=b[5];g[6]=b[6];g[7]=b[7];g[8]=b[8];g[9]=b[9];g[10]=b[10];g[11]=b[11];g[12]=b[12];g[13]=b[13];g[14]=b[14];g[15]=b[15];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])&&1E-6>Math.abs(b[2]-g[2])&&1E-6>Math.abs(b[3]-g[3])&&1E-6>Math.abs(b[4]-g[4])&&1E-6>Math.abs(b[5]-g[5])&&1E-6>Math.abs(b[6]-g[6])&&1E-6>Math.abs(b[7]-g[7])&&1E-6>Math.abs(b[8]-g[8])&&1E-6>Math.abs(b[9]-g[9])&&1E-6>Math.abs(b[10]-g[10])&&
1E-6>Math.abs(b[11]-g[11])&&1E-6>Math.abs(b[12]-g[12])&&1E-6>Math.abs(b[13]-g[13])&&1E-6>Math.abs(b[14]-g[14])&&1E-6>Math.abs(b[15]-g[15])},identity:function(b){b||(b=l.create());b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},transpose:function(b,g){if(!g||b===g){g=b[1];var t=b[2],B=b[3],F=b[6],I=b[7],L=b[11];b[1]=b[4];b[2]=b[8];b[3]=b[12];b[4]=g;b[6]=b[9];b[7]=b[13];b[8]=t;b[9]=F;b[11]=b[14];b[12]=B;b[13]=I;b[14]=L;
return b}g[0]=b[0];g[1]=b[4];g[2]=b[8];g[3]=b[12];g[4]=b[1];g[5]=b[5];g[6]=b[9];g[7]=b[13];g[8]=b[2];g[9]=b[6];g[10]=b[10];g[11]=b[14];g[12]=b[3];g[13]=b[7];g[14]=b[11];g[15]=b[15];return g},determinant:function(b){var g=b[0],t=b[1],B=b[2],F=b[3],I=b[4],L=b[5],O=b[6],S=b[7],W=b[8],V=b[9],Z=b[10],ba=b[11],X=b[12],ea=b[13],Y=b[14];b=b[15];return X*V*O*F-W*ea*O*F-X*L*Z*F+I*ea*Z*F+W*L*Y*F-I*V*Y*F-X*V*B*S+W*ea*B*S+X*t*Z*S-g*ea*Z*S-W*t*Y*S+g*V*Y*S+X*L*B*ba-I*ea*B*ba-X*t*O*ba+g*ea*O*ba+I*t*Y*ba-g*L*Y*ba-
W*L*B*b+I*V*B*b+W*t*O*b-g*V*O*b-I*t*Z*b+g*L*Z*b},inverse:function(b,g){g||(g=b);var t=b[0],B=b[1],F=b[2],I=b[3],L=b[4],O=b[5],S=b[6],W=b[7],V=b[8],Z=b[9],ba=b[10],X=b[11],ea=b[12],Y=b[13],aa=b[14];b=b[15];var da=t*O-B*L,ia=t*S-F*L,ja=t*W-I*L,la=B*S-F*O,ra=B*W-I*O,za=F*W-I*S,Ba=V*Y-Z*ea,Ra=V*aa-ba*ea,Sa=V*b-X*ea,Ta=Z*aa-ba*Y,Qa=Z*b-X*Y,Va=ba*b-X*aa,oa=da*Va-ia*Qa+ja*Ta+la*Sa-ra*Ra+za*Ba;if(!oa)return null;oa=1/oa;g[0]=(O*Va-S*Qa+W*Ta)*oa;g[1]=(-B*Va+F*Qa-I*Ta)*oa;g[2]=(Y*za-aa*ra+b*la)*oa;g[3]=(-Z*
za+ba*ra-X*la)*oa;g[4]=(-L*Va+S*Sa-W*Ra)*oa;g[5]=(t*Va-F*Sa+I*Ra)*oa;g[6]=(-ea*za+aa*ja-b*ia)*oa;g[7]=(V*za-ba*ja+X*ia)*oa;g[8]=(L*Qa-O*Sa+W*Ba)*oa;g[9]=(-t*Qa+B*Sa-I*Ba)*oa;g[10]=(ea*ra-Y*ja+b*da)*oa;g[11]=(-V*ra+Z*ja-X*da)*oa;g[12]=(-L*Ta+O*Ra-S*Ba)*oa;g[13]=(t*Ta-B*Ra+F*Ba)*oa;g[14]=(-ea*la+Y*ia-aa*da)*oa;g[15]=(V*la-Z*ia+ba*da)*oa;return g},toRotationMat:function(b,g){g||(g=l.create());g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];g[4]=b[4];g[5]=b[5];g[6]=b[6];g[7]=b[7];g[8]=b[8];g[9]=b[9];g[10]=b[10];
g[11]=b[11];g[12]=0;g[13]=0;g[14]=0;g[15]=1;return g},toMat3:function(b,g){g||(g=q.create());g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[4];g[4]=b[5];g[5]=b[6];g[6]=b[8];g[7]=b[9];g[8]=b[10];return g},toInverseMat3:function(b,g){var t=b[0],B=b[1],F=b[2],I=b[4],L=b[5],O=b[6],S=b[8],W=b[9];b=b[10];var V=b*L-O*W,Z=-b*I+O*S,ba=W*I-L*S,X=t*V+B*Z+F*ba;if(!X)return null;X=1/X;g||(g=q.create());g[0]=V*X;g[1]=(-b*B+F*W)*X;g[2]=(O*B-F*L)*X;g[3]=Z*X;g[4]=(b*t-F*S)*X;g[5]=(-O*t+F*I)*X;g[6]=ba*X;g[7]=(-W*t+B*S)*X;g[8]=
(L*t-B*I)*X;return g},multiply:function(b,g,t){t||(t=b);var B=b[0],F=b[1],I=b[2],L=b[3],O=b[4],S=b[5],W=b[6],V=b[7],Z=b[8],ba=b[9],X=b[10],ea=b[11],Y=b[12],aa=b[13],da=b[14];b=b[15];var ia=g[0],ja=g[1],la=g[2],ra=g[3];t[0]=ia*B+ja*O+la*Z+ra*Y;t[1]=ia*F+ja*S+la*ba+ra*aa;t[2]=ia*I+ja*W+la*X+ra*da;t[3]=ia*L+ja*V+la*ea+ra*b;ia=g[4];ja=g[5];la=g[6];ra=g[7];t[4]=ia*B+ja*O+la*Z+ra*Y;t[5]=ia*F+ja*S+la*ba+ra*aa;t[6]=ia*I+ja*W+la*X+ra*da;t[7]=ia*L+ja*V+la*ea+ra*b;ia=g[8];ja=g[9];la=g[10];ra=g[11];t[8]=ia*B+
ja*O+la*Z+ra*Y;t[9]=ia*F+ja*S+la*ba+ra*aa;t[10]=ia*I+ja*W+la*X+ra*da;t[11]=ia*L+ja*V+la*ea+ra*b;ia=g[12];ja=g[13];la=g[14];ra=g[15];t[12]=ia*B+ja*O+la*Z+ra*Y;t[13]=ia*F+ja*S+la*ba+ra*aa;t[14]=ia*I+ja*W+la*X+ra*da;t[15]=ia*L+ja*V+la*ea+ra*b;return t},multiplyVec3:function(b,g,t){t||(t=g);var B=g[0],F=g[1];g=g[2];t[0]=b[0]*B+b[4]*F+b[8]*g+b[12];t[1]=b[1]*B+b[5]*F+b[9]*g+b[13];t[2]=b[2]*B+b[6]*F+b[10]*g+b[14];return t},multiplyVec4:function(b,g,t){t||(t=g);var B=g[0],F=g[1],I=g[2];g=g[3];t[0]=b[0]*B+
b[4]*F+b[8]*I+b[12]*g;t[1]=b[1]*B+b[5]*F+b[9]*I+b[13]*g;t[2]=b[2]*B+b[6]*F+b[10]*I+b[14]*g;t[3]=b[3]*B+b[7]*F+b[11]*I+b[15]*g;return t},translate:function(b,g,t){var B=g[0],F=g[1];g=g[2];if(!t||b===t)return b[12]=b[0]*B+b[4]*F+b[8]*g+b[12],b[13]=b[1]*B+b[5]*F+b[9]*g+b[13],b[14]=b[2]*B+b[6]*F+b[10]*g+b[14],b[15]=b[3]*B+b[7]*F+b[11]*g+b[15],b;var I=b[0];var L=b[1];var O=b[2];var S=b[3];var W=b[4];var V=b[5];var Z=b[6];var ba=b[7];var X=b[8];var ea=b[9];var Y=b[10];var aa=b[11];t[0]=I;t[1]=L;t[2]=O;
t[3]=S;t[4]=W;t[5]=V;t[6]=Z;t[7]=ba;t[8]=X;t[9]=ea;t[10]=Y;t[11]=aa;t[12]=I*B+W*F+X*g+b[12];t[13]=L*B+V*F+ea*g+b[13];t[14]=O*B+Z*F+Y*g+b[14];t[15]=S*B+ba*F+aa*g+b[15];return t},scale:function(b,g,t){var B=g[0],F=g[1];g=g[2];if(!t||b===t)return b[0]*=B,b[1]*=B,b[2]*=B,b[3]*=B,b[4]*=F,b[5]*=F,b[6]*=F,b[7]*=F,b[8]*=g,b[9]*=g,b[10]*=g,b[11]*=g,b;t[0]=b[0]*B;t[1]=b[1]*B;t[2]=b[2]*B;t[3]=b[3]*B;t[4]=b[4]*F;t[5]=b[5]*F;t[6]=b[6]*F;t[7]=b[7]*F;t[8]=b[8]*g;t[9]=b[9]*g;t[10]=b[10]*g;t[11]=b[11]*g;t[12]=b[12];
t[13]=b[13];t[14]=b[14];t[15]=b[15];return t},rotate:function(b,g,t,B){var F=t[0],I=t[1];t=t[2];var L=Math.sqrt(F*F+I*I+t*t);if(!L)return null;1!==L&&(L=1/L,F*=L,I*=L,t*=L);var O=Math.sin(g);var S=Math.cos(g);var W=1-S;g=b[0];L=b[1];var V=b[2];var Z=b[3];var ba=b[4];var X=b[5];var ea=b[6];var Y=b[7];var aa=b[8];var da=b[9];var ia=b[10];var ja=b[11];var la=F*F*W+S;var ra=I*F*W+t*O;var za=t*F*W-I*O;var Ba=F*I*W-t*O;var Ra=I*I*W+S;var Sa=t*I*W+F*O;var Ta=F*t*W+I*O;F=I*t*W-F*O;I=t*t*W+S;B?b!==B&&(B[12]=
b[12],B[13]=b[13],B[14]=b[14],B[15]=b[15]):B=b;B[0]=g*la+ba*ra+aa*za;B[1]=L*la+X*ra+da*za;B[2]=V*la+ea*ra+ia*za;B[3]=Z*la+Y*ra+ja*za;B[4]=g*Ba+ba*Ra+aa*Sa;B[5]=L*Ba+X*Ra+da*Sa;B[6]=V*Ba+ea*Ra+ia*Sa;B[7]=Z*Ba+Y*Ra+ja*Sa;B[8]=g*Ta+ba*F+aa*I;B[9]=L*Ta+X*F+da*I;B[10]=V*Ta+ea*F+ia*I;B[11]=Z*Ta+Y*F+ja*I;return B},rotateX:function(b,g,t){var B=Math.sin(g);g=Math.cos(g);var F=b[4],I=b[5],L=b[6],O=b[7],S=b[8],W=b[9],V=b[10],Z=b[11];t?b!==t&&(t[0]=b[0],t[1]=b[1],t[2]=b[2],t[3]=b[3],t[12]=b[12],t[13]=b[13],
t[14]=b[14],t[15]=b[15]):t=b;t[4]=F*g+S*B;t[5]=I*g+W*B;t[6]=L*g+V*B;t[7]=O*g+Z*B;t[8]=F*-B+S*g;t[9]=I*-B+W*g;t[10]=L*-B+V*g;t[11]=O*-B+Z*g;return t},rotateY:function(b,g,t){var B=Math.sin(g);g=Math.cos(g);var F=b[0],I=b[1],L=b[2],O=b[3],S=b[8],W=b[9],V=b[10],Z=b[11];t?b!==t&&(t[4]=b[4],t[5]=b[5],t[6]=b[6],t[7]=b[7],t[12]=b[12],t[13]=b[13],t[14]=b[14],t[15]=b[15]):t=b;t[0]=F*g+S*-B;t[1]=I*g+W*-B;t[2]=L*g+V*-B;t[3]=O*g+Z*-B;t[8]=F*B+S*g;t[9]=I*B+W*g;t[10]=L*B+V*g;t[11]=O*B+Z*g;return t},rotateZ:function(b,
g,t){var B=Math.sin(g);g=Math.cos(g);var F=b[0],I=b[1],L=b[2],O=b[3],S=b[4],W=b[5],V=b[6],Z=b[7];t?b!==t&&(t[8]=b[8],t[9]=b[9],t[10]=b[10],t[11]=b[11],t[12]=b[12],t[13]=b[13],t[14]=b[14],t[15]=b[15]):t=b;t[0]=F*g+S*B;t[1]=I*g+W*B;t[2]=L*g+V*B;t[3]=O*g+Z*B;t[4]=F*-B+S*g;t[5]=I*-B+W*g;t[6]=L*-B+V*g;t[7]=O*-B+Z*g;return t},frustum:function(b,g,t,B,F,I,L){L||(L=l.create());var O=g-b,S=B-t,W=I-F;L[0]=2*F/O;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=2*F/S;L[6]=0;L[7]=0;L[8]=(g+b)/O;L[9]=(B+t)/S;L[10]=-(I+F)/W;L[11]=
-1;L[12]=0;L[13]=0;L[14]=-(I*F*2)/W;L[15]=0;return L},perspective:function(b,g,t,B,F){b=t*Math.tan(b*Math.PI/360);g*=b;return l.frustum(-g,g,-b,b,t,B,F)},ortho:function(b,g,t,B,F,I,L){L||(L=l.create());var O=g-b,S=B-t,W=I-F;L[0]=2/O;L[1]=0;L[2]=0;L[3]=0;L[4]=0;L[5]=2/S;L[6]=0;L[7]=0;L[8]=0;L[9]=0;L[10]=-2/W;L[11]=0;L[12]=-(b+g)/O;L[13]=-(B+t)/S;L[14]=-(I+F)/W;L[15]=1;return L},lookAt:function(b,g,t,B){B||(B=l.create());var F=b[0],I=b[1];b=b[2];var L=t[0];var O=t[1];var S=t[2];var W=g[0];t=g[1];var V=
g[2];if(F===W&&I===t&&b===V)return l.identity(B);g=F-W;t=I-t;W=b-V;var Z=1/Math.sqrt(g*g+t*t+W*W);g*=Z;t*=Z;W*=Z;V=O*W-S*t;S=S*g-L*W;L=L*t-O*g;(Z=Math.sqrt(V*V+S*S+L*L))?(Z=1/Z,V*=Z,S*=Z,L*=Z):L=S=V=0;O=t*L-W*S;var ba=W*V-g*L;var X=g*S-t*V;(Z=Math.sqrt(O*O+ba*ba+X*X))?(Z=1/Z,O*=Z,ba*=Z,X*=Z):X=ba=O=0;B[0]=V;B[1]=O;B[2]=g;B[3]=0;B[4]=S;B[5]=ba;B[6]=t;B[7]=0;B[8]=L;B[9]=X;B[10]=W;B[11]=0;B[12]=-(V*F+S*I+L*b);B[13]=-(O*F+ba*I+X*b);B[14]=-(g*F+t*I+W*b);B[15]=1;return B},fromRotationTranslation:function(b,
g,t){t||(t=l.create());var B=b[0],F=b[1],I=b[2],L=b[3],O=B+B,S=F+F,W=I+I;b=B*O;var V=B*S;B*=W;var Z=F*S;F*=W;I*=W;O*=L;S*=L;L*=W;t[0]=1-(Z+I);t[1]=V+L;t[2]=B-S;t[3]=0;t[4]=V-L;t[5]=1-(b+I);t[6]=F+O;t[7]=0;t[8]=B+S;t[9]=F-O;t[10]=1-(b+Z);t[11]=0;t[12]=g[0];t[13]=g[1];t[14]=g[2];t[15]=1;return t},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+", "+b[4]+", "+b[5]+", "+b[6]+", "+b[7]+", "+b[8]+", "+b[9]+", "+b[10]+", "+b[11]+", "+b[12]+", "+b[13]+", "+b[14]+", "+b[15]+"]"}},r={create:function(b){var g=
new k(4);b?(g[0]=b[0],g[1]=b[1],g[2]=b[2],g[3]=b[3]):g[0]=g[1]=g[2]=g[3]=0;return g},createFrom:function(b,g,t,B){var F=new k(4);F[0]=b;F[1]=g;F[2]=t;F[3]=B;return F},set:function(b,g){g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])&&1E-6>Math.abs(b[2]-g[2])&&1E-6>Math.abs(b[3]-g[3])},identity:function(b){b||(b=r.create());b[0]=0;b[1]=0;b[2]=0;b[3]=1;return b}},y=r.identity();r.calculateW=function(b,g){var t=b[0],
B=b[1],F=b[2];if(!g||b===g)return b[3]=-Math.sqrt(Math.abs(1-t*t-B*B-F*F)),b;g[0]=t;g[1]=B;g[2]=F;g[3]=-Math.sqrt(Math.abs(1-t*t-B*B-F*F));return g};r.dot=function(b,g){return b[0]*g[0]+b[1]*g[1]+b[2]*g[2]+b[3]*g[3]};r.inverse=function(b,g){var t=b[0],B=b[1],F=b[2],I=b[3];t=(t=t*t+B*B+F*F+I*I)?1/t:0;if(!g||b===g)return b[0]*=-t,b[1]*=-t,b[2]*=-t,b[3]*=t,b;g[0]=-b[0]*t;g[1]=-b[1]*t;g[2]=-b[2]*t;g[3]=b[3]*t;return g};r.conjugate=function(b,g){if(!g||b===g)return b[0]*=-1,b[1]*=-1,b[2]*=-1,b;g[0]=-b[0];
g[1]=-b[1];g[2]=-b[2];g[3]=b[3];return g};r.length=function(b){var g=b[0],t=b[1],B=b[2];b=b[3];return Math.sqrt(g*g+t*t+B*B+b*b)};r.normalize=function(b,g){g||(g=b);var t=b[0],B=b[1],F=b[2];b=b[3];var I=Math.sqrt(t*t+B*B+F*F+b*b);if(0===I)return g[0]=0,g[1]=0,g[2]=0,g[3]=0,g;I=1/I;g[0]=t*I;g[1]=B*I;g[2]=F*I;g[3]=b*I;return g};r.add=function(b,g,t){if(!t||b===t)return b[0]+=g[0],b[1]+=g[1],b[2]+=g[2],b[3]+=g[3],b;t[0]=b[0]+g[0];t[1]=b[1]+g[1];t[2]=b[2]+g[2];t[3]=b[3]+g[3];return t};r.multiply=function(b,
g,t){t||(t=b);var B=b[0],F=b[1],I=b[2];b=b[3];var L=g[0],O=g[1],S=g[2];g=g[3];t[0]=B*g+b*L+F*S-I*O;t[1]=F*g+b*O+I*L-B*S;t[2]=I*g+b*S+B*O-F*L;t[3]=b*g-B*L-F*O-I*S;return t};r.multiplyVec3=function(b,g,t){t||(t=g);var B=g[0],F=g[1],I=g[2];g=b[0];var L=b[1],O=b[2];b=b[3];var S=b*B+L*I-O*F,W=b*F+O*B-g*I,V=b*I+g*F-L*B;B=-g*B-L*F-O*I;t[0]=S*b+B*-g+W*-O-V*-L;t[1]=W*b+B*-L+V*-g-S*-O;t[2]=V*b+B*-O+S*-L-W*-g;return t};r.scale=function(b,g,t){if(!t||b===t)return b[0]*=g,b[1]*=g,b[2]*=g,b[3]*=g,b;t[0]=b[0]*g;
t[1]=b[1]*g;t[2]=b[2]*g;t[3]=b[3]*g;return t};r.toMat3=function(b,g){g||(g=q.create());var t=b[0],B=b[1],F=b[2],I=b[3],L=t+t,O=B+B,S=F+F;b=t*L;var W=t*O;t*=S;var V=B*O;B*=S;F*=S;L*=I;O*=I;I*=S;g[0]=1-(V+F);g[1]=W+I;g[2]=t-O;g[3]=W-I;g[4]=1-(b+F);g[5]=B+L;g[6]=t+O;g[7]=B-L;g[8]=1-(b+V);return g};r.toMat4=function(b,g){g||(g=l.create());var t=b[0],B=b[1],F=b[2],I=b[3],L=t+t,O=B+B,S=F+F;b=t*L;var W=t*O;t*=S;var V=B*O;B*=S;F*=S;L*=I;O*=I;I*=S;g[0]=1-(V+F);g[1]=W+I;g[2]=t-O;g[3]=0;g[4]=W-I;g[5]=1-(b+F);
g[6]=B+L;g[7]=0;g[8]=t+O;g[9]=B-L;g[10]=1-(b+V);g[11]=0;g[12]=0;g[13]=0;g[14]=0;g[15]=1;return g};r.slerp=function(b,g,t,B){B||(B=b);var F=b[0]*g[0]+b[1]*g[1]+b[2]*g[2]+b[3]*g[3];if(1<=Math.abs(F))return B!==b&&(B[0]=b[0],B[1]=b[1],B[2]=b[2],B[3]=b[3]),B;var I=Math.acos(F);var L=Math.sqrt(1-F*F);if(.001>Math.abs(L))return B[0]=.5*b[0]+.5*g[0],B[1]=.5*b[1]+.5*g[1],B[2]=.5*b[2]+.5*g[2],B[3]=.5*b[3]+.5*g[3],B;F=Math.sin((1-t)*I)/L;t=Math.sin(t*I)/L;B[0]=b[0]*F+g[0]*t;B[1]=b[1]*F+g[1]*t;B[2]=b[2]*F+g[2]*
t;B[3]=b[3]*F+g[3]*t;return B};r.fromRotationMatrix=function(b,g){g||(g=r.create());var t=b[0]+b[4]+b[8];if(0<t){var B=Math.sqrt(t+1);g[3]=.5*B;B=.5/B;g[0]=(b[7]-b[5])*B;g[1]=(b[2]-b[6])*B;g[2]=(b[3]-b[1])*B}else{B=r.fromRotationMatrix.s_iNext=r.fromRotationMatrix.s_iNext||[1,2,0];t=0;b[4]>b[0]&&(t=1);b[8]>b[3*t+t]&&(t=2);var F=B[t],I=B[F];B=Math.sqrt(b[3*t+t]-b[3*F+F]-b[3*I+I]+1);g[t]=.5*B;B=.5/B;g[3]=(b[3*I+F]-b[3*F+I])*B;g[F]=(b[3*F+t]+b[3*t+F])*B;g[I]=(b[3*I+t]+b[3*t+I])*B}return g};q.toQuat4=
r.fromRotationMatrix;(function(){var b=q.create();r.fromAxes=function(g,t,B,F){b[0]=t[0];b[3]=t[1];b[6]=t[2];b[1]=B[0];b[4]=B[1];b[7]=B[2];b[2]=g[0];b[5]=g[1];b[8]=g[2];return r.fromRotationMatrix(b,F)}})();r.identity=function(b){b||(b=r.create());b[0]=0;b[1]=0;b[2]=0;b[3]=1;return b};r.fromAngleAxis=function(b,g,t){t||(t=r.create());b*=.5;var B=Math.sin(b);t[3]=Math.cos(b);t[0]=B*g[0];t[1]=B*g[1];t[2]=B*g[2];return t};r.toAngleAxis=function(b,g){g||(g=b);var t=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];0<t?(g[3]=
2*Math.acos(b[3]),t=v.invsqrt(t),g[0]=b[0]*t,g[1]=b[1]*t,g[2]=b[2]*t):(g[3]=0,g[0]=1,g[1]=0,g[2]=0);return g};r.str=function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"};var w={create:function(b){var g=new k(2);b?(g[0]=b[0],g[1]=b[1]):(g[0]=0,g[1]=0);return g},createFrom:function(b,g){var t=new k(2);t[0]=b;t[1]=g;return t},add:function(b,g,t){t||(t=g);t[0]=b[0]+g[0];t[1]=b[1]+g[1];return t},subtract:function(b,g,t){t||(t=g);t[0]=b[0]-g[0];t[1]=b[1]-g[1];return t},multiply:function(b,g,t){t||
(t=g);t[0]=b[0]*g[0];t[1]=b[1]*g[1];return t},divide:function(b,g,t){t||(t=g);t[0]=b[0]/g[0];t[1]=b[1]/g[1];return t},scale:function(b,g,t){t||(t=b);t[0]=b[0]*g;t[1]=b[1]*g;return t},dist:function(b,g){var t=g[0]-b[0];b=g[1]-b[1];return Math.sqrt(t*t+b*b)},set:function(b,g){g[0]=b[0];g[1]=b[1];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])},negate:function(b,g){g||(g=b);g[0]=-b[0];g[1]=-b[1];return g},normalize:function(b,g){g||(g=b);var t=b[0]*b[0]+
b[1]*b[1];0<t?(t=Math.sqrt(t),g[0]=b[0]/t,g[1]=b[1]/t):g[0]=g[1]=0;return g},cross:function(b,g,t){b=b[0]*g[1]-b[1]*g[0];if(!t)return b;t[0]=t[1]=0;t[2]=b;return t},length:function(b){var g=b[0];b=b[1];return Math.sqrt(g*g+b*b)},squaredLength:function(b){var g=b[0];b=b[1];return g*g+b*b},dot:function(b,g){return b[0]*g[0]+b[1]*g[1]},direction:function(b,g,t){t||(t=b);var B=b[0]-g[0];b=b[1]-g[1];g=B*B+b*b;if(!g)return t[0]=0,t[1]=0,t[2]=0,t;g=1/Math.sqrt(g);t[0]=B*g;t[1]=b*g;return t},lerp:function(b,
g,t,B){B||(B=b);B[0]=b[0]+t*(g[0]-b[0]);B[1]=b[1]+t*(g[1]-b[1]);return B},str:function(b){return"["+b[0]+", "+b[1]+"]"}},A={create:function(b){var g=new k(4);b?(g[0]=b[0],g[1]=b[1],g[2]=b[2],g[3]=b[3]):g[0]=g[1]=g[2]=g[3]=0;return g},createFrom:function(b,g,t,B){var F=new k(4);F[0]=b;F[1]=g;F[2]=t;F[3]=B;return F},set:function(b,g){g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])&&1E-6>Math.abs(b[2]-g[2])&&1E-6>
Math.abs(b[3]-g[3])},identity:function(b){b||(b=A.create());b[0]=1;b[1]=0;b[2]=0;b[3]=1;return b},transpose:function(b,g){if(!g||b===g)return g=b[1],b[1]=b[2],b[2]=g,b;g[0]=b[0];g[1]=b[2];g[2]=b[1];g[3]=b[3];return g},determinant:function(b){return b[0]*b[3]-b[2]*b[1]},inverse:function(b,g){g||(g=b);var t=b[0],B=b[1],F=b[2];b=b[3];var I=t*b-F*B;if(!I)return null;I=1/I;g[0]=b*I;g[1]=-B*I;g[2]=-F*I;g[3]=t*I;return g},multiply:function(b,g,t){t||(t=b);var B=b[0],F=b[1],I=b[2];b=b[3];t[0]=B*g[0]+F*g[2];
t[1]=B*g[1]+F*g[3];t[2]=I*g[0]+b*g[2];t[3]=I*g[1]+b*g[3];return t},rotate:function(b,g,t){t||(t=b);var B=b[0],F=b[1],I=b[2];b=b[3];var L=Math.sin(g);g=Math.cos(g);t[0]=B*g+F*L;t[1]=B*-L+F*g;t[2]=I*g+b*L;t[3]=I*-L+b*g;return t},multiplyVec2:function(b,g,t){t||(t=g);var B=g[0];g=g[1];t[0]=B*b[0]+g*b[1];t[1]=B*b[2]+g*b[3];return t},scale:function(b,g,t){t||(t=b);var B=b[1],F=b[2],I=b[3],L=g[0];g=g[1];t[0]=b[0]*L;t[1]=B*g;t[2]=F*L;t[3]=I*g;return t},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+
", "+b[3]+"]"}},G={create:function(b){var g=new k(4);b?(g[0]=b[0],g[1]=b[1],g[2]=b[2],g[3]=b[3]):(g[0]=0,g[1]=0,g[2]=0,g[3]=0);return g},createFrom:function(b,g,t,B){var F=new k(4);F[0]=b;F[1]=g;F[2]=t;F[3]=B;return F},add:function(b,g,t){t||(t=g);t[0]=b[0]+g[0];t[1]=b[1]+g[1];t[2]=b[2]+g[2];t[3]=b[3]+g[3];return t},subtract:function(b,g,t){t||(t=g);t[0]=b[0]-g[0];t[1]=b[1]-g[1];t[2]=b[2]-g[2];t[3]=b[3]-g[3];return t},multiply:function(b,g,t){t||(t=g);t[0]=b[0]*g[0];t[1]=b[1]*g[1];t[2]=b[2]*g[2];
t[3]=b[3]*g[3];return t},divide:function(b,g,t){t||(t=g);t[0]=b[0]/g[0];t[1]=b[1]/g[1];t[2]=b[2]/g[2];t[3]=b[3]/g[3];return t},scale:function(b,g,t){t||(t=b);t[0]=b[0]*g;t[1]=b[1]*g;t[2]=b[2]*g;t[3]=b[3]*g;return t},set:function(b,g){g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];return g},equal:function(b,g){return b===g||1E-6>Math.abs(b[0]-g[0])&&1E-6>Math.abs(b[1]-g[1])&&1E-6>Math.abs(b[2]-g[2])&&1E-6>Math.abs(b[3]-g[3])},negate:function(b,g){g||(g=b);g[0]=-b[0];g[1]=-b[1];g[2]=-b[2];g[3]=-b[3];return g},
length:function(b){var g=b[0],t=b[1],B=b[2];b=b[3];return Math.sqrt(g*g+t*t+B*B+b*b)},squaredLength:function(b){var g=b[0],t=b[1],B=b[2];b=b[3];return g*g+t*t+B*B+b*b},lerp:function(b,g,t,B){B||(B=b);B[0]=b[0]+t*(g[0]-b[0]);B[1]=b[1]+t*(g[1]-b[1]);B[2]=b[2]+t*(g[2]-b[2]);B[3]=b[3]+t*(g[3]-b[3]);return B},str:function(b){return"["+b[0]+", "+b[1]+", "+b[2]+", "+b[3]+"]"}};n&&(n.glMatrixArrayType=k,n.MatrixArray=k,n.setMatrixArrayType=E,n.determineMatrixArrayType=x,n.glMath=v,n.vec2=w,n.vec3=p,n.vec4=
G,n.mat2=A,n.mat3=q,n.mat4=l,n.quat4=r);return{glMatrixArrayType:k,MatrixArray:k,setMatrixArrayType:E,determineMatrixArrayType:x,glMath:v,vec2:w,vec3:p,vec4:G,mat2:A,mat3:q,mat4:l,quat4:r}});
(function(n){function E(l){return 0==l?0:0<l?1:-1}var x={subtract:function(l,r){return{x:l.x-r.x,y:l.y-r.y}},dotProduct:function(l,r){return l.x*r.x+l.y*r.y},square:function(l){return Math.sqrt(l.x*l.x+l.y*l.y)},scale:function(l,r){return{x:l.x*r,y:l.y*r}}},v=Math.pow(2,-65),k=function(l,r){for(var y=[],w=r.length-1,A=2*w-1,G=[],b=[],g=[],t=[],B=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],F=0;F<=w;F++)G[F]=x.subtract(r[F],l);for(F=0;F<=w-1;F++)b[F]=x.subtract(r[F+1],r[F]),b[F]=x.scale(b[F],3);for(F=
0;F<=w-1;F++)for(var I=0;I<=w;I++)g[F]||(g[F]=[]),g[F][I]=x.dotProduct(b[F],G[I]);for(F=0;F<=A;F++)t[F]||(t[F]=[]),t[F].y=0,t[F].x=parseFloat(F)/A;A=w-1;for(G=0;G<=w+A;G++)for(b=Math.min(G,w),F=Math.max(0,G-A);F<=b;F++)I=G-F,t[F+I].y+=g[I][F]*B[I][F];w=r.length-1;t=p(t,2*w-1,y,0);A=x.subtract(l,r[0]);g=x.square(A);for(F=B=0;F<t;F++)A=x.subtract(l,d(r,w,y[F],null,null)),A=x.square(A),A<g&&(g=A,B=y[F]);A=x.subtract(l,r[w]);A=x.square(A);A<g&&(g=A,B=1);return{location:B,distance:g}},p=function(l,r,y,
w){var A=[],G=[],b=[],g=[],t=0;var B=E(l[0].y);for(var F=1;F<=r;F++){var I=E(l[F].y);I!=B&&t++;B=I}switch(t){case 0:return 0;case 1:if(64<=w)return y[0]=(l[0].x+l[r].x)/2,1;var L,O;t=l[0].y-l[r].y;I=l[r].x-l[0].x;B=l[0].x*l[r].y-l[r].x*l[0].y;F=L=0;for(O=1;O<r;O++){var S=t*l[O].x+I*l[O].y+B;S>L?L=S:S<F&&(F=S)}O=I;L=1/(0*O-1*t)*(B-L-0*O);O=I;t=1/(0*O-1*t)*(B-F-0*O);if(Math.max(L,t)-Math.min(L,t)<v)return b=l[r].x-l[0].x,g=l[r].y-l[0].y,y[0]=1/(0*b-1*g)*(b*(l[0].y-0)-g*(l[0].x-0)),1}d(l,r,.5,A,G);l=
p(A,r,b,w+1);r=p(G,r,g,w+1);for(w=0;w<l;w++)y[w]=b[w];for(w=0;w<r;w++)y[w+l]=g[w];return l+r},d=function(l,r,y,w,A){for(var G=[[]],b=0;b<=r;b++)G[0][b]=l[b];for(l=1;l<=r;l++)for(b=0;b<=r-l;b++)G[l]||(G[l]=[]),G[l][b]||(G[l][b]={}),G[l][b].x=(1-y)*G[l-1][b].x+y*G[l-1][b+1].x,G[l][b].y=(1-y)*G[l-1][b].y+y*G[l-1][b+1].y;if(null!=w)for(b=0;b<=r;b++)w[b]=G[b][0];if(null!=A)for(b=0;b<=r;b++)A[b]=G[r-b][b];return G[r][0]},e={},c=function(l){var r=e[l];if(!r){r=[];var y=function(B){return function(F){return B}},
w=function(){return function(B){return B}},A=function(){return function(B){return 1-B}},G=function(B){return function(F){for(var I=1,L=0;L<B.length;L++)I*=B[L](F);return I}};r.push(new function(){return function(B){return Math.pow(B,l)}});for(var b=1;b<l;b++){for(var g=[new y(l)],t=0;t<l-b;t++)g.push(new w);for(t=0;t<b;t++)g.push(new A);r.push(new G(g))}r.push(new function(){return function(B){return Math.pow(1-B,l)}});e[l]=r}return r},a=function(l,r){for(var y=c(l.length-1),w=0,A=0,G=0;G<l.length;G++)w+=
l[G].x*y[G](r),A+=l[G].y*y[G](r);return{x:w,y:A}},f=function(l,r){return Math.sqrt(Math.pow(l.x-r.x,2)+Math.pow(l.y-r.y,2))},m=function(l,r,y){for(var w=a(l,r),A=0,G=0<y?1:-1,b=null;A<Math.abs(y);)r+=.005*G,b=a(l,r),A+=f(b,w),w=b;return{point:b,location:r}},q=function(l,r){var y=a(l,r);r=a(l.slice(0,l.length-1),r);l=r.y-y.y;y=r.x-y.x;return 0==l?Infinity:Math.atan(l/y)};ChemDoodle.lib.jsBezier={distanceFromCurve:k,gradientAtPoint:q,gradientAtPointAlongCurveFrom:function(l,r,y){r=m(l,r,y);1<r.location&&
(r.location=1);0>r.location&&(r.location=0);return q(l,r.location)},nearestPointOnCurve:function(l,r){l=k(l,r);return{point:d(r,r.length-1,l.location,null,null),location:l.location}},pointOnCurve:a,pointAlongCurveFrom:function(l,r,y){return m(l,r,y).point},perpendicularToCurveAt:function(l,r,y,w){r=m(l,r,null==w?0:w);l=q(l,r.location);w=Math.atan(-1/l);l=y/2*Math.sin(w);y=y/2*Math.cos(w);return[{x:r.point.x+y,y:r.point.y+l},{x:r.point.x-y,y:r.point.y-l}]},locationAlongCurveFrom:function(l,r,y){return m(l,
r,y).location},getLength:function(l){for(var r=a(l,0),y=0,w=0,A;1>w;)w+=.005,A=a(l,w),y+=f(A,r),r=A;return y}}})(ChemDoodle.lib);
ChemDoodle.lib.MarchingCubes=function(){var n=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,
2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,
2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),E=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,
8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,
2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,
0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,
7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,
11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,
9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,
8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,
5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,
8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,
8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,
1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,
2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],x=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],v=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];return function(k,p){var d=[],e=[],c=0,a=new Float32Array(8),f=new Int32Array(12),m=new Int32Array(3);for(m[2]=0;m[2]<p[2]-1;++m[2],c+=p[0])for(m[1]=0;m[1]<p[1]-1;++m[1],++c)for(m[0]=0;m[0]<p[0]-1;++m[0],++c){for(var q=0,l=0;8>l;++l){var r=x[l];r=k[c+r[0]+p[0]*(r[1]+p[1]*r[2])];
a[l]=r;q|=0<r?1<<l:0}r=n[q];if(0!==r){for(l=0;12>l;++l)if(0!==(r&1<<l)){f[l]=d.length;var y=[0,0,0],w=v[l],A=x[w[0]],G=x[w[1]],b=a[w[0]],g=b-a[w[1]];w=0;1E-6<Math.abs(g)&&(w=b/g);for(b=0;3>b;++b)y[b]=m[b]+A[b]+w*(G[b]-A[b]);d.push(y)}q=E[q];for(l=0;l<q.length;l+=3)e.push([f[q[l]],f[q[l+1]],f[q[l+2]]])}}return{vertices:d,faces:e}}}();
ChemDoodle.animations=function(n,E){E={};n.requestAnimFrame=function(){return n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(x,v){n.setTimeout(x,1E3/60)}}();E.requestInterval=function(x,v){function k(){(new Date).getTime()-p>=v&&(x.call(),p=(new Date).getTime());d.value=n.requestAnimFrame(k)}if(!(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame&&n.mozCancelRequestAnimationFrame||
n.oRequestAnimationFrame||n.msRequestAnimationFrame))return n.setInterval(x,v);var p=(new Date).getTime(),d={};d.value=n.requestAnimFrame(k);return d};E.clearRequestInterval=function(x){n.cancelAnimationFrame?n.cancelAnimationFrame(x.value):n.webkitCancelAnimationFrame?n.webkitCancelAnimationFrame(x.value):n.webkitCancelRequestAnimationFrame?n.webkitCancelRequestAnimationFrame(x.value):n.mozCancelRequestAnimationFrame?n.mozCancelRequestAnimationFrame(x.value):n.oCancelRequestAnimationFrame?n.oCancelRequestAnimationFrame(x.value):
n.msCancelRequestAnimationFrame?n.msCancelRequestAnimationFrame(x.value):clearInterval(x)};E.requestTimeout=function(x,v){function k(){(new Date).getTime()-p>=v?x.call():d.value=n.requestAnimFrame(k)}if(!(n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame&&n.mozCancelRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame))return n.setTimeout(x,v);var p=(new Date).getTime(),d={};d.value=n.requestAnimFrame(k);return d};E.clearRequestTimeout=function(x){n.cancelAnimationFrame?
n.cancelAnimationFrame(x.value):n.webkitCancelAnimationFrame?n.webkitCancelAnimationFrame(x.value):n.webkitCancelRequestAnimationFrame?n.webkitCancelRequestAnimationFrame(x.value):n.mozCancelRequestAnimationFrame?n.mozCancelRequestAnimationFrame(x.value):n.oCancelRequestAnimationFrame?n.oCancelRequestAnimationFrame(x.value):n.msCancelRequestAnimationFrame?n.msCancelRequestAnimationFrame(x.value):clearTimeout(x)};return E}(window);
ChemDoodle.extensions=function(n,E,x,v){return{vec3AngleFrom:function(k,p){var d=E.length(k),e=E.length(p);k=E.dot(k,p);return x.acos(k/d/e)},contextRoundRect:function(k,p,d,e,c,a){k.beginPath();k.moveTo(p+a,d);k.lineTo(p+e-a,d);k.quadraticCurveTo(p+e,d,p+e,d+a);k.lineTo(p+e,d+c-a);k.quadraticCurveTo(p+e,d+c,p+e-a,d+c);k.lineTo(p+a,d+c);k.quadraticCurveTo(p,d+c,p,d+c-a);k.lineTo(p,d+a);k.quadraticCurveTo(p,d,p+a,d);k.closePath()},contextEllipse:function(k,p,d,e,c){var a=e/2*.5522848,f=c/2*.5522848,
m=p+e,q=d+c;e=p+e/2;c=d+c/2;k.beginPath();k.moveTo(p,c);k.bezierCurveTo(p,c-f,e-a,d,e,d);k.bezierCurveTo(e+a,d,m,c-f,m,c);k.bezierCurveTo(m,c+f,e+a,q,e,q);k.bezierCurveTo(e-a,q,p,c+f,p,c);k.closePath()},getFontString:function(k,p,d,e){var c=[];d&&c.push("bold ");e&&c.push("italic ");c.push(k+"px ");k=0;for(d=p.length;k<d;k++)e=p[k],-1!==e.indexOf(" ")&&(e='"'+e+'"'),c.push((0!==k?",":"")+e);return c.join("")}}}(ChemDoodle.structures,ChemDoodle.lib.vec3,Math);
(function(n,E,x){E.sign||(E.sign=function(v){return(0<v)-(0>v)||+v});"function"!=typeof n.assign&&(n.assign=function(v,k){if(null==v)throw new TypeError("Cannot convert undefined or null to object");for(var p=n(v),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var c in e)n.prototype.hasOwnProperty.call(e,c)&&(p[c]=e[c])}return p});String.prototype.startsWith||(String.prototype.startsWith=function(v,k){return this.substr(k||0,v.length)===v})})(Object,Math);
ChemDoodle.math=function(n,E,x,v,k){var p={},d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};p.angleBetweenLargest=function(e){if(0===e.length)return{angle:0,largest:2*v.PI};if(1===e.length)return{angle:e[0]+v.PI,largest:2*v.PI};for(var c=0,a=0,f=0,m=e.length-1;f<m;f++){var q=e[f+1]-e[f];
q>c&&(c=q,a=(e[f+1]+e[f])/2)}f=e[0]+2*v.PI-e[e.length-1];f>c&&(a=e[0]-f/2,c=f,0>a&&(a+=2*v.PI));return{angle:a,largest:c}};p.isBetween=function(e,c,a){if(c>a){var f=c;c=a;a=f}return e>=c&&e<=a};x(document).ready(function(){n&&n.iChemLabs&&n.iChemLabs.checkForUpdates&&n.iChemLabs.checkForUpdates({})});p.getRGB=function(e,c){var a=[0,0,0];d[e.toLowerCase()]&&(e=d[e.toLowerCase()]);return"#"===e.charAt(0)?(4===e.length&&(e="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3)),
[parseInt(e.substring(1,3),16)/255*c,parseInt(e.substring(3,5),16)/255*c,parseInt(e.substring(5,7),16)/255*c]):e.startsWith("rgba")?(e=e.replace(/rgba\(|\)/g,"").split(","),4!==e.length?a:[parseInt(e[0])/255*c,parseInt(e[1])/255*c,parseInt(e[2])/255*c,parseInt(e[3])/255*c]):e.startsWith("rgb")?(e=e.replace(/rgb\(|\)/g,"").split(","),3!==e.length?a:[parseInt(e[0])/255*c,parseInt(e[1])/255*c,parseInt(e[2])/255*c]):a};p.hsl2rgb=function(e,c,a){var f=function(l,r,y){0>y?y+=1:1<y&&--y;return y<1/6?l+6*
(r-l)*y:.5>y?r:y<2/3?l+(r-l)*(2/3-y)*6:l};if(0===c)a=c=e=a;else{var m=.5>a?a*(1+c):a+c-a*c,q=2*a-m;a=f(q,m,e+1/3);c=f(q,m,e);e=f(q,m,e-1/3)}return[255*a,255*c,255*e]};p.idx2color=function(e){e=e.toString(16);for(var c=0,a=6-e.length;c<a;c++)e="0"+e;return"#"+e};p.distanceFromPointToLineInclusive=function(e,c,a,f){var m=c.distance(a);a=c.angle(a);a=v.PI/2-a;a=c.angle(e)+a;e=c.distance(e);e=new E.Point(e*v.cos(a),-e*v.sin(a));f=f?f:0;return p.isBetween(-e.y,f,m-f)?v.abs(e.x):-1};p.calculateDistanceInterior=
function(e,c,a){if(this.isBetween(c.x,a.x,a.x+a.w)&&this.isBetween(c.y,a.y,a.y+a.h))return e.distance(c);var f=[];f.push({x1:a.x,y1:a.y,x2:a.x+a.w,y2:a.y});f.push({x1:a.x,y1:a.y+a.h,x2:a.x+a.w,y2:a.y+a.h});f.push({x1:a.x,y1:a.y,x2:a.x,y2:a.y+a.h});f.push({x1:a.x+a.w,y1:a.y,x2:a.x+a.w,y2:a.y+a.h});a=[];for(var m=0;4>m;m++){var q=f[m];(q=this.intersectLines(c.x,c.y,e.x,e.y,q.x1,q.y1,q.x2,q.y2))&&a.push(q)}if(0===a.length)return 0;f=c=0;for(m=a.length;f<m;f++){var l=a[f];q=e.x-l.x;l=e.y-l.y;c=v.max(c,
v.sqrt(q*q+l*l))}return c};p.intersectLines=function(e,c,a,f,m,q,l,r){a-=e;f-=c;l-=m;r-=q;var y=f*l-a*r;if(0===y)return!1;l=(r*(e-m)-l*(c-q))/y;m=(f*(e-m)-a*(c-q))/y;return 0<=m&&1>=m&&0<=l&&1>=l?{x:e+l*a,y:c+l*f}:!1};p.clamp=function(e,c,a){return e<c?c:e>a?a:e};p.rainbowAt=function(e,c,a){1>a.length?a.push("#000000","#FFFFFF"):2>a.length&&a.push("#FFFFFF");var f=c/(a.length-1);c=v.floor(e/f);e=(e-c*f)/f;f=p.getRGB(a[c],1);a=p.getRGB(a[c+1],1);return"rgb("+[255*(f[0]+(a[0]-f[0])*e),255*(f[1]+(a[1]-
f[1])*e),255*(f[2]+(a[2]-f[2])*e)].join()+")"};p.angleBounds=function(e,c,a){for(var f=2*v.PI;0>e;)e+=f;for(;e>f;)e-=f;a&&e>v.PI&&(e=2*v.PI-e);c&&(e=180*e/v.PI);return e};p.isPointInPoly=function(e,c){for(var a=!1,f=-1,m=e.length,q=m-1;++f<m;q=f)(e[f].y<=c.y&&c.y<e[q].y||e[q].y<=c.y&&c.y<e[f].y)&&c.x<(e[q].x-e[f].x)*(c.y-e[f].y)/(e[q].y-e[f].y)+e[f].x&&(a=!a);return a};return p}(ChemDoodle,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math);
(function(n,E,x){n.Bounds=function(){};var v=n.Bounds.prototype;v.minX=v.minY=v.minZ=Infinity;v.maxX=v.maxY=v.maxZ=-Infinity;v.expand=function(k,p,d,e){k instanceof n.Bounds?(this.minX=E.min(this.minX,k.minX),this.minY=E.min(this.minY,k.minY),this.maxX=E.max(this.maxX,k.maxX),this.maxY=E.max(this.maxY,k.maxY),Infinity!==k.maxZ&&(this.minZ=E.min(this.minZ,k.minZ),this.maxZ=E.max(this.maxZ,k.maxZ))):(this.minX=E.min(this.minX,k),this.maxX=E.max(this.maxX,k),this.minY=E.min(this.minY,p),this.maxY=E.max(this.maxY,
p),d!==x&&e!==x&&(this.minX=E.min(this.minX,d),this.maxX=E.max(this.maxX,d),this.minY=E.min(this.minY,e),this.maxY=E.max(this.maxY,e)))};v.expand3D=function(k,p,d,e,c,a){this.minX=E.min(this.minX,k);this.maxX=E.max(this.maxX,k);this.minY=E.min(this.minY,p);this.maxY=E.max(this.maxY,p);this.minZ=E.min(this.minZ,d);this.maxZ=E.max(this.maxZ,d);e!==x&&c!==x&&a!==x&&(this.minX=E.min(this.minX,e),this.maxX=E.max(this.maxX,e),this.minY=E.min(this.minY,c),this.maxY=E.max(this.maxY,c),this.minZ=E.min(this.minZ,
a),this.maxZ=E.max(this.maxZ,a))}})(ChemDoodle.math,Math);
ChemDoodle.featureDetection=function(n,E,x,v,k){var p={supports_canvas:function(){return!!x.createElement("canvas").getContext},supports_canvas_text:function(){return p.supports_canvas()?"function"===typeof x.createElement("canvas").getContext("2d").fillText:!1},supports_webgl:function(){var d=x.createElement("canvas");try{if(d.getContext("webgl")||d.getContext("experimental-webgl"))return!0}catch(e){}return!1},supports_xhr2:function(){return E.support.cors},supports_touch:function(){var d=(/iPhone|iPad|iPod|Android|BlackBerry|BB10/i.test(navigator.userAgent)||
"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints)&&!v.MSStream;return"ontouchstart"in v&&d},supports_gesture:function(){return"ongesturestart"in v}};return p}(ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document,window);ChemDoodle.SYMBOLS="H He Li Be B C N O F Ne Na Mg Al Si P S Cl Ar K Ca Sc Ti V Cr Mn Fe Co Ni Cu Zn Ga Ge As Se Br Kr Rb Sr Y Zr Nb Mo Tc Ru Rh Pd Ag Cd In Sn Sb Te I Xe Cs Ba La Ce Pr Nd Pm Sm Eu Gd Tb Dy Ho Er Tm Yb Lu Hf Ta W Re Os Ir Pt Au Hg Tl Pb Bi Po At Rn Fr Ra Ac Th Pa U Np Pu Am Cm Bk Cf Es Fm Md No Lr Rf Db Sg Bh Hs Mt Ds Rg Cn Nh Fl Mc Lv Ts Og".split(" ");
ChemDoodle.ELEMENT=function(n,E){function x(v,k,p,d,e,c,a,f,m){this.symbol=v;this.name=k;this.atomicNumber=p;this.addH=d;this.jmolColor=this.pymolColor=e;this.covalentRadius=c;this.vdWRadius=a;this.valency=f;this.mass=m}n=[];n.H=new x("H","Hydrogen",1,!1,"#FFFFFF",.31,1.1,1,1);n.He=new x("He","Helium",2,!1,"#D9FFFF",.28,1.4,0,4);n.Li=new x("Li","Lithium",3,!1,"#CC80FF",1.28,1.82,1,7);n.Be=new x("Be","Beryllium",4,!1,"#C2FF00",.96,1.53,2,9);n.B=new x("B","Boron",5,!0,"#FFB5B5",.84,1.92,3,11);n.C=new x("C",
"Carbon",6,!0,"#909090",.76,1.7,4,12);n.N=new x("N","Nitrogen",7,!0,"#3050F8",.71,1.55,3,14);n.O=new x("O","Oxygen",8,!0,"#FF0D0D",.66,1.52,2,16);n.F=new x("F","Fluorine",9,!0,"#90E050",.57,1.47,1,19);n.Ne=new x("Ne","Neon",10,!1,"#B3E3F5",.58,1.54,0,20);n.Na=new x("Na","Sodium",11,!1,"#AB5CF2",1.66,2.27,1,23);n.Mg=new x("Mg","Magnesium",12,!1,"#8AFF00",1.41,1.73,0,24);n.Al=new x("Al","Aluminum",13,!1,"#BFA6A6",1.21,1.84,0,27);n.Si=new x("Si","Silicon",14,!0,"#F0C8A0",1.11,2.1,4,28);n.P=new x("P",
"Phosphorus",15,!0,"#FF8000",1.07,1.8,3,31);n.S=new x("S","Sulfur",16,!0,"#FFFF30",1.05,1.8,2,32);n.Cl=new x("Cl","Chlorine",17,!0,"#1FF01F",1.02,1.75,1,35);n.Ar=new x("Ar","Argon",18,!1,"#80D1E3",1.06,1.88,0,40);n.K=new x("K","Potassium",19,!1,"#8F40D4",2.03,2.75,0,39);n.Ca=new x("Ca","Calcium",20,!1,"#3DFF00",1.76,2.31,0,40);n.Sc=new x("Sc","Scandium",21,!1,"#E6E6E6",1.7,0,0,45);n.Ti=new x("Ti","Titanium",22,!1,"#BFC2C7",1.6,0,1,48);n.V=new x("V","Vanadium",23,!1,"#A6A6AB",1.53,0,1,51);n.Cr=new x("Cr",
"Chromium",24,!1,"#8A99C7",1.39,0,2,52);n.Mn=new x("Mn","Manganese",25,!1,"#9C7AC7",1.39,0,3,55);n.Fe=new x("Fe","Iron",26,!1,"#E06633",1.32,0,2,56);n.Co=new x("Co","Cobalt",27,!1,"#F090A0",1.26,0,1,59);n.Ni=new x("Ni","Nickel",28,!1,"#50D050",1.24,1.63,1,58);n.Cu=new x("Cu","Copper",29,!1,"#C88033",1.32,1.4,0,63);n.Zn=new x("Zn","Zinc",30,!1,"#7D80B0",1.22,1.39,0,64);n.Ga=new x("Ga","Gallium",31,!1,"#C28F8F",1.22,1.87,0,69);n.Ge=new x("Ge","Germanium",32,!1,"#668F8F",1.2,2.11,4,74);n.As=new x("As",
"Arsenic",33,!0,"#BD80E3",1.19,1.85,3,75);n.Se=new x("Se","Selenium",34,!0,"#FFA100",1.2,1.9,2,80);n.Br=new x("Br","Bromine",35,!0,"#A62929",1.2,1.85,1,79);n.Kr=new x("Kr","Krypton",36,!1,"#5CB8D1",1.16,2.02,0,84);n.Rb=new x("Rb","Rubidium",37,!1,"#702EB0",2.2,3.03,0,85);n.Sr=new x("Sr","Strontium",38,!1,"#00FF00",1.95,2.49,0,88);n.Y=new x("Y","Yttrium",39,!1,"#94FFFF",1.9,0,0,89);n.Zr=new x("Zr","Zirconium",40,!1,"#94E0E0",1.75,0,0,90);n.Nb=new x("Nb","Niobium",41,!1,"#73C2C9",1.64,0,1,93);n.Mo=
new x("Mo","Molybdenum",42,!1,"#54B5B5",1.54,0,2,98);n.Tc=new x("Tc","Technetium",43,!1,"#3B9E9E",1.47,0,3,0);n.Ru=new x("Ru","Ruthenium",44,!1,"#248F8F",1.46,0,2,102);n.Rh=new x("Rh","Rhodium",45,!1,"#0A7D8C",1.42,0,1,103);n.Pd=new x("Pd","Palladium",46,!1,"#006985",1.39,1.63,0,106);n.Ag=new x("Ag","Silver",47,!1,"#C0C0C0",1.45,1.72,0,107);n.Cd=new x("Cd","Cadmium",48,!1,"#FFD98F",1.44,1.58,0,114);n.In=new x("In","Indium",49,!1,"#A67573",1.42,1.93,0,115);n.Sn=new x("Sn","Tin",50,!1,"#668080",1.39,
2.17,4,120);n.Sb=new x("Sb","Antimony",51,!1,"#9E63B5",1.39,2.06,3,121);n.Te=new x("Te","Tellurium",52,!0,"#D47A00",1.38,2.06,2,130);n.I=new x("I","Iodine",53,!0,"#940094",1.39,1.98,1,127);n.Xe=new x("Xe","Xenon",54,!1,"#429EB0",1.4,2.16,0,132);n.Cs=new x("Cs","Cesium",55,!1,"#57178F",2.44,3.43,0,133);n.Ba=new x("Ba","Barium",56,!1,"#00C900",2.15,2.68,0,138);n.La=new x("La","Lanthanum",57,!1,"#70D4FF",2.07,0,0,139);n.Ce=new x("Ce","Cerium",58,!1,"#FFFFC7",2.04,0,0,140);n.Pr=new x("Pr","Praseodymium",
59,!1,"#D9FFC7",2.03,0,0,141);n.Nd=new x("Nd","Neodymium",60,!1,"#C7FFC7",2.01,0,0,142);n.Pm=new x("Pm","Promethium",61,!1,"#A3FFC7",1.99,0,0,0);n.Sm=new x("Sm","Samarium",62,!1,"#8FFFC7",1.98,0,0,152);n.Eu=new x("Eu","Europium",63,!1,"#61FFC7",1.98,0,0,153);n.Gd=new x("Gd","Gadolinium",64,!1,"#45FFC7",1.96,0,0,158);n.Tb=new x("Tb","Terbium",65,!1,"#30FFC7",1.94,0,0,159);n.Dy=new x("Dy","Dysprosium",66,!1,"#1FFFC7",1.92,0,0,164);n.Ho=new x("Ho","Holmium",67,!1,"#00FF9C",1.92,0,0,165);n.Er=new x("Er",
"Erbium",68,!1,"#00E675",1.89,0,0,166);n.Tm=new x("Tm","Thulium",69,!1,"#00D452",1.9,0,0,169);n.Yb=new x("Yb","Ytterbium",70,!1,"#00BF38",1.87,0,0,174);n.Lu=new x("Lu","Lutetium",71,!1,"#00AB24",1.87,0,0,175);n.Hf=new x("Hf","Hafnium",72,!1,"#4DC2FF",1.75,0,0,180);n.Ta=new x("Ta","Tantalum",73,!1,"#4DA6FF",1.7,0,1,181);n.W=new x("W","Tungsten",74,!1,"#2194D6",1.62,0,2,184);n.Re=new x("Re","Rhenium",75,!1,"#267DAB",1.51,0,3,187);n.Os=new x("Os","Osmium",76,!1,"#266696",1.44,0,2,192);n.Ir=new x("Ir",
"Iridium",77,!1,"#175487",1.41,0,3,193);n.Pt=new x("Pt","Platinum",78,!1,"#D0D0E0",1.36,1.75,0,195);n.Au=new x("Au","Gold",79,!1,"#FFD123",1.36,1.66,1,197);n.Hg=new x("Hg","Mercury",80,!1,"#B8B8D0",1.32,1.55,0,202);n.Tl=new x("Tl","Thallium",81,!1,"#A6544D",1.45,1.96,0,205);n.Pb=new x("Pb","Lead",82,!1,"#575961",1.46,2.02,4,208);n.Bi=new x("Bi","Bismuth",83,!1,"#9E4FB5",1.48,2.07,3,209);n.Po=new x("Po","Polonium",84,!1,"#AB5C00",1.4,1.97,2,0);n.At=new x("At","Astatine",85,!0,"#754F45",1.5,2.02,1,
0);n.Rn=new x("Rn","Radon",86,!1,"#428296",1.5,2.2,0,0);n.Fr=new x("Fr","Francium",87,!1,"#420066",2.6,3.48,0,0);n.Ra=new x("Ra","Radium",88,!1,"#007D00",2.21,2.83,0,0);n.Ac=new x("Ac","Actinium",89,!1,"#70ABFA",2.15,0,0,0);n.Th=new x("Th","Thorium",90,!1,"#00BAFF",2.06,0,0,232);n.Pa=new x("Pa","Protactinium",91,!1,"#00A1FF",2,0,0,231);n.U=new x("U","Uranium",92,!1,"#008FFF",1.96,1.86,0,238);n.Np=new x("Np","Neptunium",93,!1,"#0080FF",1.9,0,0,0);n.Pu=new x("Pu","Plutonium",94,!1,"#006BFF",1.87,0,
0,0);n.Am=new x("Am","Americium",95,!1,"#545CF2",1.8,0,0,0);n.Cm=new x("Cm","Curium",96,!1,"#785CE3",1.69,0,0,0);n.Bk=new x("Bk","Berkelium",97,!1,"#8A4FE3",0,0,0,0);n.Cf=new x("Cf","Californium",98,!1,"#A136D4",0,0,0,0);n.Es=new x("Es","Einsteinium",99,!1,"#B31FD4",0,0,0,0);n.Fm=new x("Fm","Fermium",100,!1,"#B31FBA",0,0,0,0);n.Md=new x("Md","Mendelevium",101,!1,"#B30DA6",0,0,0,0);n.No=new x("No","Nobelium",102,!1,"#BD0D87",0,0,0,0);n.Lr=new x("Lr","Lawrencium",103,!1,"#C70066",0,0,0,0);n.Rf=new x("Rf",
"Rutherfordium",104,!1,"#CC0059",0,0,0,0);n.Db=new x("Db","Dubnium",105,!1,"#D1004F",0,0,0,0);n.Sg=new x("Sg","Seaborgium",106,!1,"#D90045",0,0,0,0);n.Bh=new x("Bh","Bohrium",107,!1,"#E00038",0,0,0,0);n.Hs=new x("Hs","Hassium",108,!1,"#E6002E",0,0,0,0);n.Mt=new x("Mt","Meitnerium",109,!1,"#EB0026",0,0,0,0);n.Ds=new x("Ds","Darmstadtium",110,!1,"#000000",0,0,0,0);n.Rg=new x("Rg","Roentgenium",111,!1,"#000000",0,0,0,0);n.Cn=new x("Cn","Copernicium",112,!1,"#000000",0,0,0,0);n.Nh=new x("Nh","Nihonium",
113,!1,"#000000",0,0,0,0);n.Fl=new x("Fl","Flerovium",114,!1,"#000000",0,0,0,0);n.Mc=new x("Mc","Moscovium",115,!1,"#000000",0,0,0,0);n.Lv=new x("Lv","Livermorium",116,!1,"#000000",0,0,0,0);n.Ts=new x("Ts","Tennessine",117,!1,"#000000",0,0,0,0);n.Og=new x("Og","Oganesson",118,!1,"#000000",0,0,0,0);n.H.pymolColor="#E6E6E6";n.C.pymolColor="#33FF33";n.N.pymolColor="#3333FF";n.O.pymolColor="#FF4D4D";n.F.pymolColor="#B3FFFF";n.S.pymolColor="#E6C640";return n}(ChemDoodle.SYMBOLS);
ChemDoodle.RESIDUE=function(n){function E(x,v,k,p,d,e){this.symbol=x;this.name=v;this.polar=k;this.aminoColor=p;this.shapelyColor=d;this.acidity=e}n=[];n.Ala=new E("Ala","Alanine",!1,"#C8C8C8","#8CFF8C",0);n.Arg=new E("Arg","Arginine",!0,"#145AFF","#00007C",1);n.Asn=new E("Asn","Asparagine",!0,"#00DCDC","#FF7C70",0);n.Asp=new E("Asp","Aspartic Acid",!0,"#E60A0A","#A00042",-1);n.Cys=new E("Cys","Cysteine",!0,"#E6E600","#FFFF70",0);n.Gln=new E("Gln","Glutamine",!0,"#00DCDC","#FF4C4C",0);n.Glu=new E("Glu",
"Glutamic Acid",!0,"#E60A0A","#660000",-1);n.Gly=new E("Gly","Glycine",!1,"#EBEBEB","#FFFFFF",0);n.His=new E("His","Histidine",!0,"#8282D2","#7070FF",1);n.Ile=new E("Ile","Isoleucine",!1,"#0F820F","#004C00",0);n.Leu=new E("Leu","Leucine",!1,"#0F820F","#455E45",0);n.Lys=new E("Lys","Lysine",!0,"#145AFF","#4747B8",1);n.Met=new E("Met","Methionine",!1,"#E6E600","#B8A042",0);n.Phe=new E("Phe","Phenylalanine",!1,"#3232AA","#534C52",0);n.Pro=new E("Pro","Proline",!1,"#DC9682","#525252",0);n.Ser=new E("Ser",
"Serine",!0,"#FA9600","#FF7042",0);n.Thr=new E("Thr","Threonine",!0,"#FA9600","#B84C00",0);n.Trp=new E("Trp","Tryptophan",!0,"#B45AB4","#4F4600",0);n.Tyr=new E("Tyr","Tyrosine",!0,"#3232AA","#8C704C",0);n.Val=new E("Val","Valine",!1,"#0F820F","#FF8CFF",0);n.Asx=new E("Asx","Asparagine/Aspartic Acid",!0,"#FF69B4","#FF00FF",0);n.Glx=new E("Glx","Glutamine/Glutamic Acid",!0,"#FF69B4","#FF00FF",0);n["*"]=new E("*","Other",!1,"#BEA06E","#FF00FF",0);n.A=new E("A","Adenine",!1,"#BEA06E","#A0A0FF",0);n.G=
new E("G","Guanine",!1,"#BEA06E","#FF7070",0);n.I=new E("I","",!1,"#BEA06E","#80FFFF",0);n.C=new E("C","Cytosine",!1,"#BEA06E","#FF8C4B",0);n.T=new E("T","Thymine",!1,"#BEA06E","#A0FFA0",0);n.U=new E("U","Uracil",!1,"#BEA06E","#FF8080",0);return n}();
(function(n,E){n.Queue=function(){this.queue=[]};n=n.Queue.prototype;n.queueSpace=0;n.getSize=function(){return this.queue.length-this.queueSpace};n.isEmpty=function(){return 0===this.queue.length};n.enqueue=function(x){this.queue.push(x)};n.dequeue=function(){if(this.queue.length){var x=this.queue[this.queueSpace];2*++this.queueSpace>=this.queue.length&&(this.queue=this.queue.slice(this.queueSpace),this.queueSpace=0)}return x};n.getOldestElement=function(){var x;this.queue.length&&(x=this.queue[this.queueSpace]);
return x}})(ChemDoodle.structures);
(function(n,E,x){n.Point=function(v,k){this.x=v?v:0;this.y=k?k:0};n=n.Point.prototype;n.sub=function(v){this.x-=v.x;this.y-=v.y};n.add=function(v){this.x+=v.x;this.y+=v.y};n.distance=function(v){var k=v.x-this.x;v=v.y-this.y;return E.sqrt(k*k+v*v)};n.angleForStupidCanvasArcs=function(v){var k=v.x-this.x;v=v.y-this.y;for(k=0===k?0===v?0:0<v?E.PI/2:3*E.PI/2:0===v?0<k?0:E.PI:0>k?E.atan(v/k)+E.PI:0>v?E.atan(v/k)+2*E.PI:E.atan(v/k);0>k;)k+=2*E.PI;return k%=2*E.PI};n.angle=function(v){var k=v.x-this.x;
v=this.y-v.y;for(k=0===k?0===v?0:0<v?E.PI/2:3*E.PI/2:0===v?0<k?0:E.PI:0>k?E.atan(v/k)+E.PI:0>v?E.atan(v/k)+2*E.PI:E.atan(v/k);0>k;)k+=2*E.PI;return k%=2*E.PI}})(ChemDoodle.structures,Math);
(function(n,E,x,v){var k=/[ ,]+/,p=/\-+/,d=["Helvetica","Arial","Dialog"];E.Query=function(e){this.type=e;this.elements={v:[],not:!1};this.saturation=this.hydrogens=this.connectivityNoH=this.connectivity=this.chirality=this.charge=v;this.orders={v:[],not:!1};this.cache=this.ringCount=this.aromatic=this.stereo=v};E.Query.TYPE_ATOM=0;E.Query.TYPE_BOND=1;x=E.Query.prototype;x.parseRange=function(e){var c=[];e=e.split(k);for(var a=0,f=e.length;a<f;a++){var m=e[a],q=!1,l=!1;"-"===m.charAt(0)&&(q=!0,m=
m.substring(1));-1!=m.indexOf("--")&&(l=!0);-1!=m.indexOf("-")?(m=m.split(p),q={x:parseInt(m[0])*(q?-1:1),y:parseInt(m[1])*(l?-1:1)},q.y<q.x&&(l=q.y,q.y=q.x,q.x=l),c.push(q)):c.push({x:parseInt(m)*(q?-1:1)})}return c};x.draw=function(e,c,a){this.cache||(this.cache=this.toString());var f=this.cache,m=v,q=f.indexOf("(");-1!=q&&(f=this.cache.substring(0,q),m=this.cache.substring(q,this.cache.length));e.textAlign="center";e.textBaseline="middle";e.font=n.getFontString(12,d,!0,!1);q=e.measureText(f).width;
e.fillStyle=c.backgroundColor;e.fillRect(a.x-q/2,a.y-6,q,12);e.fillStyle="black";e.fillText(f,a.x,a.y);m&&(e.font=n.getFontString(10,d,!1,!0),q=e.measureText(m).width,e.fillStyle=c.backgroundColor,e.fillRect(a.x-q/2,a.y+6,q,11),e.fillStyle="black",e.fillText(m,a.x,a.y+11))};x.outputRange=function(e){for(var c=!1,a=[],f=0,m=e.length;f<m;f++){c&&a.push(",");c=!0;var q=e[f];q.y?(a.push(q.x),a.push("-"),a.push(q.y)):a.push(q.x)}return a.join("")};x.toString=function(){var e=[],c=[];this.type===E.Query.TYPE_ATOM?
(this.elements&&0!==this.elements.v.length?(this.elements.not&&e.push("!"),e.push("["),e.push(this.elements.v.join(",")),e.push("]")):e.push("[a]"),this.chirality&&c.push((this.chirality.not?"!":"")+"@="+this.chirality.v),this.aromatic&&c.push((this.aromatic.not?"!":"")+"A"),this.charge&&c.push((this.charge.not?"!":"")+"C="+this.outputRange(this.charge.v)),this.hydrogens&&c.push((this.hydrogens.not?"!":"")+"H="+this.outputRange(this.hydrogens.v)),this.ringCount&&c.push((this.ringCount.not?"!":"")+
"R="+this.outputRange(this.ringCount.v)),this.saturation&&c.push((this.saturation.not?"!":"")+"S"),this.connectivity&&c.push((this.connectivity.not?"!":"")+"X="+this.outputRange(this.connectivity.v)),this.connectivityNoH&&c.push((this.connectivityNoH.not?"!":"")+"x="+this.outputRange(this.connectivityNoH.v))):this.type===E.Query.TYPE_BOND&&(this.orders&&0!==this.orders.v.length?(this.orders.not&&e.push("!"),e.push("["),e.push(this.orders.v.join(",")),e.push("]")):e.push("[a]"),this.stereo&&c.push((this.stereo.not?
"!":"")+"@="+this.stereo.v),this.aromatic&&c.push((this.aromatic.not?"!":"")+"A"),this.ringCount&&c.push((this.ringCount.not?"!":"")+"R="+this.outputRange(this.ringCount.v)));0<c.length&&(e.push("("),e.push(c.join(",")),e.push(")"));return e.join("")}})(ChemDoodle.extensions,ChemDoodle.structures,Math);
(function(n,E,x,v,k,p,d){var e=/\s+/g;v.Atom=function(a,f,m,q){this.label=a?a.trim():"C";this.x=f?f:0;this.y=m?m:0;this.z=q?q:0;this.enhancedStereo={type:v.Atom.ESTEREO_ABSOLUTE,group:1}};v.Atom.ESTEREO_ABSOLUTE="abs";v.Atom.ESTEREO_OR="or";v.Atom.ESTEREO_AND="&";var c=v.Atom.prototype=new v.Point(0,0);c.charge=0;c.numLonePair=0;c.numRadical=0;c.mass=-1;c.implicitH=-1;c.coordinationNumber=0;c.bondNumber=0;c.angleOfLeastInterference=0;c.isHidden=!1;c.altLabel=d;c.isLone=!1;c.isHover=!1;c.isSelected=
!1;c.add3D=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z};c.sub3D=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z};c.distance3D=function(a){var f=a.x-this.x,m=a.y-this.y;a=a.z-this.z;return k.sqrt(f*f+m*m+a*a)};c.draw=function(a,f){if(!this.dontDraw){if(this.isLassoed){var m=a.createRadialGradient(this.x-1,this.y-1,0,this.x,this.y,7);m.addColorStop(0,"rgba(212, 99, 0, 0)");m.addColorStop(.7,"rgba(212, 99, 0, 0.8)");a.fillStyle=m;a.beginPath();a.arc(this.x,this.y,5,0,2*k.PI,!1);a.fill()}if(!this.query){this.textBounds=
[];this.styles&&(f=this.styles);var q=E.getFontString(f.atoms_font_size_2D,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D);a.font=q;a.fillStyle=this.getElementColor(f.atoms_useJMOLColors,f.atoms_usePYMOLColors,f.atoms_color,2);"H"===this.label&&f.atoms_HBlack_2D&&(a.fillStyle="black");this.error&&(a.fillStyle=f.colorError);m=this.isLabelVisible(f);if(this.isLone&&!m||f.atoms_circles_2D)this.isLone&&(a.fillStyle="#909090"),a.beginPath(),a.arc(this.x,this.y,f.atoms_circleDiameter_2D/
2,0,2*k.PI,!1),a.fill(),0<f.atoms_circleBorderWidth_2D&&(a.lineWidth=f.atoms_circleBorderWidth_2D,a.strokeStyle="black",a.stroke());else if(m)if(a.textAlign="center",a.textBaseline="middle",this.altLabel!==d){a.fillText(this.altLabel,this.x,this.y);var l=a.measureText(this.altLabel).width;this.textBounds.push({x:this.x-l/2,y:this.y-f.atoms_font_size_2D/2+1,w:l,h:f.atoms_font_size_2D-2})}else if(n[this.label]){a.fillText(this.label,this.x,this.y);var r=a.measureText(this.label).width;this.textBounds.push({x:this.x-
r/2,y:this.y-f.atoms_font_size_2D/2+1,w:r,h:f.atoms_font_size_2D-2});var y=0;-1!==this.mass&&(l=a.font,a.font=E.getFontString(.7*f.atoms_font_size_2D,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D),y=a.measureText(this.mass).width,a.textAlign="right",a.fillText(this.mass,this.x-r/2-1,this.y-f.atoms_font_size_2D/2+1),this.textBounds.push({x:this.x-r/2-y-.5,y:this.y-1.7*f.atoms_font_size_2D/2+1,w:y,h:f.atoms_font_size_2D/2-1}),a.font=l,a.textAlign="center");l=r/2;var w=this.getImplicitHydrogenCount();
if(f.atoms_implicitHydrogens_2D&&0<w){var A=0;var G=a.measureText("H").width,b=!0;if(1<w){var g=r/2+G/2,t=0,B=E.getFontString(.8*f.atoms_font_size_2D,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D);a.font=B;var F=a.measureText(w).width;1===this.bondNumber?this.angleOfLeastInterference>k.PI/2&&this.angleOfLeastInterference<3*k.PI/2&&(g=-r/2-F-G/2-y/2,b=!1,A=k.PI):this.angleOfLeastInterference<=k.PI/4||(this.angleOfLeastInterference<3*k.PI/4?(g=0,t=.9*-f.atoms_font_size_2D,0!==
this.charge&&(t-=.3*f.atoms_font_size_2D),b=!1,A=k.PI/2):this.angleOfLeastInterference<=5*k.PI/4?(g=-r/2-F-G/2-y/2,b=!1,A=k.PI):this.angleOfLeastInterference<7*k.PI/4&&(g=0,t=.9*f.atoms_font_size_2D,b=!1,A=3*k.PI/2));a.font=q;a.fillText("H",this.x+g,this.y+t);a.font=B;a.fillText(w,this.x+g+G/2+F/2,this.y+t+.3*f.atoms_font_size_2D);this.textBounds.push({x:this.x+g-G/2,y:this.y+t-f.atoms_font_size_2D/2+1,w:G,h:f.atoms_font_size_2D-2});this.textBounds.push({x:this.x+g+G/2,y:this.y+t+.3*f.atoms_font_size_2D-
f.atoms_font_size_2D/2+1,w:F,h:.8*f.atoms_font_size_2D-2})}else q=r/2+G/2,w=0,1===this.bondNumber?this.angleOfLeastInterference>k.PI/2&&this.angleOfLeastInterference<3*k.PI/2&&(q=-r/2-G/2-y/2,b=!1,A=k.PI):this.angleOfLeastInterference<=k.PI/4||(this.angleOfLeastInterference<3*k.PI/4?(q=0,w=.9*-f.atoms_font_size_2D,b=!1,A=k.PI/2):this.angleOfLeastInterference<=5*k.PI/4?(q=-r/2-G/2-y/2,b=!1,A=k.PI):this.angleOfLeastInterference<7*k.PI/4&&(q=0,w=.9*f.atoms_font_size_2D,b=!1,A=3*k.PI/2)),a.fillText("H",
this.x+q,this.y+w),this.textBounds.push({x:this.x+q-G/2,y:this.y+w-f.atoms_font_size_2D/2+1,w:G,h:f.atoms_font_size_2D-2});b&&(l+=G)}0!==this.charge&&(r=this.charge.toFixed(0),r="1"===r?"+":"-1"===r?"\u2013":r.startsWith("-")?r.substring(1)+"\u2013":r+"+",y=a.measureText(r).width,l+=y/2,a.textAlign="center",a.textBaseline="middle",a.font=E.getFontString(k.floor(.8*f.atoms_font_size_2D),f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D),a.fillText(r,this.x+l-1,this.y-f.atoms_font_size_2D/
2+1),this.textBounds.push({x:this.x+l-y/2-1,y:this.y-1.8*f.atoms_font_size_2D/2+5,w:y,h:f.atoms_font_size_2D/2-1}))}else v.CondensedLabel?this.label.match(e)?(a.textAlign="left",this.error&&(a.fillStyle=f.colorError),a.fillText(this.label,this.x,this.y),l=a.measureText(this.label).width,this.textBounds.push({x:this.x+1,y:this.y-f.atoms_font_size_2D/2+1,w:l,h:f.atoms_font_size_2D-2})):(this.condensed&&this.condensed.text===this.label||(this.condensed=new v.CondensedLabel(this,this.label)),this.condensed.draw(a,
f)):(a.fillText(this.label,this.x,this.y),l=a.measureText(this.label).width,this.textBounds.push({x:this.x-l/2,y:this.y-f.atoms_font_size_2D/2+1,w:l,h:f.atoms_font_size_2D-2}));l=[];for(r=0;r<this.numLonePair;r++)l.push({t:2});for(r=0;r<this.numRadical;r++)l.push({t:1});this.enhancedStereo.type!==v.Atom.ESTEREO_ABSOLUTE&&l.push(this.enhancedStereo);if(0<l.length)if(a.fillStyle="black",a.font=E.getFontString(.8*f.atoms_font_size_2D,f.atoms_font_families_2D,f.atoms_font_bold_2D,f.atoms_font_italic_2D),
a.textAlign="center",a.textBaseline="middle",G=this.angles.slice(0),r=this.angleOfLeastInterference,y=this.largestAngle,A!==d&&(G.push(A),G.sort(function(I,L){return I-L}),y=x.angleBetweenLargest(G),r=y.angle%(2*k.PI),y=y.largest),A===d&&k.abs(y-2*k.PI/G.length)<k.PI/60)for(G=k.ceil(l.length/G.length),b=0,q=l.length;b<q;b+=G,r+=y)this.drawAttribute(a,f,l.slice(b,k.min(l.length,b+G)),r,y,A,m);else this.drawAttribute(a,f,l,r,y,A,m)}}};c.drawAttribute=function(a,f,m,q,l,r,y){r=l/(m.length+(0===this.bonds.length&&
r===d?0:1));q=q-l/2+r;for(l=0;l<m.length;l++){var w=m[l],A=q+l*r,G=f.atoms_lonePairDistance_2D;y&&w.type!==d&&(G+=4);var b=this.x+Math.cos(A)*G;G=this.y-Math.sin(A)*G;w.type!==d?a.fillText(w.type+w.group,b,G):2===w.t?(A+=Math.PI/2,w=Math.cos(A)*f.atoms_lonePairSpread_2D/2,A=-Math.sin(A)*f.atoms_lonePairSpread_2D/2,a.beginPath(),a.arc(b+w,G+A,f.atoms_lonePairDiameter_2D,0,2*k.PI,!1),a.fill(),a.beginPath(),a.arc(b-w,G-A,f.atoms_lonePairDiameter_2D,0,2*k.PI,!1),a.fill()):1===w.t&&(a.beginPath(),a.arc(b,
G,f.atoms_lonePairDiameter_2D,0,2*k.PI,!1),a.fill())}};c.drawDecorations=function(a,f){if(this.isHover||this.isSelected)a.strokeStyle=this.isHover?f.colorHover:f.colorSelect,a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,this.isHover?7:15,0,2*k.PI,!1),a.stroke();this.isOverlap&&(a.strokeStyle=f.colorError,a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,7,0,2*k.PI,!1),a.stroke())};c.render=function(a,f,m){this.styles&&(f=this.styles);var q=p.translate(p.identity(),[this.x,this.y,this.z]),l=f.atoms_useVDWDiameters_3D?
n[this.label].vdWRadius*f.atoms_vdwMultiplier_3D:f.atoms_sphereDiameter_3D/2;0===l&&(l=1);p.scale(q,[l,l,l]);m||(m=f.atoms_color,f.atoms_useJMOLColors?m=n[this.label].jmolColor:f.atoms_usePYMOLColors&&(m=n[this.label].pymolColor),a.material.setDiffuseColor(a,m));a.shader.setMatrixUniforms(a,q);a.drawElements(a.TRIANGLES,(this.renderAsStar?a.starBuffer:a.sphereBuffer).vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)};c.renderHighlight=function(a,f){if(this.isSelected||this.isHover){this.styles&&(f=this.styles);
var m=p.translate(p.identity(),[this.x,this.y,this.z]),q=f.atoms_useVDWDiameters_3D?n[this.label].vdWRadius*f.atoms_vdwMultiplier_3D:f.atoms_sphereDiameter_3D/2;0===q&&(q=1);q*=1.3;p.scale(m,[q,q,q]);a.shader.setMatrixUniforms(a,m);a.material.setDiffuseColor(a,this.isHover?f.colorHover:f.colorSelect);a.drawElements(a.TRIANGLES,(this.renderAsStar?a.starBuffer:a.sphereBuffer).vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}};c.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||"C"!==
this.label||this.altLabel||!n[this.label]||-1!==this.mass||-1!==this.implicitH||0!==this.charge||a.atoms_showAttributedCarbons_2D&&(0!==this.numRadical||0!==this.numLonePair)||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&1===this.bondNumber?!0:!1};c.getImplicitHydrogenCount=function(){if(!n[this.label])return 0;if(-1!==this.implicitH)return this.implicitH;if(!n[this.label].addH||"H"===this.label)return 0;var a=n[this.label].valency,f=a-this.coordinationNumber;
0<this.numRadical&&(f=k.max(0,f-this.numRadical));0<this.charge?(a=4-a,f=this.charge<=a?f+this.charge:4-this.coordinationNumber-this.charge+a):f+=this.charge;return 0>f?0:k.floor(f)};c.getBounds=function(){var a=new x.Bounds;a.expand(this.x,this.y);if(this.textBounds)for(var f=0,m=this.textBounds.length;f<m;f++){var q=this.textBounds[f];a.expand(q.x,q.y,q.x+q.w,q.y+q.h)}return a};c.getBounds3D=function(){var a=new x.Bounds;a.expand3D(this.x,this.y,this.z);return a};c.getElementColor=function(a,f,
m){if(!n[this.label])return"#000";a?m=n[this.label].jmolColor:f&&(m=n[this.label].pymolColor);return m}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,Math,ChemDoodle.lib.mat4);
(function(n,E,x,v,k,p,d,e){x.Bond=function(c,a,f){this.a1=c;this.a2=a;this.bondOrder=f!==e?f:1};x.Bond.STEREO_NONE="none";x.Bond.STEREO_PROTRUDING="protruding";x.Bond.STEREO_RECESSED="recessed";x.Bond.STEREO_AMBIGUOUS="ambiguous";n=x.Bond.prototype;n.stereo=x.Bond.STEREO_NONE;n.isHover=!1;n.ring=e;n.getCenter=function(){return new x.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};n.getLength=function(){return this.a1.distance(this.a2)};n.getLength3D=function(){return this.a1.distance3D(this.a2)};
n.contains=function(c){return c===this.a1||c===this.a2};n.getNeighbor=function(c){return c===this.a1?this.a2:c===this.a2?this.a1:e};n.draw=function(c,a){if(this.a1.x!==this.a2.x||this.a1.y!==this.a2.y){this.styles&&(a=this.styles);var f=this.a1.x,m=this.a2.x,q=this.a1.y,l=this.a2.y,r=this.a1.distance(this.a2),y=m-f,w=l-q;if(this.a1.isLassoed&&this.a2.isLassoed){var A=c.createLinearGradient(f,q,m,l);A.addColorStop(0,"rgba(212, 99, 0, 0)");A.addColorStop(.5,"rgba(212, 99, 0, 0.8)");A.addColorStop(1,
"rgba(212, 99, 0, 0)");var G=this.a1.angle(this.a2)+k.PI/2,b=k.cos(G),g=k.sin(G),t=f-2.5*b,B=q+2.5*g,F=f+2.5*b,I=q-2.5*g,L=m+2.5*b,O=l-2.5*g,S=m-2.5*b,W=l+2.5*g;c.fillStyle=A;c.beginPath();c.moveTo(t,B);c.lineTo(F,I);c.lineTo(L,O);c.lineTo(S,W);c.closePath();c.fill()}if(a.atoms_display&&!a.atoms_circles_2D&&this.a1.isLabelVisible(a)&&this.a1.textBounds){for(var V=0,Z=0,ba=this.a1.textBounds.length;Z<ba;Z++)V=Math.max(V,v.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[Z]));V+=a.bonds_atomLabelBuffer_2D;
var X=V/r;f+=y*X;q+=w*X}if(a.atoms_display&&!a.atoms_circles_2D&&this.a2.isLabelVisible(a)&&this.a2.textBounds){for(var ea=0,Y=0,aa=this.a2.textBounds.length;Y<aa;Y++)ea=Math.max(ea,v.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[Y]));ea+=a.bonds_atomLabelBuffer_2D;var da=ea/r;m-=y*da;l-=w*da}if(a.bonds_clearOverlaps_2D){var ia=f+.15*y,ja=q+.15*w,la=m-.15*y,ra=l-.15*w;c.strokeStyle=a.backgroundColor;c.lineWidth=a.bonds_width_2D+2*a.bonds_overlapClearWidth_2D;c.lineCap="round";c.beginPath();
c.moveTo(ia,ja);c.lineTo(la,ra);c.closePath();c.stroke()}c.strokeStyle=this.error?a.colorError:a.bonds_color;c.fillStyle=this.error?a.colorError:a.bonds_color;c.lineWidth=a.bonds_width_2D;c.lineCap=a.bonds_ends_2D;if(a.bonds_splitColor){var za=c.createLinearGradient(f,q,m,l),Ba=this.a1.styles?this.a1.styles:a,Ra=this.a2.styles?this.a2.styles:a,Sa=this.a1.getElementColor(Ba.atoms_useJMOLColors,Ba.atoms_usePYMOLColors,Ba.atoms_color,2),Ta=this.a2.getElementColor(Ra.atoms_useJMOLColors,Ra.atoms_usePYMOLColors,
Ra.atoms_color,2);za.addColorStop(0,Sa);a.bonds_colorGradient||(za.addColorStop(.5,Sa),za.addColorStop(.51,Ta));za.addColorStop(1,Ta);c.strokeStyle=za;c.fillStyle=za}if(a.bonds_lewisStyle_2D&&0===this.bondOrder%1)this.drawLewisStyle(c,a,f,q,m,l);else switch(this.query?1:this.bondOrder){case 0:if(this.stereo===x.Bond.STEREO_PROTRUDING){var Qa=a.bonds_wedgeThickness_2D/2,Va=this.a1.angle(this.a2),oa=Va+k.PI/2,mb=2*a.shapes_arrowLength_2D/k.sqrt(3),rc=k.cos(Va),bc=k.sin(Va),Gb=k.cos(oa),Kb=k.sin(oa),
cc=m-rc*mb*.8,wb=l+bc*mb*.8,Ia=cc+Gb*Qa,C=wb-Kb*Qa,Sc=cc-Gb*Qa,Tc=wb+Kb*Qa;c.beginPath();c.moveTo(m,l);c.lineTo(Ia,C);c.lineTo(Sc,Tc);c.closePath();c.fill();c.stroke();c.beginPath();c.moveTo(f,q);c.lineTo(cc,wb);c.stroke()}else{var vc=m-f,wc=l-q,Ab=k.sqrt(vc*vc+wc*wc),kb=k.floor(Ab/a.bonds_dotSize_2D),Ob=(Ab-(kb-1)*a.bonds_dotSize_2D)/2;1===kb%2?Ob+=a.bonds_dotSize_2D/4:(Ob-=a.bonds_dotSize_2D/4,kb+=2);kb/=2;var Pb=this.a1.angle(this.a2),ec=f+Ob*Math.cos(Pb),pc=q-Ob*Math.sin(Pb);c.beginPath();for(var Cc=
0;Cc<kb;Cc++)c.arc(ec,pc,a.bonds_dotSize_2D/2,0,2*k.PI,!1),ec+=2*a.bonds_dotSize_2D*Math.cos(Pb),pc-=2*a.bonds_dotSize_2D*Math.sin(Pb);c.fill();break}case .5:c.beginPath();c.moveTo(f,q);c.lineTo(m,l);c.setLineDash([a.bonds_hashSpacing_2D,a.bonds_hashSpacing_2D]);c.stroke();c.setLineDash([]);break;case 1:if(this.query||this.stereo!==x.Bond.STEREO_PROTRUDING&&this.stereo!==x.Bond.STEREO_RECESSED)if(this.query||this.stereo!==x.Bond.STEREO_AMBIGUOUS)c.beginPath(),c.moveTo(f,q),c.lineTo(m,l),c.stroke(),
this.query&&this.query.draw(c,a,this.getCenter());else{var fc=m-f,gc=l-q;c.beginPath();c.moveTo(f,q);for(var hc=k.floor(k.sqrt(fc*fc+gc*gc)/a.bonds_wavyLength_2D),fb=f,Db=q,lb=this.a1.angle(this.a2)+k.PI/2,Qb=k.cos(lb),wa=k.sin(lb),Oa=fc/hc,qc=gc/hc,Zb,ic,vb=0;vb<hc;vb++){fb+=Oa;Db+=qc;var qb=0===vb%2?1:-1;Zb=a.bonds_wavyLength_2D*Qb*qb+fb-.5*Oa;ic=a.bonds_wavyLength_2D*-wa*qb+Db-.5*qc;c.quadraticCurveTo(Zb,ic,fb,Db)}c.stroke()}else{var rb=a.bonds_width_2D/2,Eb=a.bonds_wedgeThickness_2D/2,$b=this.a1.angle(this.a2)+
k.PI/2,Hb=k.cos($b),ab=k.sin($b),Pc=f-Hb*rb,Xc=q+ab*rb,Yc=f+Hb*rb,Dc=q-ab*rb,Zc=m+Hb*Eb,$c=l-ab*Eb,Rc=m-Hb*Eb,Qc=l+ab*Eb;c.beginPath();c.moveTo(Pc,Xc);c.lineTo(Yc,Dc);c.lineTo(Zc,$c);c.lineTo(Rc,Qc);c.closePath();this.stereo===x.Bond.STEREO_PROTRUDING?c.fill():(c.save(),c.clip(),c.lineWidth=2*Eb,c.lineCap="butt",c.beginPath(),c.moveTo(f,q),c.lineTo(m+5*(m-f),l+5*(l-q)),c.setLineDash([a.bonds_hashWidth_2D,a.bonds_hashSpacing_2D]),c.stroke(),c.setLineDash([]),c.restore())}break;case 1.5:case 2:var Ib=
this.a1.angle(this.a2),Jb=Ib+k.PI/2,gb=k.cos(Jb),hb=k.sin(Jb),Vb=this.a1.distance(this.a2),Ga=a.bonds_useAbsoluteSaturationWidths_2D?a.bonds_saturationWidthAbs_2D/2:Vb*a.bonds_saturationWidth_2D/2;if(this.stereo===x.Bond.STEREO_AMBIGUOUS){var jc=f-gb*Ga,Rb=q+hb*Ga,ad=f+gb*Ga,bd=q-hb*Ga,Ec=m+gb*Ga,tc=l-hb*Ga,sc=m-gb*Ga,Bb=l+hb*Ga;c.beginPath();c.moveTo(jc,Rb);c.lineTo(Ec,tc);c.moveTo(ad,bd);c.lineTo(sc,Bb);c.stroke()}else if(!a.bonds_symmetrical_2D&&(this.ring||"C"===this.a1.label&&"C"===this.a2.label)){c.beginPath();
c.moveTo(f,q);c.lineTo(m,l);c.stroke();var pb=0;Ga*=2;var Fc=a.bonds_saturationAngle_2D;Fc<k.PI/2&&(pb=-(Ga/k.tan(Fc)));if(k.abs(pb)<Vb/2){var Gc=f-k.cos(Ib)*pb,Fb=m+k.cos(Ib)*pb,Hc=q+k.sin(Ib)*pb,Ic=l-k.sin(Ib)*pb,cd=Gc-gb*Ga,kc=Hc+hb*Ga,dd=Gc+gb*Ga,ed=Hc-hb*Ga,Jc=Fb-gb*Ga,Sb=Ic+hb*Ga,lc=Fb+gb*Ga,mc=Ic-hb*Ga,fd=!this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>k.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<
-k.PI;c.beginPath();fd?(c.moveTo(cd,kc),c.lineTo(Jc,Sb)):(c.moveTo(dd,ed),c.lineTo(lc,mc));2!==this.bondOrder&&c.setLineDash([a.bonds_hashSpacing_2D,a.bonds_hashSpacing_2D]);c.stroke();c.setLineDash([])}}else{var Kc=f-gb*Ga,gd=q+hb*Ga,hd=f+gb*Ga,id=q-hb*Ga,Lc=m+gb*Ga,ac=l-hb*Ga,Mc=m-gb*Ga,nc=l+hb*Ga;c.beginPath();c.moveTo(Kc,gd);c.lineTo(Mc,nc);c.stroke();c.beginPath();c.moveTo(hd,id);c.lineTo(Lc,ac);2!==this.bondOrder&&c.setLineDash([a.bonds_hashWidth_2D,a.bonds_hashSpacing_2D]);c.stroke();c.setLineDash([])}break;
case 3:var ub=a.bonds_useAbsoluteSaturationWidths_2D?a.bonds_saturationWidthAbs_2D:this.a1.distance(this.a2)*a.bonds_saturationWidth_2D,uc=this.a1.angle(this.a2)+k.PI/2,Tb=k.cos(uc),Yb=k.sin(uc),jd=f-Tb*ub,kd=q+Yb*ub,Ub=f+Tb*ub,Nc=q-Yb*ub,oc=m+Tb*ub,Oc=l-Yb*ub,ld=m-Tb*ub,md=l+Yb*ub;c.beginPath();c.moveTo(jd,kd);c.lineTo(ld,md);c.moveTo(Ub,Nc);c.lineTo(oc,Oc);c.moveTo(f,q);c.lineTo(m,l);c.stroke()}}};n.drawDecorations=function(c,a){if(this.isHover||this.isSelected){var f=2*k.PI,m=(this.a1.angleForStupidCanvasArcs(this.a2)+
k.PI/2)%f;c.strokeStyle=this.isHover?a.colorHover:a.colorSelect;c.lineWidth=1.2;c.beginPath();a=(m+k.PI)%f;a%=2*k.PI;c.arc(this.a1.x,this.a1.y,7,m,a,!1);c.stroke();c.beginPath();m+=k.PI;a=(m+k.PI)%f;c.arc(this.a2.x,this.a2.y,7,m,a,!1);c.stroke()}};n.drawLewisStyle=function(c,a,f,m,q,l){var r=this.a1.angle(this.a2),y=r+k.PI/2;q-=f;l-=m;q=k.sqrt(q*q+l*l)/(this.bondOrder+1);l=q*k.cos(r);r=-q*k.sin(r);f+=l;m+=r;for(q=0;q<this.bondOrder;q++){var w=a.atoms_lonePairSpread_2D/2,A=f-k.cos(y)*w,G=m+k.sin(y)*
w,b=f+k.cos(y)*w;w=m-k.sin(y)*w;c.beginPath();c.arc(A-a.atoms_lonePairDiameter_2D/2,G-a.atoms_lonePairDiameter_2D/2,a.atoms_lonePairDiameter_2D,0,2*k.PI,!1);c.fill();c.beginPath();c.arc(b-a.atoms_lonePairDiameter_2D/2,w-a.atoms_lonePairDiameter_2D/2,a.atoms_lonePairDiameter_2D,0,2*k.PI,!1);c.fill();f+=l;m+=r}};n.render=function(c,a,f){this.styles&&(a=this.styles);var m=this.a1.distance3D(this.a2);if(0!==m){var q=a.bonds_cylinderDiameter_3D/2,l=a.bonds_color,r=p.translate(p.identity(),[this.a1.x,this.a1.y,
this.a1.z]),y,w=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],A=[0,1,0],G=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(A=[0,0,1],this.a2.y<this.a1.y&&(G=k.PI)):(G=E.vec3AngleFrom(A,w),A=d.cross(A,w,[]));if(a.bonds_splitColor){l=this.a1.styles?this.a1.styles:a;var b=this.a2.styles?this.a2.styles:a;l=this.a1.getElementColor(l.atoms_useJMOLColors,l.atoms_usePYMOLColors,l.atoms_color);b=this.a2.getElementColor(b.atoms_useJMOLColors,b.atoms_usePYMOLColors,b.atoms_color);l!=b&&(y=p.translate(p.identity(),
[this.a2.x,this.a2.y,this.a2.z]))}var g=[0];if(f){if(a.bonds_showBondOrders_3D&&1<this.bondOrder){g=[a.bonds_cylinderDiameter_3D];var t=[0,0,1];q=p.inverse(c.rotationMatrix,[]);p.multiplyVec3(q,t);t=d.cross(w,t,[]);d.normalize(t)}w=1;var B=a.bonds_pillSpacing_3D;q=a.bonds_pillHeight_3D;0==this.bondOrder&&(a.bonds_renderAsLines_3D?q=B:(q=a.bonds_pillDiameter_3D,q<a.bonds_cylinderDiameter_3D&&(q/=2),w=q/2,m/=w,B/=w/2));f=q+B;var F=k.floor(m/f);m=(B+a.bonds_pillDiameter_3D+(m-f*F))/2;B=F;y&&(B=k.floor(F/
2));for(var I=0,L=g.length;I<L;I++){var O=p.set(r,[]);0!==g[I]&&p.translate(O,d.scale(t,g[I],[]));0!==G&&p.rotate(O,G,A);1!=w&&p.scale(O,[w,w,w]);l&&c.material.setDiffuseColor(c,l);p.translate(O,[0,m,0]);for(var S=0;S<B;S++)a.bonds_renderAsLines_3D?0==this.bondOrder?(c.shader.setMatrixUniforms(c,O),c.drawArrays(c.POINTS,0,1)):(p.scale(O,[1,q,1]),c.shader.setMatrixUniforms(c,O),c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems),p.scale(O,[1,1/q,1])):(c.shader.setMatrixUniforms(c,O),
0==this.bondOrder?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)),p.translate(O,[0,f,0]);if(y){if(a.bonds_renderAsLines_3D){S=q;S/=2;var W=0}else S=2/3,W=(1-S)/2;0!=F%2&&(p.scale(O,[1,S,1]),c.shader.setMatrixUniforms(c,O),a.bonds_renderAsLines_3D?0==this.bondOrder?c.drawArrays(c.POINTS,0,1):c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?
c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0),p.translate(O,[0,f*(1+W),0]),p.scale(O,[1,1/S,1]));p.set(y,O);0!==g[I]&&p.translate(O,d.scale(t,g[I],[]));p.rotate(O,G+k.PI,A);1!=w&&p.scale(O,[w,w,w]);b&&c.material.setDiffuseColor(c,b);p.translate(O,[0,m,0]);for(var V=0;V<B;V++)a.bonds_renderAsLines_3D?0==this.bondOrder?(c.shader.setMatrixUniforms(c,O),c.drawArrays(c.POINTS,
0,1)):(p.scale(O,[1,q,1]),c.shader.setMatrixUniforms(c,O),c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems),p.scale(O,[1,1/q,1])):(c.shader.setMatrixUniforms(c,O),0==this.bondOrder?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)),p.translate(O,[0,f,0]);0!=F%2&&(p.scale(O,[1,S,1]),c.shader.setMatrixUniforms(c,O),a.bonds_renderAsLines_3D?0==this.bondOrder?
c.drawArrays(c.POINTS,0,1):c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):0==this.bondOrder?c.drawElements(c.TRIANGLES,c.sphereBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0):c.drawElements(c.TRIANGLES,c.pillBuffer.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0),p.translate(O,[0,f*(1+W),0]),p.scale(O,[1,1/S,1]))}}}else{if(a.bonds_showBondOrders_3D){switch(this.bondOrder){case 1.5:g=[-a.bonds_cylinderDiameter_3D];break;case 2:g=[-a.bonds_cylinderDiameter_3D,a.bonds_cylinderDiameter_3D];
break;case 3:g=[-1.2*a.bonds_cylinderDiameter_3D,0,1.2*a.bonds_cylinderDiameter_3D]}1<this.bondOrder&&(t=[0,0,1],f=p.inverse(c.rotationMatrix,[]),p.multiplyVec3(f,t),t=d.cross(w,t,[]),d.normalize(t))}else switch(this.bondOrder){case 0:q*=.25;break;case .5:case 1.5:q*=.5}y&&(m/=2);m=[q,m,q];w=0;for(q=g.length;w<q;w++)f=p.set(r,[]),0!==g[w]&&p.translate(f,d.scale(t,g[w],[])),0!==G&&p.rotate(f,G,A),p.scale(f,m),l&&c.material.setDiffuseColor(c,l),c.shader.setMatrixUniforms(c,f),a.bonds_renderAsLines_3D?
c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems),y&&(p.set(y,f),0!==g[w]&&p.translate(f,d.scale(t,g[w],[])),p.rotate(f,G+k.PI,A),p.scale(f,m),b&&c.material.setDiffuseColor(c,b),c.shader.setMatrixUniforms(c,f),a.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems))}}};n.renderHighlight=
function(c,a){if(this.isSelected||this.isHover){this.styles&&(a=this.styles);this.styles&&(a=this.styles);var f=this.a1.distance3D(this.a2);if(0!==f){var m=a.bonds_cylinderDiameter_3D/1.2,q=p.translate(p.identity(),[this.a1.x,this.a1.y,this.a1.z]),l=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=[0,1,0],y=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?(l=[0,0,1],this.a2.y<this.a1.y&&(y=k.PI)):(y=E.vec3AngleFrom(r,l),l=d.cross(r,l,[]));f=[m,f,m];0!==y&&p.rotate(q,y,l);p.scale(q,f);
c.shader.setMatrixUniforms(c,q);c.material.setDiffuseColor(c,this.isHover?a.colorHover:a.colorSelect);c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems)}}};n.renderPicker=function(c,a){this.styles&&(a=this.styles);var f=this.a1.distance3D(this.a2);if(0!==f){var m=a.bonds_cylinderDiameter_3D/2,q=p.translate(p.identity(),[this.a1.x,this.a1.y,this.a1.z]),l=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],r=[0,1,0],y=0;this.a1.x===this.a2.x&&this.a1.z===this.a2.z?
(r=[0,0,1],this.a2.y<this.a1.y&&(y=k.PI)):(y=E.vec3AngleFrom(r,l),r=d.cross(r,l,[]));var w=[0];if(a.bonds_showBondOrders_3D)if(a.bonds_renderAsLines_3D){switch(this.bondOrder){case 1.5:case 2:w=[-a.bonds_cylinderDiameter_3D,a.bonds_cylinderDiameter_3D];break;case 3:w=[-1.2*a.bonds_cylinderDiameter_3D,0,1.2*a.bonds_cylinderDiameter_3D]}if(1<this.bondOrder){var A=[0,0,1];var G=p.inverse(c.rotationMatrix,[]);p.multiplyVec3(G,A);A=d.cross(l,A,[]);d.normalize(A)}}else switch(this.bondOrder){case 1.5:case 2:m*=
3;break;case 3:m*=3.4}else switch(this.bondOrder){case 0:m*=.25;break;case .5:case 1.5:m*=.5}f=[m,f,m];m=0;for(l=w.length;m<l;m++)G=p.set(q,[]),0!==w[m]&&p.translate(G,d.scale(A,w[m],[])),0!==y&&p.rotate(G,y,r),p.scale(G,f),c.shader.setMatrixUniforms(c,G),a.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems)}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,
Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,x){n.Ring=function(){this.atoms=[];this.bonds=[]};var v=n.Ring.prototype;v.center=x;v.setupBonds=function(){for(var k=0,p=this.bonds.length;k<p;k++)this.bonds[k].ring=this;this.center=this.getCenter()};v.getCenter=function(){for(var k=Infinity,p=Infinity,d=-Infinity,e=-Infinity,c=0,a=this.atoms.length;c<a;c++)k=E.min(this.atoms[c].x,k),p=E.min(this.atoms[c].y,p),d=E.max(this.atoms[c].x,d),e=E.max(this.atoms[c].y,e);return new n.Point((d+k)/2,(e+p)/2)}})(ChemDoodle.structures,Math);
(function(n,E,x,v,k,p){x.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[]};var d=x.Molecule.prototype;d.findRings=!0;d.draw=function(e,c){this.styles&&(c=this.styles);if(c.atoms_display&&!c.atoms_circles_2D)for(var a=0,f=this.atoms.length;a<f;a++)this.atoms[a].draw(e,c);if(c.bonds_display)for(a=0,f=this.bonds.length;a<f;a++)this.bonds[a].draw(e,c);if(c.atoms_display)for(a=0,f=this.atoms.length;a<f;a++){var m=this.atoms[a];c.atoms_circles_2D&&m.draw(e,c);m.query&&m.query.draw(e,c,m)}};
d.render=function(e,c){this.styles&&(c=this.styles);var a=0<this.atoms.length&&this.atoms[0].hetatm!==p;if(a){if(c.macro_displayBonds){0<this.bonds.length&&(c.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(e.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(e,c.bonds_materialAmbientColor_3D,p,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));
for(var f=0,m=this.bonds.length;f<m;f++){var q=this.bonds[f];!q.a1.hetatm&&(-1===c.macro_atomToLigandDistance||q.a1.closestDistance!==p&&c.macro_atomToLigandDistance>=q.a1.closestDistance&&c.macro_atomToLigandDistance>=q.a2.closestDistance)&&q.render(e,this.residueSpecs?this.residueSpecs:c)}}if(c.macro_displayAtoms)for(0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(e,c.atoms_materialAmbientColor_3D,p,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D)),f=0,
m=this.atoms.length;f<m;f++)q=this.atoms[f],!q.hetatm&&(-1===c.macro_atomToLigandDistance||q.closestDistance!==p&&c.macro_atomToLigandDistance>=q.closestDistance)&&q.render(e,this.residueSpecs?this.residueSpecs:c)}if(c.bonds_display){m=[];f=[];0<this.bonds.length&&(c.bonds_renderAsLines_3D?(e.lineWidth(c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):e.cylinderBuffer.bindBuffers(e),e.material.setTempColors(e,c.bonds_materialAmbientColor_3D,p,c.bonds_materialSpecularColor_3D,c.bonds_materialShininess_3D));
q=0;for(var l=this.bonds.length;q<l;q++){var r=this.bonds[q];if(!a||r.a1.hetatm)c.bonds_showBondOrders_3D?0==r.bondOrder?f.push(r):.5==r.bondOrder?m.push(r):(1.5==r.bondOrder&&m.push(r),r.render(e,c)):r.render(e,c)}if(0<m.length)for(c.bonds_renderAsLines_3D||e.pillBuffer.bindBuffers(e),q=0,l=m.length;q<l;q++)m[q].render(e,c,!0);if(0<f.length)for(c.bonds_renderAsLines_3D||e.sphereBuffer.bindBuffers(e),m=0,q=f.length;m<q;m++)f[m].render(e,c,!0)}if(c.atoms_display){f=0;for(m=this.atoms.length;f<m;f++)q=
this.atoms[f],q.bondNumber=0,q.renderAsStar=!1;f=0;for(m=this.bonds.length;f<m;f++)q=this.bonds[f],q.a1.bondNumber++,q.a2.bondNumber++;0<this.atoms.length&&(e.sphereBuffer.bindBuffers(e),e.material.setTempColors(e,c.atoms_materialAmbientColor_3D,p,c.atoms_materialSpecularColor_3D,c.atoms_materialShininess_3D));f=[];m=0;for(q=this.atoms.length;m<q;m++)if(l=this.atoms[m],!a||l.hetatm&&(c.macro_showWater||!l.isWater))c.atoms_nonBondedAsStars_3D&&0===l.bondNumber?(l.renderAsStar=!0,f.push(l)):l.render(e,
c);if(0<f.length)for(e.starBuffer.bindBuffers(e),a=0,m=f.length;a<m;a++)f[a].render(e,c)}if(this.chains){e.shader.setMatrixUniforms(e);if(c.proteins_displayRibbon)for(e.material.setTempColors(e,c.proteins_materialAmbientColor_3D,p,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D),a=c.proteins_ribbonCartoonize?this.cartoons:this.ribbons,f=0,m=a.length;f<m;f++)if(q=a[f],"none"!==c.proteins_residueColor){q.front.bindBuffers(e);l="rainbow"===c.proteins_residueColor;r=0;for(var y=q.front.segments.length;r<
y;r++)l&&e.material.setDiffuseColor(e,E.rainbowAt(r,y,c.macro_rainbowColors)),q.front.segments[r].render(e,c);q.back.bindBuffers(e);r=0;for(y=q.back.segments.length;r<y;r++)l&&e.material.setDiffuseColor(e,E.rainbowAt(r,y,c.macro_rainbowColors)),q.back.segments[r].render(e,c)}else q.front.render(e,c),q.back.render(e,c);if(c.proteins_displayPipePlank)for(a=0,f=this.pipePlanks.length;a<f;a++)this.pipePlanks[a].render(e,c);if(c.proteins_displayBackbone){if(!this.alphaCarbonTrace)for(this.alphaCarbonTrace=
{nodes:[],edges:[]},a=0,f=this.chains.length;a<f;a++)if(m=this.chains[a],!(2<m.length&&v[m[2].name]&&"#BEA06E"===v[m[2].name].aminoColor)&&0<m.length)for(q=0,l=m.length-2;q<l;q++)r=m[q].cp1,r.chainColor=m.chainColor,this.alphaCarbonTrace.nodes.push(r),r=new x.Bond(m[q].cp1,m[q+1].cp1),r.residueName=m[q].name,r.chainColor=m.chainColor,this.alphaCarbonTrace.edges.push(r),q===m.length-3&&(r=m[q+1].cp1,r.chainColor=m.chainColor,this.alphaCarbonTrace.nodes.push(r));if(0<this.alphaCarbonTrace.nodes.length){a=
new x.Styles;a.atoms_display=!0;a.bonds_display=!0;a.atoms_sphereDiameter_3D=c.proteins_backboneThickness;a.bonds_cylinderDiameter_3D=c.proteins_backboneThickness;a.bonds_splitColor=!1;a.atoms_color=c.proteins_backboneColor;a.bonds_color=c.proteins_backboneColor;a.atoms_useVDWDiameters_3D=!1;e.material.setTempColors(e,c.proteins_materialAmbientColor_3D,p,c.proteins_materialSpecularColor_3D,c.proteins_materialShininess_3D);e.material.setDiffuseColor(e,c.proteins_backboneColor);f=0;for(m=this.alphaCarbonTrace.nodes.length;f<
m;f++)q=this.alphaCarbonTrace.nodes[f],c.macro_colorByChain&&(a.atoms_color=q.chainColor),e.sphereBuffer.bindBuffers(e),q.render(e,a);f=0;for(m=this.alphaCarbonTrace.edges.length;f<m;f++)q=this.alphaCarbonTrace.edges[f],l=void 0,r=v[q.residueName]?v[q.residueName]:v["*"],c.macro_colorByChain?l=q.chainColor:"shapely"===c.proteins_residueColor?l=r.shapelyColor:"amino"===c.proteins_residueColor?l=r.aminoColor:"polarity"===c.proteins_residueColor?l=r.polar?"#C10000":"#FFFFFF":"acidity"===c.proteins_residueColor?
l=1===r.acidity?"#0000FF":-1===r.acidity?"#FF0000":r.polar?"#FFFFFF":"#773300":"rainbow"===c.proteins_residueColor&&(l=E.rainbowAt(f,m,c.macro_rainbowColors)),l&&(a.bonds_color=l),e.cylinderBuffer.bindBuffers(e),q.render(e,a)}}if(c.nucleics_display)for(e.material.setTempColors(e,c.nucleics_materialAmbientColor_3D,p,c.nucleics_materialSpecularColor_3D,c.nucleics_materialShininess_3D),a=0,f=this.tubes.length;a<f;a++)e.shader.setMatrixUniforms(e),this.tubes[a].render(e,c)}if(c.atoms_display){a=!1;f=
0;for(m=this.atoms.length;f<m;f++)if(q=this.atoms[f],q.isHover||q.isSelected){a=!0;break}if(!a)for(f=0,m=this.bonds.length;f<m;f++)if(q=this.bonds[f],q.isHover||q.isSelected){a=!0;break}if(a){e.sphereBuffer.bindBuffers(e);e.blendFunc(e.SRC_ALPHA,e.ONE);e.material.setTempColors(e,c.atoms_materialAmbientColor_3D,p,"#000000",0);e.enable(e.BLEND);e.depthMask(!1);e.material.setAlpha(e,.4);e.sphereBuffer.bindBuffers(e);a=0;for(f=this.atoms.length;a<f;a++)m=this.atoms[a],(m.isHover||m.isSelected)&&m.renderHighlight(e,
c);e.cylinderBuffer.bindBuffers(e);a=0;for(f=this.bonds.length;a<f;a++)m=this.bonds[a],(m.isHover||m.isSelected)&&m.renderHighlight(e,c);e.depthMask(!0);e.disable(e.BLEND);e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)}}};d.renderPickFrame=function(e,c,a,f,m){this.styles&&(c=this.styles);var q=0<this.atoms.length&&this.atoms[0].hetatm!==p;if(m&&c.bonds_display){0<this.bonds.length&&(c.bonds_renderAsLines_3D?(e.lineWidth(c.bonds_width_2D),e.lineBuffer.bindBuffers(e)):
e.cylinderBuffer.bindBuffers(e));m=0;for(var l=this.bonds.length;m<l;m++){var r=this.bonds[m];if(!q||r.a1.hetatm)e.material.setDiffuseColor(e,E.idx2color(a.length)),r.renderPicker(e,c),a.push(r)}}if(f&&c.atoms_display){f=0;for(m=this.atoms.length;f<m;f++)l=this.atoms[f],l.bondNumber=0,l.renderAsStar=!1;f=0;for(m=this.bonds.length;f<m;f++)l=this.bonds[f],l.a1.bondNumber++,l.a2.bondNumber++;0<this.atoms.length&&e.sphereBuffer.bindBuffers(e);f=[];m=0;for(l=this.atoms.length;m<l;m++)if(r=this.atoms[m],
!q||r.hetatm&&(c.macro_showWater||!r.isWater))c.atoms_nonBondedAsStars_3D&&0===r.bondNumber?(r.renderAsStar=!0,f.push(r)):(e.material.setDiffuseColor(e,E.idx2color(a.length)),r.render(e,c,!0),a.push(r));if(0<f.length)for(e.starBuffer.bindBuffers(e),q=0,m=f.length;q<m;q++)l=f[q],e.material.setDiffuseColor(e,E.idx2color(a.length)),l.render(e,c,!0),a.push(l)}};d.getCenter3D=function(){if(1===this.atoms.length)return new x.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var e=Infinity,c=Infinity,
a=Infinity,f=-Infinity,m=-Infinity,q=-Infinity;if(this.chains)for(var l=0,r=this.chains.length;l<r;l++)for(var y=this.chains[l],w=0,A=y.length;w<A;w++){var G=y[w];e=k.min(G.cp1.x,G.cp2.x,e);c=k.min(G.cp1.y,G.cp2.y,c);a=k.min(G.cp1.z,G.cp2.z,a);f=k.max(G.cp1.x,G.cp2.x,f);m=k.max(G.cp1.y,G.cp2.y,m);q=k.max(G.cp1.z,G.cp2.z,q)}l=0;for(r=this.atoms.length;l<r;l++)e=k.min(this.atoms[l].x,e),c=k.min(this.atoms[l].y,c),a=k.min(this.atoms[l].z,a),f=k.max(this.atoms[l].x,f),m=k.max(this.atoms[l].y,m),q=k.max(this.atoms[l].z,
q);return new x.Atom("C",(f+e)/2,(m+c)/2,(q+a)/2)};d.getCenter=function(){if(1===this.atoms.length)return new x.Point(this.atoms[0].x,this.atoms[0].y);for(var e=Infinity,c=Infinity,a=-Infinity,f=-Infinity,m=0,q=this.atoms.length;m<q;m++)e=k.min(this.atoms[m].x,e),c=k.min(this.atoms[m].y,c),a=k.max(this.atoms[m].x,a),f=k.max(this.atoms[m].y,f);return new x.Point((a+e)/2,(f+c)/2)};d.getDimension=function(){if(1===this.atoms.length)return new x.Point(0,0);var e=Infinity,c=Infinity,a=-Infinity,f=-Infinity;
if(this.chains){for(var m=0,q=this.chains.length;m<q;m++)for(var l=this.chains[m],r=0,y=l.length;r<y;r++){var w=l[r];e=k.min(w.cp1.x,w.cp2.x,e);c=k.min(w.cp1.y,w.cp2.y,c);a=k.max(w.cp1.x,w.cp2.x,a);f=k.max(w.cp1.y,w.cp2.y,f)}e-=30;c-=30;a+=30;f+=30}m=0;for(q=this.atoms.length;m<q;m++)e=k.min(this.atoms[m].x,e),c=k.min(this.atoms[m].y,c),a=k.max(this.atoms[m].x,a),f=k.max(this.atoms[m].y,f);return new x.Point(a-e,f-c)};d.check=function(e){if(e&&this.doChecks){if(this.findRings)if(this.bonds.length-
this.atoms.length!==this.fjNumCache){this.rings=(new n.informatics.SSSRFinder(this)).rings;for(var c=0,a=this.bonds.length;c<a;c++)this.bonds[c].ring=p;c=0;for(a=this.rings.length;c<a;c++)this.rings[c].setupBonds()}else for(c=0,a=this.rings.length;c<a;c++){var f=this.rings[c];f.center=f.getCenter()}c=0;for(a=this.atoms.length;c<a;c++)if(this.atoms[c].isLone=!1,"C"===this.atoms[c].label){for(var m=f=0,q=this.bonds.length;m<q;m++)this.bonds[m].a1!==this.atoms[c]&&this.bonds[m].a2!==this.atoms[c]||f++;
0===f&&(this.atoms[c].isLone=!0)}c=!1;a=0;for(f=this.atoms.length;a<f;a++)0!==this.atoms[a].z&&(c=!0);c&&(this.sortAtomsByZ(),this.sortBondsByZ());this.setupMetaData();this.atomNumCache=this.atoms.length;this.bondNumCache=this.bonds.length;this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!e};d.getAngles=function(e){for(var c=[],a=0,f=this.bonds.length;a<f;a++)this.bonds[a].contains(e)&&c.push(e.angle(this.bonds[a].getNeighbor(e)));c.sort(function(m,q){return m-q});return c};d.getCoordinationNumber=
function(e){for(var c=0,a=0,f=e.length;a<f;a++)c+=e[a].bondOrder;return c};d.getBonds=function(e){for(var c=[],a=0,f=this.bonds.length;a<f;a++)this.bonds[a].contains(e)&&c.push(this.bonds[a]);return c};d.sortAtomsByZ=function(){for(var e=1,c=this.atoms.length;e<c;e++)for(var a=e;0<a&&this.atoms[a].z<this.atoms[a-1].z;){var f=this.atoms[a];this.atoms[a]=this.atoms[a-1];this.atoms[a-1]=f;a--}};d.sortBondsByZ=function(){for(var e=1,c=this.bonds.length;e<c;e++)for(var a=e;0<a&&this.bonds[a].a1.z+this.bonds[a].a2.z<
this.bonds[a-1].a1.z+this.bonds[a-1].a2.z;){var f=this.bonds[a];this.bonds[a]=this.bonds[a-1];this.bonds[a-1]=f;a--}};d.setupMetaData=function(){for(var e=this.getCenter(),c=0,a=this.atoms.length;c<a;c++){var f=this.atoms[c];f.bonds=this.getBonds(f);f.angles=this.getAngles(f);f.isHidden=2===f.bonds.length&&k.abs(k.abs(f.angles[1]-f.angles[0])-k.PI)<k.PI/30&&f.bonds[0].bondOrder===f.bonds[1].bondOrder;var m=E.angleBetweenLargest(f.angles);f.angleOfLeastInterference=m.angle%(2*k.PI);f.largestAngle=
m.largest;f.coordinationNumber=this.getCoordinationNumber(f.bonds);f.bondNumber=f.bonds.length;f.molCenter=e}c=0;for(a=this.bonds.length;c<a;c++)this.bonds[c].molCenter=e};d.scaleToAverageBondLength=function(e){var c=this.getAverageBondLength();if(0!==c){e/=c;c=0;for(var a=this.atoms.length;c<a;c++)this.atoms[c].x*=e,this.atoms[c].y*=e}};d.getAverageBondLength=function(){if(0===this.bonds.length)return 0;for(var e=0,c=0,a=this.bonds.length;c<a;c++)e+=this.bonds[c].getLength();return e/=this.bonds.length};
d.getBounds=function(){for(var e=new E.Bounds,c=0,a=this.atoms.length;c<a;c++)e.expand(this.atoms[c].getBounds());if(this.chains){c=0;for(a=this.chains.length;c<a;c++)for(var f=this.chains[c],m=0,q=f.length;m<q;m++){var l=f[m];e.expand(l.cp1.x,l.cp1.y);e.expand(l.cp2.x,l.cp2.y)}e.minX-=30;e.minY-=30;e.maxX+=30;e.maxY+=30}return e};d.getBounds3D=function(){for(var e=new E.Bounds,c=0,a=this.atoms.length;c<a;c++)e.expand(this.atoms[c].getBounds3D());if(this.chains)for(c=0,a=this.chains.length;c<a;c++)for(var f=
this.chains[c],m=0,q=f.length;m<q;m++){var l=f[m];e.expand3D(l.cp1.x,l.cp1.y,l.cp1.z);e.expand3D(l.cp2.x,l.cp2.y,l.cp2.z)}return e};d.getAtomGroup=function(e){for(var c=!1,a=0,f=this.atoms.length;a<f;a++)this.atoms[a].visited=!1;a=0;for(f=this.bonds.length;a<f;a++){var m=this.bonds[a];!c&&m.contains(e)&&m.ring!==p&&(c=!0)}if(!c)return p;a=[e];e.visited=!0;f=new x.Queue;for(f.enqueue(e);!f.isEmpty();){e=f.dequeue();m=0;for(var q=this.bonds.length;m<q;m++){var l=this.bonds[m];l.contains(e)&&c===(l.ring!==
p)&&(l=l.getNeighbor(e),l.visited||(l.visited=!0,a.push(l),f.enqueue(l)))}}return a};d.getBondGroup=function(e){for(var c=e.ring!==p,a=!1,f=0,m=this.bonds.length;f<m;f++){var q=this.bonds[f];q===e&&(a=!0);q.visited=!1}if(!a)return p;a=[e];e.visited=!0;f=new x.Queue;for(f.enqueue(e);!f.isEmpty();)for(e=f.dequeue(),m=0,q=this.bonds.length;m<q;m++){var l=this.bonds[m];l.visited||l.a1!==e.a1&&l.a2!==e.a1&&l.a1!==e.a2&&l.a2!==e.a2||l.ring!==p!==c||(l.visited=!0,a.push(l),f.enqueue(l))}return a}})(ChemDoodle,
ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math);(function(n,E){n.Reaction=function(){};n.Reaction.prototype.resolve=function(x,v){if(x&&v){var k={reactants:[],products:[]};x=x.getPoints();if(!x)return k.reactants.push.apply(k.reactants,$jscomp.arrayFromIterable(v)),k;for(var p=0,d=v.length;p<d;p++){var e=v[p];e.getCenter().x<x[1].x?k.reactants.push(e):k.products.push(e)}return k}}})(ChemDoodle.structures);
(function(n,E,x,v,k){var p,d=-1;n.Residue=function(e){this.resSeq=e};k=n.Residue.prototype;k.setup=function(e,c){this.horizontalResolution=c;var a=[e.x-this.cp1.x,e.y-this.cp1.y,e.z-this.cp1.z],f=v.cross(a,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=v.cross(f,a,[]);v.normalize(f);v.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];e=[(e.x+this.cp1.x)/2,(e.y+this.cp1.y)/2,(e.z+this.cp1.z)/2];this.helix&&(v.scale(f,1.5),v.add(e,f));this.guidePointsSmall[0]=
new n.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2);for(f=1;f<c;f++)this.guidePointsSmall[f]=new n.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/c,this.guidePointsSmall[0].y+this.D[1]*f/c,this.guidePointsSmall[0].z+this.D[2]*f/c);v.scale(this.D,4);this.guidePointsLarge[0]=new n.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2);for(f=1;f<c;f++)this.guidePointsLarge[f]=new n.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/c,this.guidePointsLarge[0].y+this.D[1]*f/c,this.guidePointsLarge[0].z+
this.D[2]*f/c)};k.getGuidePointSet=function(e){if(0===e)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;if(1===e)return this.guidePointsSmall;if(2===e)return this.guidePointsLarge};k.computeLineSegments=function(e,c,a,f,m){this.setVerticalResolution(m);this.split=a.helix!==this.helix||a.sheet!==this.sheet;this.lineSegments=this.innerCompute(0,e,c,a,!1,m);f&&(this.lineSegmentsCartoon=this.innerCompute(this.helix||this.sheet?2:1,e,c,a,!0,m))};k.innerCompute=function(e,c,a,
f,m,q){var l=[],r=this.getGuidePointSet(e);c=c.getGuidePointSet(e);a=a.getGuidePointSet(e);e=f.getGuidePointSet(e);f=0;for(var y=r.length;f<y;f++){for(var w=x.multiply([c[f].x,c[f].y,c[f].z,1,a[f].x,a[f].y,a[f].z,1,r[f].x,r[f].y,r[f].z,1,e[f].x,e[f].y,e[f].z,1],p,[]),A=[],G=0;G<q;G++){for(var b=3;0<b;b--)for(var g=0;4>g;g++)w[4*b+g]+=w[4*(b-1)+g];A[G]=new n.Atom("",w[12]/w[15],w[13]/w[15],w[14]/w[15])}l[f]=A}if(m&&this.arrow)for(m=0;m<q;m++)for(r=1.5-1.3*m/q,c=E.floor(this.horizontalResolution/2),
a=l[c],e=0,f=l.length;e<f;e++)e!==c&&(y=a[m],w=l[e][m],A=[w.x-y.x,w.y-y.y,w.z-y.z],v.scale(A,r),w.x=y.x+A[0],w.y=y.y+A[1],w.z=y.z+A[2]);return l};k.setVerticalResolution=function(e){if(e!==d){var c=e*e,a=e*e*e;p=x.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[6/a,0,0,0,6/a,2/c,0,0,1/a,1/c,1/e,0,0,0,0,1],[]);d=e}}})(ChemDoodle.structures,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,x,v,k,p){E.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0}};v=E.Spectrum.prototype;v.title=p;v.xUnit=p;v.yUnit=p;v.continuous=!0;v.integrationSensitivity=.01;v.draw=function(d,e,c,a){this.styles&&(e=this.styles);var f=5,m=0,q=0;d.fillStyle=e.text_color;d.textAlign="center";d.textBaseline="alphabetic";d.font=n.getFontString(e.text_font_size,e.text_font_families);this.xUnit&&
(q+=e.text_font_size,d.fillText(this.xUnit,c/2,a-2));this.yUnit&&e.plots_showYAxis&&(m+=e.text_font_size,d.save(),d.translate(e.text_font_size,a/2),d.rotate(-k.PI/2),d.fillText(this.yUnit,0,0),d.restore());this.title&&(f+=e.text_font_size,d.fillText(this.title,c/2,e.text_font_size));d.lineCap="square";q+=5+e.text_font_size;e.plots_showYAxis&&(m+=5+d.measureText("1000").width);e.plots_showGrid&&(d.strokeStyle=e.plots_gridColor,d.lineWidth=e.plots_gridLineWidth,d.strokeRect(m,f,c-m,a-q-f));d.textAlign=
"center";d.textBaseline="top";for(var l=this.maxX-this.minX,r=l/100,y=.001;y<r||25<l/y;)y*=10;l=0;r=e.plots_flipXAxis?c:0;for(var w=k.round(this.minX/y)*y;w<=this.maxX;w+=y/2){var A=this.getTransformedX(w,e,c,m);if(A>m)if(d.strokeStyle="black",d.lineWidth=1,0===l%2){d.beginPath();d.moveTo(A,a-q);d.lineTo(A,a-q+2);d.stroke();for(var G=w.toFixed(5);"0"===G.charAt(G.length-1);)G=G.substring(0,G.length-1);"."===G.charAt(G.length-1)&&(G=G.substring(0,G.length-1));var b=d.measureText(G).width;e.plots_flipXAxis&&
(b*=-1);var g=A-b/2;if(e.plots_flipXAxis?g<r:g>r)d.fillText(G,A,a-q+2),r=A+b/2;e.plots_showGrid&&(d.strokeStyle=e.plots_gridColor,d.lineWidth=e.plots_gridLineWidth,d.beginPath(),d.moveTo(A,a-q),d.lineTo(A,f),d.stroke())}else d.beginPath(),d.moveTo(A,a-q),d.lineTo(A,a-q+2),d.stroke();l++}if(e.plots_showYAxis||e.plots_showGrid)for(y=1/e.scale,d.textAlign="right",d.textBaseline="middle",l=0;10>=l;l++)if(w=y/10*l,r=f+(a-q-f)*(1-w*e.scale),e.plots_showGrid&&(d.strokeStyle=e.plots_gridColor,d.lineWidth=
e.plots_gridLineWidth,d.beginPath(),d.moveTo(m,r),d.lineTo(c,r),d.stroke()),e.plots_showYAxis){d.strokeStyle="black";d.lineWidth=1;d.beginPath();d.moveTo(m,r);d.lineTo(m-3,r);d.stroke();A=100*w;w=k.max(0,3-k.floor(A).toString().length);A=A.toFixed(w);if(0<w)for(;"0"===A.charAt(A.length-1);)A=A.substring(0,A.length-1);"."===A.charAt(A.length-1)&&(A=A.substring(0,A.length-1));d.fillText(A,m-3,r)}d.strokeStyle="black";d.lineWidth=1;d.beginPath();d.moveTo(c,a-q);d.lineTo(m,a-q);e.plots_showYAxis&&d.lineTo(m,
f);d.stroke();if(0<this.dataDisplay.length)for(d.textAlign="left",d.textBaseline="top",l=y=0,r=this.dataDisplay.length;l<r;l++)if(this.dataDisplay[l].value)d.fillText([this.dataDisplay[l].display,": ",this.dataDisplay[l].value].join(""),m+10,f+10+y*(e.text_font_size+5)),y++;else if(this.dataDisplay[l].tag)for(w=0,A=this.metadata.length;w<A;w++)if(this.metadata[w].startsWith(this.dataDisplay[l].tag)){A=this.metadata[w];this.dataDisplay[l].display&&(A=this.metadata[w].indexOf("="),A=[this.dataDisplay[l].display,
": ",-1<A?this.metadata[w].substring(A+2):this.metadata[w]].join(""));d.fillText(A,m+10,f+10+y*(e.text_font_size+5));y++;break}this.drawPlot(d,e,c,a,f,m,q);this.memory.offsetTop=f;this.memory.offsetLeft=m;this.memory.offsetBottom=q;this.memory.flipXAxis=e.plots_flipXAxis;this.memory.scale=e.scale;this.memory.width=c;this.memory.height=a};v.drawPlot=function(d,e,c,a,f,m,q){this.styles&&(e=this.styles);d.strokeStyle=e.plots_color;d.lineWidth=e.plots_width;var l=[];d.save();d.rect(m,f,c-m,a-q-f);d.clip();
d.beginPath();if(this.continuous)for(var r=!1,y=0,w=!1,A=0,G=this.data.length;A<G;A++){var b=this.getTransformedX(this.data[A].x,e,c,m),g=void 0;A<G&&!r&&this.data[A+1]&&(g=this.getTransformedX(this.data[A+1].x,e,c,m));if(b>=m&&b<c||g!==p&&g>=m&&g<c){if(g=this.getTransformedY(this.data[A].y,e,a,q,f),e.plots_showIntegration&&k.abs(this.data[A].y)>this.integrationSensitivity&&l.push(new E.Point(this.data[A].x,this.data[A].y)),r||(d.moveTo(b,g),r=!0),d.lineTo(b,g),y++,0===y%1E3&&(d.stroke(),d.beginPath(),
d.moveTo(b,g)),w)break}else r&&(w=!0)}else for(r=0,y=this.data.length;r<y;r++)w=this.getTransformedX(this.data[r].x,e,c,m),w>=m&&w<c&&(d.moveTo(w,a-q),d.lineTo(w,this.getTransformedY(this.data[r].y,e,a,q,f)));d.stroke();if(e.plots_showIntegration&&1<l.length){d.strokeStyle=e.plots_integrationColor;d.lineWidth=e.plots_integrationLineWidth;d.beginPath();r=l[1].x>l[0].x;if(this.flipXAxis&&!r||!this.flipXAxis&&r){for(r=l.length-2;0<=r;r--)l[r].y+=l[r+1].y;r=l[0].y}else{r=1;for(y=l.length;r<y;r++)l[r].y+=
l[r-1].y;r=l[l.length-1].y}y=0;for(w=l.length;y<w;y++)A=this.getTransformedX(l[y].x,e,c,m),G=this.getTransformedY(l[y].y/e.scale/r,e,a,q,f),0===y?d.moveTo(A,G):d.lineTo(A,G);d.stroke()}d.restore()};v.getTransformedY=function(d,e,c,a,f){return f+(c-a-f)*(1-d*e.scale)};v.getInverseTransformedY=function(d){return(1-(d-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100};v.getTransformedX=function(d,e,c,a){d=a+(d-this.minX)/(this.maxX-this.minX)*
(c-a);e.plots_flipXAxis&&(d=c+a-d);return d};v.getInverseTransformedX=function(d){this.memory.flipXAxis&&(d=this.memory.width+this.memory.offsetLeft-d);return(d-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX};v.setup=function(){for(var d=Number.MAX_VALUE,e=Number.MIN_VALUE,c=Number.MIN_VALUE,a=0,f=this.data.length;a<f;a++)d=k.min(d,this.data[a].x),e=k.max(e,this.data[a].x),c=k.max(c,this.data[a].y);this.continuous?(this.minX=d,this.maxX=e):(this.minX=
d-1,this.maxX=e+1);d=0;for(e=this.data.length;d<e;d++)this.data[d].y/=c};v.zoom=function(d,e,c,a){d=this.getInverseTransformedX(d);e=this.getInverseTransformedX(e);this.minX=k.min(d,e);this.maxX=k.max(d,e);if(a){a=Number.MIN_VALUE;e=0;for(d=this.data.length;e<d;e++)x.isBetween(this.data[e].x,this.minX,this.maxX)&&(a=k.max(a,this.data[e].y));return 1/a}};v.translate=function(d,e){d=d/(e-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=d;this.maxX+=d};v.alertMetadata=
function(){alert(this.metadata.join("\n"))};v.getInternalCoordinates=function(d,e){return new ChemDoodle.structures.Point(this.getInverseTransformedX(d),this.getInverseTransformedY(e))};v.getClosestPlotInternalCoordinates=function(d){var e=this.getInverseTransformedX(d-1);d=this.getInverseTransformedX(d+1);if(e>d){var c=e;e=d;d=c}c=-1;for(var a=-Infinity,f=!1,m=0,q=this.data.length;m<q;m++){var l=this.data[m];if(x.isBetween(l.x,e,d))l.y>a&&(f=!0,a=l.y,c=m);else if(f)break}if(-1===c)return p;e=this.data[c];
return new ChemDoodle.structures.Point(e.x,100*e.y)};v.getClosestPeakInternalCoordinates=function(d){var e=this.getInverseTransformedX(d);d=0;for(var c=Infinity,a=0,f=this.data.length;a<f;a++){var m=k.abs(this.data[a].x-e);if(m<=c)c=m,d=a;else break}c=e=d;a=this.data[d].y;f=this.data[d].y;m=d+1;for(var q=this.data.length;m<q;m++)if(this.data[m].y+.05>f)f=this.data[m].y,c=m;else break;for(f=d-1;0<=f;f--)if(this.data[f].y+.05>a)a=this.data[f].y,e=f;else break;d=this.data[e-d>c-d?c:e];return new ChemDoodle.structures.Point(d.x,
100*d.y)}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,ChemDoodle.lib.jQuery,Math);
(function(n,E,x,v){E._Shape=function(){};E=E._Shape.prototype;E.drawDecorations=function(k,p){if(this.isHover)for(var d=this.getPoints(),e=0,c=d.length;e<c;e++){var a=d[e];this.drawAnchor(k,p,a,a===this.hoverPoint)}};E.getBounds=function(){for(var k=new n.Bounds,p=this.getPoints(),d=0,e=p.length;d<e;d++){var c=p[d];k.expand(c.x,c.y)}return k};E.drawAnchor=function(k,p,d,e){k.save();k.translate(d.x,d.y);k.rotate(x.PI/4);k.scale(1/p.scale,1/p.scale);k.beginPath();k.moveTo(-4,-4);k.lineTo(4,-4);k.lineTo(4,
4);k.lineTo(-4,4);k.closePath();k.fillStyle=e?p.colorHover:"white";k.fill();k.beginPath();k.moveTo(-4,-2);k.lineTo(-4,-4);k.lineTo(-2,-4);k.moveTo(2,-4);k.lineTo(4,-4);k.lineTo(4,-2);k.moveTo(4,2);k.lineTo(4,4);k.lineTo(2,4);k.moveTo(-2,4);k.lineTo(-4,4);k.lineTo(-4,2);k.moveTo(-4,-2);k.strokeStyle="rgba(0,0,0,.2)";k.lineWidth=5;k.stroke();k.strokeStyle="blue";k.lineWidth=1;k.stroke();k.restore()}})(ChemDoodle.math,ChemDoodle.structures.d2,Math);
(function(n,E,x,v,k,p){v.AtomMapping=function(d,e){this.o1=d;this.o2=e;this.label="0";this.error=!1};E=v.AtomMapping.prototype=new v._Shape;E.drawDecorations=function(d,e){if(this.isHover||this.isSelected)d.strokeStyle=this.isHover?e.colorHover:e.colorSelect,d.lineWidth=1,d.beginPath(),d.moveTo(this.o1.x,this.o1.y),d.lineTo(this.o2.x,this.o2.y),d.setLineDash([2]),d.stroke(),d.setLineDash([])};E.draw=function(d,e){if(this.o1&&this.o2){this.x1=this.o1.x+14*k.cos(this.o1.angleOfLeastInterference);this.y1=
this.o1.y-14*k.sin(this.o1.angleOfLeastInterference);this.x2=this.o2.x+14*k.cos(this.o2.angleOfLeastInterference);this.y2=this.o2.y-14*k.sin(this.o2.angleOfLeastInterference);d.font=n.getFontString(e.text_font_size,e.text_font_families,e.text_font_bold,e.text_font_italic);var c=this.label,a=d.measureText(c).width;this.isLassoed&&(d.fillStyle=e.colorHover,d.fillRect(this.x1-a/2-3,this.y1-e.text_font_size/2-3,a+6,e.text_font_size+6),d.fillRect(this.x2-a/2-3,this.y2-e.text_font_size/2-3,a+6,e.text_font_size+
6));var f=this.error?e.colorError:e.shapes_color;if(this.isHover||this.isSelected)f=this.isHover?e.colorHover:e.colorSelect;d.fillStyle=f;d.fillRect(this.x1-a/2-1,this.y1-e.text_font_size/2-1,a+2,e.text_font_size+2);d.fillRect(this.x2-a/2-1,this.y2-e.text_font_size/2-1,a+2,e.text_font_size+2);d.textAlign="center";d.textBaseline="middle";d.fillStyle=e.backgroundColor;d.fillText(c,this.x1,this.y1);d.fillText(c,this.x2,this.y2)}};E.getPoints=function(){return[new x.Point(this.x1,this.y1),new x.Point(this.x2,
this.y2)]};E.isOver=function(d,e){return this.x1?d.distance({x:this.x1,y:this.y1})<e||d.distance({x:this.x2,y:this.y2})<e:!1}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,x,v,k,p){v.Bracket=function(d,e){this.p1=d?d:new x.Point;this.p2=e?e:new x.Point};v=v.Bracket.prototype=new v._Shape;v.charge=0;v.mult=0;v.repeat=0;v.draw=function(d,e){var c=k.min(this.p1.x,this.p2.x),a=k.max(this.p1.x,this.p2.x),f=k.min(this.p1.y,this.p2.y),m=k.max(this.p1.y,this.p2.y),q=m-f,l=q/10;d.beginPath();d.moveTo(c+l,f);d.lineTo(c,f);d.lineTo(c,m);d.lineTo(c+l,m);d.moveTo(a-l,m);d.lineTo(a,m);d.lineTo(a,f);d.lineTo(a-l,f);this.isLassoed&&(l=d.createLinearGradient(this.p1.x,
this.p1.y,this.p2.x,this.p2.y),l.addColorStop(0,"rgba(212, 99, 0, 0)"),l.addColorStop(.5,"rgba(212, 99, 0, 0.8)"),l.addColorStop(1,"rgba(212, 99, 0, 0)"),d.lineWidth=e.shapes_lineWidth+5,d.strokeStyle=l,d.lineJoin="miter",d.lineCap="square",d.stroke());d.strokeStyle=e.shapes_color;d.lineWidth=e.shapes_lineWidth;d.lineJoin="miter";d.lineCap="butt";d.stroke();0!==this.charge&&(d.fillStyle=e.text_color,d.textAlign="left",d.textBaseline="alphabetic",d.font=n.getFontString(e.text_font_size,e.text_font_families),
l=this.charge.toFixed(0),l="1"===l?"+":"-1"===l?"\u2013":l.startsWith("-")?l.substring(1)+"\u2013":l+"+",d.fillText(l,a+5,f+5));0!==this.mult&&(d.fillStyle=e.text_color,d.textAlign="right",d.textBaseline="middle",d.font=n.getFontString(e.text_font_size,e.text_font_families),d.fillText(this.mult.toFixed(0),c-5,f+q/2));0!==this.repeat&&(d.fillStyle=e.text_color,d.textAlign="left",d.textBaseline="top",d.font=n.getFontString(e.text_font_size,e.text_font_families),e=this.repeat.toFixed(0),d.fillText(e,
a+5,m-5))};v.getPoints=function(){return[this.p1,this.p2]};v.isOver=function(d,e){return E.isBetween(d.x,this.p1.x,this.p2.x)&&E.isBetween(d.y,this.p1.y,this.p2.y)}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,x,v,k,p,d){k.RepeatUnit=function(c,a){this.b1=c;this.b2=a;this.n1=1;this.n2=4;this.contents=[];this.ps=[]};E=k.RepeatUnit.prototype=new k._Shape;E.drawDecorations=function(c,a){if(this.isHover){a=0;for(var f=this.contents.length;a<f;a++){var m=this.contents[a],q=c.createRadialGradient(m.x-1,m.y-1,0,m.x,m.y,7);q.addColorStop(0,"rgba(212, 99, 0, 0)");q.addColorStop(.7,"rgba(212, 99, 0, 0.8)");c.fillStyle=q;c.beginPath();c.arc(m.x,m.y,5,0,2*p.PI,!1);c.fill()}}};var e=function(c,a,f,m,q){a=
[];var l=0<q.length?-1===q.indexOf(f.a1)?f.a2:f.a1:f.a1.distance(m.getCenter())<f.a2.distance(m.getCenter())?f.a1:f.a2;m=l.angle(f.getNeighbor(l));var r=m+p.PI/2;f=f.getLength()/(1<q.length?4:2);q=l.x+f*p.cos(m);l=l.y-f*p.sin(m);var y=10*p.cos(r),w=10*p.sin(r);r=q+y;f=l-w;q-=y;l+=w;w=-4*p.cos(m);var A=-4*p.sin(m);m=r+w;y=f-A;w=q+w;A=l-A;c.beginPath();c.moveTo(m,y);c.lineTo(r,f);c.lineTo(q,l);c.lineTo(w,A);c.stroke();a.push(new v.Point(r,f));a.push(new v.Point(q,l));return a};E.draw=function(c,a){if(this.b1&&
this.b2){var f=this.error?a.colorError:a.shapes_color;if(this.isHover||this.isSelected)f=this.isHover?a.colorHover:a.colorSelect;c.strokeStyle=f;c.fillStyle=c.strokeStyle;c.lineWidth=a.shapes_lineWidth;c.lineJoin="miter";c.lineCap="butt";f=e(c,a,this.b1,this.b2,this.contents);var m=e(c,a,this.b2,this.b1,this.contents);this.ps=f.concat(m);this.b1.getCenter().x>this.b2.getCenter().x?this.textPos=this.ps[0].x>this.ps[1].x+5?this.ps[0]:this.ps[1]:this.textPos=this.ps[2].x>this.ps[3].x+5?this.ps[2]:this.ps[3];
!this.error&&0<this.contents.length&&(c.font=n.getFontString(a.text_font_size,a.text_font_families,a.text_font_bold,a.text_font_italic),c.fillStyle=this.isHover?a.colorHover:a.text_color,c.textAlign="left",c.textBaseline="bottom",c.fillText(this.n1+"-"+this.n2,this.textPos.x+2,this.textPos.y+2))}};E.getPoints=function(){return this.ps};E.isOver=function(c,a){return!1};E.setContents=function(c){this.contents=[];var a=c.getMoleculeByAtom(this.b1.a1);c=c.getMoleculeByAtom(this.b2.a1);if(a&&a===c){for(var f=
c=0,m=0,q=a.rings.length;m<q;m++)for(var l=a.rings[m],r=0,y=l.bonds.length;r<y;r++){var w=l.bonds[r];w===this.b1?c++:w===this.b2&&f++}c=1===c&&1===f&&this.b1.ring===this.b2.ring;this.contents.flippable=c;if(this.b1.ring===d&&this.b2.ring===d||c)for(f=0,m=a.atoms.length;f<m;f++){r=l=q=!1;y=0;for(w=a.bonds.length;y<w;y++)a.bonds[y].visited=!1;y=new v.Queue;w=a.atoms[f];for(y.enqueue(w);!(y.isEmpty()||q&&l);){var A=y.dequeue();c&&(!this.flip&&A===this.b1.a1||this.flip&&A===this.b1.a2)&&(r=!0);for(var G=
0,b=a.bonds.length;G<b;G++){var g=a.bonds[G];if(g.a1===A||g.a2===A)g===this.b1?q=!0:g===this.b2?l=!0:g.visited||(g.visited=!0,y.enqueue(g.getNeighbor(A)))}}q&&l&&(!c||r)&&this.contents.push(w)}}}})(ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.lib.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,x,v,k,p){v.Line=function(e,c){this.p1=e?e:new x.Point;this.p2=c?c:new x.Point};v.Line.ARROW_SYNTHETIC="synthetic";v.Line.ARROW_RETROSYNTHETIC="retrosynthetic";v.Line.ARROW_RESONANCE="resonance";v.Line.ARROW_EQUILIBRIUM="equilibrium";var d=v.Line.prototype=new v._Shape;d.arrowType=p;d.topText=p;d.bottomText=p;d.draw=function(e,c){if(this.isLassoed){var a=e.createLinearGradient(this.p1.x,this.p1.y,this.p2.x,this.p2.y);a.addColorStop(0,"rgba(212, 99, 0, 0)");a.addColorStop(.5,"rgba(212, 99, 0, 0.8)");
a.addColorStop(1,"rgba(212, 99, 0, 0)");var f=this.p1.angle(this.p2)+k.PI/2,m=k.cos(f),q=k.sin(f);f=this.p1.x-2.5*m;var l=this.p1.y+2.5*q,r=this.p1.x+2.5*m,y=this.p1.y-2.5*q,w=this.p2.x+2.5*m,A=this.p2.y-2.5*q;m=this.p2.x-2.5*m;q=this.p2.y+2.5*q;e.fillStyle=a;e.beginPath();e.moveTo(f,l);e.lineTo(r,y);e.lineTo(w,A);e.lineTo(m,q);e.closePath();e.fill()}e.strokeStyle=c.shapes_color;e.fillStyle=c.shapes_color;e.lineWidth=c.shapes_lineWidth;e.lineJoin="miter";e.lineCap="butt";if(this.p1.x!==this.p2.x||
this.p1.y!==this.p2.y){if(this.arrowType===v.Line.ARROW_RETROSYNTHETIC){f=2*k.sqrt(2);a=c.shapes_arrowLength_2D/f;r=this.p1.angle(this.p2);y=r+k.PI/2;f=c.shapes_arrowLength_2D/f;l=k.cos(r);r=k.sin(r);var G=k.cos(y),b=k.sin(y);y=this.p1.x-G*a;w=this.p1.y+b*a;A=this.p1.x+G*a;m=this.p1.y-b*a;q=this.p2.x+G*a-l*f;var g=this.p2.y-b*a+r*f,t=this.p2.x-G*a-l*f,B=this.p2.y+b*a+r*f,F=this.p2.x+G*a*2-l*f*2,I=this.p2.y-b*a*2+r*f*2;l=this.p2.x-G*a*2-l*f*2;a=this.p2.y+b*a*2+r*f*2;e.beginPath();e.moveTo(A,m);e.lineTo(q,
g);e.moveTo(F,I);e.lineTo(this.p2.x,this.p2.y);e.lineTo(l,a);e.moveTo(t,B);e.lineTo(y,w)}else this.arrowType===v.Line.ARROW_EQUILIBRIUM?(a=2*k.sqrt(2),g=c.shapes_arrowLength_2D/a/2,l=this.p1.angle(this.p2),y=l+k.PI/2,a=2*c.shapes_arrowLength_2D/k.sqrt(3),f=k.cos(l),l=k.sin(l),r=k.cos(y),y=k.sin(y),w=this.p1.x-r*g,A=this.p1.y+y*g,t=this.p1.x+r*g,B=this.p1.y-y*g,m=this.p2.x+r*g,q=this.p2.y-y*g,F=this.p2.x-r*g,g=this.p2.y+y*g,e.beginPath(),e.moveTo(t,B),e.lineTo(m,q),e.moveTo(F,g),e.lineTo(w,A),e.stroke(),
g=m-f*a*.8,t=q+l*a*.8,B=m+r*c.shapes_arrowLength_2D/3-f*a,F=q-y*c.shapes_arrowLength_2D/3+l*a,e.beginPath(),e.moveTo(m,q),e.lineTo(B,F),e.lineTo(g,t),e.closePath(),e.fill(),e.stroke(),g=w+f*a*.8,t=A-l*a*.8,B=w-r*c.shapes_arrowLength_2D/3+f*a,F=A+y*c.shapes_arrowLength_2D/3-l*a,e.beginPath(),e.moveTo(w,A),e.lineTo(B,F),e.lineTo(g,t),e.closePath(),e.fill()):this.arrowType===v.Line.ARROW_SYNTHETIC?(l=this.p1.angle(this.p2),r=l+k.PI/2,a=2*c.shapes_arrowLength_2D/k.sqrt(3),f=k.cos(l),l=k.sin(l),m=k.cos(r),
q=k.sin(r),e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x-f*a/2,this.p2.y+l*a/2),e.stroke(),r=this.p2.x-f*a*.8,y=this.p2.y+l*a*.8,w=this.p2.x+m*c.shapes_arrowLength_2D/3-f*a,A=this.p2.y-q*c.shapes_arrowLength_2D/3+l*a,f=this.p2.x-m*c.shapes_arrowLength_2D/3-f*a,a=this.p2.y+q*c.shapes_arrowLength_2D/3+l*a,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(f,a),e.lineTo(r,y),e.lineTo(w,A),e.closePath(),e.fill()):this.arrowType===v.Line.ARROW_RESONANCE?(l=this.p1.angle(this.p2),y=l+
k.PI/2,a=2*c.shapes_arrowLength_2D/k.sqrt(3),f=k.cos(l),l=k.sin(l),r=k.cos(y),y=k.sin(y),e.beginPath(),e.moveTo(this.p1.x+f*a/2,this.p1.y-l*a/2),e.lineTo(this.p2.x-f*a/2,this.p2.y+l*a/2),e.stroke(),w=this.p2.x-f*a*.8,A=this.p2.y+l*a*.8,m=this.p2.x+r*c.shapes_arrowLength_2D/3-f*a,q=this.p2.y-y*c.shapes_arrowLength_2D/3+l*a,g=this.p2.x-r*c.shapes_arrowLength_2D/3-f*a,t=this.p2.y+y*c.shapes_arrowLength_2D/3+l*a,e.beginPath(),e.moveTo(this.p2.x,this.p2.y),e.lineTo(g,t),e.lineTo(w,A),e.lineTo(m,q),e.closePath(),
e.fill(),e.stroke(),w=this.p1.x+f*a*.8,A=this.p1.y-l*a*.8,m=this.p1.x-r*c.shapes_arrowLength_2D/3+f*a,q=this.p1.y+y*c.shapes_arrowLength_2D/3-l*a,g=this.p1.x+r*c.shapes_arrowLength_2D/3+f*a,t=this.p1.y-y*c.shapes_arrowLength_2D/3-l*a,e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(g,t),e.lineTo(w,A),e.lineTo(m,q),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(this.p1.x,this.p1.y),e.lineTo(this.p2.x,this.p2.y));e.stroke();if(this.topText||this.bottomText)e.font=n.getFontString(c.text_font_size,
c.text_font_families,c.text_font_bold,c.text_font_italic),e.fillStyle=c.text_color;this.topText&&(e.textAlign="center",e.textBaseline="bottom",e.fillText(this.topText,(this.p1.x+this.p2.x)/2,this.p1.y-5));this.bottomText&&(e.textAlign="center",e.textBaseline="top",e.fillText(this.bottomText,(this.p1.x+this.p2.x)/2,this.p1.y+5))}};d.getPoints=function(){return[this.p1,this.p2]};d.isOver=function(e,c){e=E.distanceFromPointToLineInclusive(e,this.p1,this.p2);return-1!==e&&e<c}})(ChemDoodle.extensions,
ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,x,v,k,p){var d=function(a){var f=[];if(a instanceof x.Atom)if(0===a.bondNumber)f.push(k.PI);else{if(a.angles){if(1===a.angles.length)f.push(a.angles[0]+k.PI);else{for(var m=1,q=a.angles.length;m<q;m++)f.push(a.angles[m-1]+(a.angles[m]-a.angles[m-1])/2);m=a.angles[a.angles.length-1];f.push(m+(a.angles[0]+2*k.PI-m)/2)}a.largestAngle>k.PI&&(f=[a.angleOfLeastInterference]);if(a.bonds)for(m=0,q=a.bonds.length;m<q;m++){var l=a.bonds[m];if(2===l.bondOrder&&(l=l.getNeighbor(a),"O"===l.label)){f=
[l.angle(a)];break}}}}else a=a.a1.angle(a.a2),f.push(a+k.PI/2),f.push(a+3*k.PI/2);a=0;for(m=f.length;a<m;a++){for(;f[a]>2*k.PI;)f[a]-=2*k.PI;for(;0>f[a];)f[a]+=2*k.PI}return f},e=function(a,f){var m=3;if(a instanceof x.Atom){if(a.isLabelVisible(f)&&(m=8),0!==a.charge||0!==a.numRadical||0!==a.numLonePair)m=13}else a instanceof x.Point?m=0:1<a.bondOrder&&(m=5);return m},c=function(a,f,m,q,l,r,y,w,A,G){var b=r.angle(l),g=y.angle(w),t=k.cos(b);b=k.sin(b);var B=e(m,f);l.x-=t*B;l.y+=b*B;B=g+k.PI/2;m=2*
f.shapes_arrowLength_2D/k.sqrt(3);t=k.cos(g);b=k.sin(g);var F=k.cos(B),I=k.sin(B);w.x-=5*t;w.y+=5*b;g=new x.Point(w.x,w.y);B=e(q,f)/3;g.x-=t*B;g.y+=b*B;w.x-=t*(.8*m+B);w.y+=b*(.8*m+B);q=g.x-t*m*.8;B=g.y+b*m*.8;var L=new x.Point(g.x+F*f.shapes_arrowLength_2D/3-t*m,g.y-I*f.shapes_arrowLength_2D/3+b*m);f=new x.Point(g.x-F*f.shapes_arrowLength_2D/3-t*m,g.y+I*f.shapes_arrowLength_2D/3+b*m);b=t=!0;1===A&&(L.distance(r)>f.distance(r)?b=!1:t=!1);a.beginPath();a.moveTo(g.x,g.y);b&&a.lineTo(f.x,f.y);a.lineTo(q,
B);t&&a.lineTo(L.x,L.y);a.closePath();a.fill();a.stroke();a.beginPath();a.moveTo(l.x,l.y);a.bezierCurveTo(r.x,r.y,y.x,y.y,w.x,w.y);a.stroke();G.push([l,r,y,w])};v.Pusher=function(a,f,m){this.o1=a;this.o2=f;this.numElectron=m?m:1};v=v.Pusher.prototype=new v._Shape;v.drawDecorations=function(a,f){if(this.isHover){var m=this.o1 instanceof x.Atom?new x.Point(this.o1.x,this.o1.y):this.o1.getCenter(),q=this.o2 instanceof x.Atom?new x.Point(this.o2.x,this.o2.y):this.o2.getCenter();m=[m,q];q=0;for(var l=
m.length;q<l;q++){var r=m[q];this.drawAnchor(a,f,r,r===this.hoverPoint)}}};v.draw=function(a,f){if(this.o1&&this.o2){a.strokeStyle=f.shapes_color;a.fillStyle=f.shapes_color;a.lineWidth=f.shapes_lineWidth;a.lineJoin="miter";a.lineCap="butt";for(var m=this.o1 instanceof x.Atom?new x.Point(this.o1.x,this.o1.y):this.o1.getCenter(),q=this.o2 instanceof x.Atom?new x.Point(this.o2.x,this.o2.y):this.o2.getCenter(),l=d(this.o1),r=d(this.o2),y,w,A=Infinity,G=0,b=l.length;G<b;G++)for(var g=0,t=r.length;g<t;g++){var B=
new x.Point(m.x+35*k.cos(l[G]),m.y-35*k.sin(l[G])),F=new x.Point(q.x+35*k.cos(r[g]),q.y-35*k.sin(r[g])),I=B.distance(F);I<A&&(A=I,y=B,w=F)}this.caches=[];-1===this.numElectron?(G=m.distance(q)/2,r=m.angle(q),l=r+k.PI/2,b=k.cos(r),g=k.sin(r),r=new x.Point(m.x+(G-1)*b,m.y-(G-1)*g),A=new x.Point(r.x+35*k.cos(l+k.PI/6),r.y-35*k.sin(l+k.PI/6)),G=new x.Point(m.x+(G+1)*b,m.y-(G+1)*g),l=new x.Point(G.x+35*k.cos(l-k.PI/6),G.y-35*k.sin(l-k.PI/6)),c(a,f,this.o1,r,m,y,A,r,1,this.caches),c(a,f,this.o2,G,q,w,l,
G,1,this.caches)):(n.intersectLines(m.x,m.y,y.x,y.y,q.x,q.y,w.x,w.y)&&(l=y,y=w,w=l),l=y.angle(m),r=w.angle(q),A=k.max(l,r)-k.min(l,r),.001>k.abs(A-k.PI)&&this.o1.molCenter===this.o2.molCenter&&(l+=k.PI/2,r-=k.PI/2,y.x=m.x+35*k.cos(l+k.PI),y.y=m.y-35*k.sin(l+k.PI),w.x=q.x+35*k.cos(r+k.PI),w.y=q.y-35*k.sin(r+k.PI)),c(a,f,this.o1,this.o2,m,y,w,q,this.numElectron,this.caches))}};v.getPoints=function(){return[]};v.isOver=function(a,f){for(var m=0,q=this.caches.length;m<q;m++)if(E.distanceFromCurve(a,this.caches[m]).distance<
f)return!0;return!1}})(ChemDoodle.math,ChemDoodle.lib.jsBezier,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,x,v,k){var p=new E.Bond;x.VAP=function(d,e){this.asterisk=new E.Atom("O",d,e);this.substituent;this.bondType=1;this.attachments=[]};n=x.VAP.prototype=new x._Shape;n.drawDecorations=function(d,e){if(this.isHover||this.isSelected){d.strokeStyle=this.isHover?e.colorHover:e.colorSelect;d.lineWidth=1.2;if(this.hoverBond){var c=2*v.PI,a=(this.asterisk.angleForStupidCanvasArcs(this.hoverBond)+v.PI/2)%c;d.strokeStyle=this.isHover?e.colorHover:e.colorSelect;d.beginPath();e=(a+v.PI)%c;e%=2*v.PI;
d.arc(this.asterisk.x,this.asterisk.y,7,a,e,!1);d.stroke();d.beginPath();a+=v.PI;e=(a+v.PI)%c;d.arc(this.hoverBond.x,this.hoverBond.y,7,a,e,!1)}else d.beginPath(),d.arc(this.asterisk.x,this.asterisk.y,7,0,2*v.PI,!1);d.stroke()}};n.draw=function(d,e){d.strokeStyle=this.error?e.colorError:e.shapes_color;d.lineWidth=1;var c=v.sqrt(3)/2;d.beginPath();d.moveTo(this.asterisk.x,this.asterisk.y-4);d.lineTo(this.asterisk.x,this.asterisk.y+4);d.moveTo(this.asterisk.x-4*c,this.asterisk.y-2);d.lineTo(this.asterisk.x+
4*c,this.asterisk.y+2);d.moveTo(this.asterisk.x-4*c,this.asterisk.y+2);d.lineTo(this.asterisk.x+4*c,this.asterisk.y-2);d.stroke();this.asterisk.textBounds=[];this.asterisk.textBounds.push({x:this.asterisk.x-4,y:this.asterisk.y-4,w:8,h:8});c=e.bonds_color;this.error&&(e.bonds_color=e.colorError);p.a1=this.asterisk;this.substituent&&(p.a2=this.substituent,p.bondOrder=this.bondType,p.draw(d,e));p.bondOrder=0;this.error||(e.bonds_color=e.shapes_color);for(var a=0,f=this.attachments.length;a<f;a++)p.a2=
this.attachments[a],p.draw(d,e);e.bonds_color=c};n.getPoints=function(){return[this.asterisk]};n.isOver=function(d,e){return!1}})(ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d2,Math);
(function(n,E,x){n._Mesh=function(){};n=n._Mesh.prototype;n.storeData=function(v,k,p){this.positionData=v;this.normalData=k;this.indexData=p};n.setupBuffers=function(v){this.vertexPositionBuffer=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,this.vertexPositionBuffer);v.bufferData(v.ARRAY_BUFFER,new Float32Array(this.positionData),v.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=this.positionData.length/3;this.vertexNormalBuffer=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,
this.vertexNormalBuffer);v.bufferData(v.ARRAY_BUFFER,new Float32Array(this.normalData),v.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=this.normalData.length/3;this.indexData&&(this.vertexIndexBuffer=v.createBuffer(),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),v.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length);if(this.partitions)for(var k=
0,p=this.partitions.length;k<p;k++){var d=this.partitions[k],e=this.generateBuffers(v,d.positionData,d.normalData,d.indexData);d.vertexPositionBuffer=e[0];d.vertexNormalBuffer=e[1];d.vertexIndexBuffer=e[2]}};n.generateBuffers=function(v,k,p,d){var e=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,e);v.bufferData(v.ARRAY_BUFFER,new Float32Array(k),v.STATIC_DRAW);e.itemSize=3;e.numItems=k.length/3;k=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,k);v.bufferData(v.ARRAY_BUFFER,new Float32Array(p),v.STATIC_DRAW);
k.itemSize=3;k.numItems=p.length/3;if(d){var c=v.createBuffer();v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,c);v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),v.STATIC_DRAW);c.itemSize=1;c.numItems=d.length}return[e,k,c]};n.bindBuffers=function(v){this.vertexPositionBuffer||this.setupBuffers(v);v.bindBuffer(v.ARRAY_BUFFER,this.vertexPositionBuffer);v.vertexAttribPointer(v.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,v.FLOAT,!1,0,0);v.bindBuffer(v.ARRAY_BUFFER,this.vertexNormalBuffer);
v.vertexAttribPointer(v.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,v.FLOAT,!1,0,0);this.vertexIndexBuffer&&v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures.d3,Math);
(function(n,E){n._Measurement=function(){};n=n._Measurement.prototype=new n._Mesh;n.render=function(x,v){x.shader.setMatrixUniforms(x);v.measurement_update_3D&&(this.text=this.vertexPositionBuffer=E);this.vertexPositionBuffer||this.calculateData(v);this.bindBuffers(x);x.material.setDiffuseColor(x,v.shapes_color);x.lineWidth(v.shapes_lineWidth);x.drawElements(x.LINES,this.vertexIndexBuffer.numItems,x.UNSIGNED_SHORT,0)};n.renderText=function(x,v){x.shader.setMatrixUniforms(x);this.text||(this.text=
this.getText(v));v={position:[],texCoord:[],translation:[]};x.textImage.pushVertexData(this.text.value,this.text.pos,1,v);x.textMesh.storeData(x,v.position,v.texCoord,v.translation);x.textImage.useTexture(x);x.textMesh.render(x)}})(ChemDoodle.structures.d3);
(function(n,E,x,v,k,p,d,e){x.Angle=function(c,a,f){this.a1=c;this.a2=a;this.a3=f};n=x.Angle.prototype=new x._Measurement;n.calculateData=function(c){var a=[],f=[],m=[],q=this.a2.distance3D(this.a1),l=this.a2.distance3D(this.a3);this.distUse=k.min(q,l)/2;this.vec1=d.normalize([this.a1.x-this.a2.x,this.a1.y-this.a2.y,this.a1.z-this.a2.z]);this.vec2=d.normalize([this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z]);this.angle=E.vec3AngleFrom(this.vec1,this.vec2);q=d.normalize(d.cross(this.vec1,
this.vec2,[]));q=d.normalize(d.cross(q,this.vec1,[]));c=c.measurement_angleBands_3D;for(l=0;l<=c;++l){var r=this.angle*l/c,y=d.scale(this.vec1,k.cos(r),[]);r=d.scale(q,k.sin(r),[]);y=d.scale(d.normalize(d.add(y,r,[])),this.distUse);a.push(this.a2.x+y[0],this.a2.y+y[1],this.a2.z+y[2]);f.push(0,0,0);l<c&&m.push(l,l+1)}this.storeData(a,f,m)};n.getText=function(c){c=d.scale(d.normalize(d.add(this.vec1,this.vec2,[])),this.distUse+.3);return{pos:[this.a2.x+c[0],this.a2.y+c[1],this.a2.z+c[2]],value:[v.angleBounds(this.angle,
!0).toFixed(2)," \u00b0"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures.d3,ChemDoodle.math,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,x){n.Arrow=function(v,k){for(var p=[],d=[],e=0;e<=k;e++){var c=2*e*E.PI/k,a=E.sin(c);c=E.cos(c);d.push(0,0,-1,0,0,-1,c,a,0,c,a,0,0,0,-1,0,0,-1,c,a,1,c,a,1);p.push(0,0,0,v*c,v*a,0,v*c,v*a,0,v*c,v*a,2,v*c,v*a,2,v*c*2,v*a*2,2,v*c*2,v*a*2,2,0,0,3)}v=[];for(e=0;e<k;e++)for(a=8*e,c=0;7>c;c++){var f=c+a,m=f+7+2;v.push(f,m,f+1,m,f,m-1)}this.storeData(p,d,v)};n.Arrow.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,x){n.Box=function(v,k,p){v/=2;p/=2;var d=[],e=[];d.push(v,k,-p);d.push(v,k,-p);d.push(-v,k,-p);d.push(v,k,p);d.push(-v,k,p);d.push(-v,k,p);for(var c=6;c--;e.push(0,1,0));d.push(-v,k,p);d.push(-v,k,p);d.push(-v,0,p);d.push(v,k,p);d.push(v,0,p);d.push(v,0,p);for(c=6;c--;e.push(0,0,1));d.push(v,k,p);d.push(v,k,p);d.push(v,0,p);d.push(v,k,-p);d.push(v,0,-p);d.push(v,0,-p);for(c=6;c--;e.push(1,0,0));d.push(v,k,-p);d.push(v,k,-p);d.push(v,0,-p);d.push(-v,k,-p);d.push(-v,0,-p);d.push(-v,0,
-p);for(c=6;c--;e.push(0,0,-1));d.push(-v,k,-p);d.push(-v,k,-p);d.push(-v,0,-p);d.push(-v,k,p);d.push(-v,0,p);d.push(-v,0,p);for(k=6;k--;e.push(-1,0,0));d.push(-v,0,p);d.push(-v,0,p);d.push(-v,0,-p);d.push(v,0,p);d.push(v,0,-p);d.push(v,0,-p);for(v=6;v--;e.push(0,-1,0));this.storeData(d,e)};n.Box.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,x,v,k,p){E.Camera=function(){this.fieldOfView=45;this.aspect=1;this.near=.1;this.far=1E4;this.zoom=1;this.viewMatrix=v.identity([]);this.projectionMatrix=v.identity([])};n=E.Camera.prototype;n.perspectiveProjectionMatrix=function(){var d=k.tan(this.fieldOfView/360*k.PI)*this.near*this.zoom,e=this.aspect*d;return v.frustum(-e,e,-d,d,this.near,this.far,this.projectionMatrix)};n.orthogonalProjectionMatrix=function(){var d=k.tan(this.fieldOfView/360*k.PI)*((this.far-this.near)/2+this.near)*
this.zoom,e=this.aspect*d;return v.ortho(-e,e,-d,d,this.near,this.far,this.projectionMatrix)};n.updateProjectionMatrix=function(d){return d?this.perspectiveProjectionMatrix():this.orthogonalProjectionMatrix()};n.focalLength=function(){return(this.far-this.near)/2+this.near};n.zoomOut=function(){this.zoom=k.min(1.25*this.zoom,200)};n.zoomIn=function(){this.zoom=k.max(this.zoom/1.25,.0025)}})(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3,ChemDoodle.lib.mat4,Math);
(function(n,E,x,v){n.LineArrow=function(){this.storeData([0,0,-3,.1,0,-2.8,0,0,-3,-.1,0,-2.8,0,0,-3,0,0,3,0,0,3,.1,0,2.8,0,0,3,-.1,0,2.8],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])};n.LineArrow.prototype=new n._Mesh;n.Compass=function(p,d){this.textImage=new n.TextImage;this.textImage.init(p);this.textImage.updateFont(p,d.text_font_size,d.text_font_families,d.text_font_bold,d.text_font_italic,d.text_font_stroke_3D);this.textMesh=new n.TextMesh;this.textMesh.init(p);var e=3/(d.compass_size_3D/
p.canvas.clientHeight),c=E.tan(d.projectionPerspectiveVerticalFieldOfView_3D/360*E.PI),a=e/c,f=E.max(a-e,.1),m=p.canvas.clientWidth/p.canvas.clientHeight;if(d.projectionPerspective_3D){var q=f;var l=x.frustum}else q=a,l=x.ortho;var r=q/p.canvas.clientHeight*2*c;c*=q;q=-c;var y=m*q;m*=c;if(0===d.compass_type_3D){var w=(-(p.canvas.clientWidth-d.compass_size_3D)/2+this.textImage.charHeight)*r;d=(-(p.canvas.clientHeight-d.compass_size_3D)/2+this.textImage.charHeight)*r;y-=w;m-=w;q-=d;c-=d}this.projectionMatrix=
l(y,m,q,c,f,a+e);this.translationMatrix=x.translate(x.identity([]),[0,0,-a]);e={position:[],texCoord:[],translation:[]};this.textImage.pushVertexData("X",[3.5,0,0],0,e);this.textImage.pushVertexData("Y",[0,3.5,0],0,e);this.textImage.pushVertexData("Z",[0,0,3.5],0,e);this.textMesh.storeData(p,e.position,e.texCoord,e.translation)};var k=n.Compass.prototype;k.renderArrow=function(p,d,e,c){p.material.setDiffuseColor(p,e);p.shader.setModelViewMatrix(p,c);1===d?p.drawArrays(p.LINES,0,p.lineArrowBuffer.vertexPositionBuffer.numItems):
p.drawElements(p.TRIANGLES,p.arrowBuffer.vertexIndexBuffer.numItems,p.UNSIGNED_SHORT,0)};k.render=function(p,d){p.shader.setProjectionMatrix(p,this.projectionMatrix);1===d.compass_type_3D?p.lineArrowBuffer.bindBuffers(p):p.arrowBuffer.bindBuffers(p);p.material.setTempColors(p,d.bonds_materialAmbientColor_3D,v,d.bonds_materialSpecularColor_3D,d.bonds_materialShininess_3D);var e=x.multiply(this.translationMatrix,p.rotationMatrix,[]),c=E.PI/2;this.renderArrow(p,d.compass_type_3D,d.compass_axisXColor_3D,
x.rotateY(e,c,[]));this.renderArrow(p,d.compass_type_3D,d.compass_axisYColor_3D,x.rotateX(e,-c,[]));this.renderArrow(p,d.compass_type_3D,d.compass_axisZColor_3D,e)};k.renderAxis=function(p){p.shader.setProjectionMatrix(p,this.projectionMatrix);var d=x.multiply(this.translationMatrix,p.rotationMatrix,[]);p.shader.setModelViewMatrix(p,d);this.textImage.useTexture(p);this.textMesh.render(p)}})(ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4);
(function(n,E,x){n.Cylinder=function(v,k,p,d){var e=[],c=[];if(d){for(d=0;d<=p;d++){var a=d%p*2*E.PI/p,f=E.cos(a);a=E.sin(a);c.push(0,-1,0);e.push(0,0,0);c.push(0,-1,0);e.push(v*f,0,v*a)}for(d=0;d<=p;d++)a=d%p*2*E.PI/p,f=E.cos(a),a=E.sin(a),c.push(f,0,a),e.push(v*f,0,v*a),c.push(f,0,a),e.push(v*f,k,v*a);for(d=0;d<=p;d++)a=d%p*2*E.PI/p,f=E.cos(a),a=E.sin(a),c.push(0,1,0),e.push(v*f,k,v*a),c.push(0,1,0),e.push(0,k,0)}else{for(d=0;d<p;d++)a=2*d*E.PI/p,f=E.cos(a),a=E.sin(a),c.push(f,0,a),e.push(v*f,0,
v*a),c.push(f,0,a),e.push(v*f,k,v*a);c.push(1,0,0);e.push(v,0,0);c.push(1,0,0);e.push(v,k,0)}this.storeData(e,c)};n.Cylinder.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,x,v,k){E.Distance=function(p,d,e,c){this.a1=p;this.a2=d;this.node=e;this.offset=c?c:0};E=E.Distance.prototype=new E._Measurement;E.calculateData=function(p){var d=[this.a1.x,this.a1.y,this.a1.z,this.a2.x,this.a2.y,this.a2.z];this.node&&(this.move=this.offset+x.max(p.atoms_useVDWDiameters_3D?n[this.a1.label].vdWRadius*p.atoms_vdwMultiplier_3D:p.atoms_sphereDiameter_3D/2,p.atoms_useVDWDiameters_3D?n[this.a2.label].vdWRadius*p.atoms_vdwMultiplier_3D:p.atoms_sphereDiameter_3D/2),this.displacement=
[(this.a1.x+this.a2.x)/2-this.node.x,(this.a1.y+this.a2.y)/2-this.node.y,(this.a1.z+this.a2.z)/2-this.node.z],v.normalize(this.displacement),p=v.scale(this.displacement,this.move,[]),d[0]+=p[0],d[1]+=p[1],d[2]+=p[2],d[3]+=p[0],d[4]+=p[1],d[5]+=p[2]);this.storeData(d,[0,0,0,0,0,0],[0,1])};E.getText=function(p){p=this.a1.distance3D(this.a2);var d=[(this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2,(this.a1.z+this.a2.z)/2];if(this.node){var e=v.scale(this.displacement,this.move+.1,[]);d[0]+=e[0];d[1]+=
e[1];d[2]+=e[2]}return{pos:d,value:[p.toFixed(2)," \u212b"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);(function(n,E,x,v){E.Fog=function(k,p,d,e){this.fogScene(k,p,d,e)};E.Fog.prototype.fogScene=function(k,p,d,e){this.colorRGB=n.getRGB(k,1);this.fogStart=p;this.fogEnd=d;this.density=e}})(ChemDoodle.math,ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(n,E,x){E.Label=function(v){};E=E.Label.prototype;E.updateVerticesBuffer=function(v,k,p){for(var d=0,e=k.length;d<e;d++){for(var c=k[d],a=c.labelMesh,f=c.atoms,m={position:[],texCoord:[],translation:[]},q=0<f.length&&f[0].hetatm!=x,l=0,r=f.length;l<r;l++){var y=f[l],w=y.label,A=.05;p.atoms_useVDWDiameters_3D?(w=n[w].vdWRadius*p.atoms_vdwMultiplier_3D,0===w&&(w=1),A+=w):p.atoms_sphereDiameter_3D&&(A+=p.atoms_sphereDiameter_3D/2*1.5);if(q)if(!y.hetatm){if(!p.macro_displayAtoms)continue}else if(y.isWater&&
!p.macro_showWaters)continue;v.textImage.pushVertexData(y.altLabel?y.altLabel:y.label,[y.x,y.y,y.z],A,m)}if((c=c.chains)&&(p.proteins_displayRibbon||p.proteins_displayBackbone))for(f=0,q=c.length;f<q;f++)for(l=c[f],r=0,y=l.length;r<y;r++)A=l[r],A.name&&(w=A.cp1,v.textImage.pushVertexData(A.name,[w.x,w.y,w.z],2,m));a.storeData(v,m.position,m.texCoord,m.translation,m.zDepth)}};E.render=function(v,k,p){v.shader.setMatrixUniforms(v);v.textImage.useTexture(v);k=0;for(var d=p.length;k<d;k++)p[k].labelMesh&&
p[k].labelMesh.render(v)}})(ChemDoodle.ELEMENT,ChemDoodle.structures.d3);(function(n,E,x){n.Sphere=function(v,k,p){for(var d=[],e=[],c=0;c<=k;c++){var a=c*E.PI/k,f=E.sin(a);a=E.cos(a);for(var m=0;m<=p;m++){var q=2*m*E.PI/p,l=E.sin(q);q=E.cos(q)*f;var r=a;l*=f;e.push(q,r,l);d.push(v*q,v*r,v*l)}}v=[];p+=1;for(c=0;c<k;c++)for(f=0;f<p;f++)a=c*p+f%p,m=a+p,v.push(a,a+1,m),f<p-1&&v.push(m,a+1,m+1);this.storeData(d,e,v)};n.Sphere.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,x,v,k){function p(e,c,a,f){this.entire=e;this.name=c;this.indexes=a;this.pi=f}var d=p.prototype;d.getColor=function(e){return e.macro_colorByChain?this.entire.chainColor:this.name?this.getResidueColor(n[this.name]?this.name:"*",e):this.helix?this.entire.front?e.proteins_ribbonCartoonHelixPrimaryColor:e.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?e.proteins_ribbonCartoonSheetColor:this.entire.front?e.proteins_primaryColor:e.proteins_secondaryColor};d.getResidueColor=function(e,
c){e=n[e];if("shapely"===c.proteins_residueColor)return e.shapelyColor;if("amino"===c.proteins_residueColor)return e.aminoColor;if("polarity"===c.proteins_residueColor){if(e.polar)return"#C10000"}else if("acidity"===c.proteins_residueColor){if(1===e.acidity)return"#0000FF";if(-1===e.acidity)return"#FF0000";if(!e.polar)return"#773300"}return"#FFFFFF"};d.render=function(e,c,a){if(this.entire.partitions&&this.pi!==this.entire.partitions.lastRender){var f=this.entire.partitions[this.pi];e.bindBuffer(e.ARRAY_BUFFER,
f.vertexPositionBuffer);e.vertexAttribPointer(e.shader.vertexPositionAttribute,f.vertexPositionBuffer.itemSize,e.FLOAT,!1,0,0);e.bindBuffer(e.ARRAY_BUFFER,f.vertexNormalBuffer);e.vertexAttribPointer(e.shader.vertexNormalAttribute,f.vertexNormalBuffer.itemSize,e.FLOAT,!1,0,0);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,f.vertexIndexBuffer);this.entire.partitions.lastRender=this.pi}this.vertexIndexBuffer||(this.vertexIndexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,
new Uint16Array(this.indexes),e.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexes.length);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);a||"rainbow"===c.proteins_residueColor||e.material.setDiffuseColor(e,this.getColor(c));e.drawElements(e.TRIANGLES,this.vertexIndexBuffer.numItems,e.UNSIGNED_SHORT,0)};E.Ribbon=function(e,c,a){var f=e[0].lineSegments.length,m=e[0].lineSegments[0].length;this.partitions=[];this.partitions.lastRender=0;this.front=
0<c;for(var q=0,l=e.length;q<l;q++){if(!r||65E3<r.positionData.length){0<this.partitions.length&&q--;var r={count:0,positionData:[],normalData:[]};this.partitions.push(r)}var y=e[q];r.count++;for(var w=0;w<f;w++)for(var A=a?y.lineSegmentsCartoon[w]:y.lineSegments[w],G=0===w,b=!1,g=0;g<m;g++){var t=A[g],B=q,F=g+1;q===e.length-1&&g===m-1?F--:g===m-1&&(B++,F=0);F=a?e[B].lineSegmentsCartoon[w][F]:e[B].lineSegments[w][F];B=!1;var I=w+1;w===f-1&&(I-=2,B=!0);I=a?y.lineSegmentsCartoon[I][g]:y.lineSegments[I][g];
F=[F.x-t.x,F.y-t.y,F.z-t.z];I=[I.x-t.x,I.y-t.y,I.z-t.z];var L=v.cross(F,I,[]);0===g&&(v.normalize(F),v.scale(F,-1),r.normalData.push(F[0],F[1],F[2]),r.positionData.push(t.x,t.y,t.z));G||b?(v.normalize(I),v.scale(I,-1),r.normalData.push(I[0],I[1],I[2]),r.positionData.push(t.x,t.y,t.z),G&&g===m-1&&(G=!1,g=-1)):(v.normalize(L),(B&&!this.front||!B&&this.front)&&v.scale(L,-1),r.normalData.push(L[0],L[1],L[2]),v.scale(L,x.abs(c)),r.positionData.push(t.x+L[0],t.y+L[1],t.z+L[2]),w===f-1&&g===m-1&&(b=!0,g=
-1));if(-1===g||g===m-1)v.normalize(F),r.normalData.push(F[0],F[1],F[2]),r.positionData.push(t.x,t.y,t.z)}}f+=2;m+=2;this.segments=[];this.partitionSegments=[];c=0;for(r=this.partitions.length;c<r;c++){q=this.partitions[c];w=[];A=k;l=0;for(y=q.count-1;l<y;l++){A=l;for(G=0;G<c;G++)A+=this.partitions[G].count-1;A=e[A];b=l*f*m;G=[];g=0;for(t=f-1;g<t;g++)for(B=b+g*m,F=0;F<m-1;F++)I=1,l===y&&(I=0),I=[B+F,B+m+F,B+m+F+I,B+F,B+F+I,B+m+F+I],F!==m-1&&(this.front?G.push(I[0],I[1],I[2],I[3],I[5],I[4]):G.push(I[0],
I[2],I[1],I[3],I[4],I[5])),F!==m-2||l===q.count-2&&c===this.partitions.length-1||(L=f*m-F,I[2]+=L,I[4]+=L,I[5]+=L),this.front?w.push(I[0],I[1],I[2],I[3],I[5],I[4]):w.push(I[0],I[2],I[1],I[3],I[4],I[5]);a&&A.split&&(w=new p(this,k,w,c),w.helix=A.helix,w.sheet=A.sheet,this.partitionSegments.push(w),w=[]);this.segments.push(new p(this,A.name,G,c))}q=new p(this,k,w,c);q.helix=A.helix;q.sheet=A.sheet;this.partitionSegments.push(q)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData);
1===this.partitions.length&&(this.partitions=k)};(E.Ribbon.prototype=new E._Mesh).render=function(e,c){this.bindBuffers(e);var a=c.macro_colorByChain?this.chainColor:k;a||(a=this.front?c.proteins_primaryColor:c.proteins_secondaryColor);e.material.setDiffuseColor(e,a);a=0;for(var f=this.partitionSegments.length;a<f;a++)this.partitionSegments[a].render(e,c,!c.proteins_ribbonCartoonize)}})(ChemDoodle.RESIDUE,ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);
(function(n,E,x,v,k){E.Light=function(p,d,e){this.camera=new E.Camera;this.lightScene(p,d,e)};k=E.Light.prototype;k.lightScene=function(p,d,e){this.diffuseRGB=n.getRGB(p,1);this.specularRGB=n.getRGB(d,1);this.direction=e;this.updateView()};k.updateView=function(){var p=x.normalize(this.direction,[]),d=x.scale(p,(this.camera.near-this.camera.far)/2-this.camera.near,[]);p=x.equal(p,[0,1,0])?[0,0,1]:[0,1,0];v.lookAt(d,[0,0,0],p,this.camera.viewMatrix);this.camera.orthogonalProjectionMatrix()}})(ChemDoodle.math,
ChemDoodle.structures.d3,ChemDoodle.lib.vec3,ChemDoodle.lib.mat4);(function(n,E){n.Line=function(){this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0])};n.Line.prototype=new n._Mesh})(ChemDoodle.structures.d3);
(function(n,E,x){E.Material=function(){};E=E.Material.prototype;E.setTempColors=function(v,k,p,d,e){k&&v.shader.setMaterialAmbientColor(v,n.getRGB(k,1));p&&v.shader.setMaterialDiffuseColor(v,n.getRGB(p,1));d&&v.shader.setMaterialSpecularColor(v,n.getRGB(d,1));v.shader.setMaterialShininess(v,e);v.shader.setMaterialAlpha(v,1)};E.setDiffuseColor=function(v,k){v.shader.setMaterialDiffuseColor(v,n.getRGB(k,1))};E.setAlpha=function(v,k){v.shader.setMaterialAlpha(v,k)}})(ChemDoodle.math,ChemDoodle.structures.d3);
(function(n,E,x,v){n.Picker=function(){};n=n.Picker.prototype;n.init=function(k){this.framebuffer=k.createFramebuffer();var p=k.createTexture(),d=k.createRenderbuffer();k.bindTexture(k.TEXTURE_2D,p);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindRenderbuffer(k.RENDERBUFFER,d);k.bindFramebuffer(k.FRAMEBUFFER,
this.framebuffer);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_2D,p,0);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,d);k.bindTexture(k.TEXTURE_2D,null);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setDimension=function(k,p,d){k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);var e=k.getFramebufferAttachmentParameter(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);k.isRenderbuffer(e)&&(k.bindRenderbuffer(k.RENDERBUFFER,
e),k.renderbufferStorage(k.RENDERBUFFER,k.DEPTH_COMPONENT16,p,d),k.bindRenderbuffer(k.RENDERBUFFER,null));e=k.getFramebufferAttachmentParameter(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME);k.isTexture(e)&&(k.bindTexture(k.TEXTURE_2D,e),k.texImage2D(k.TEXTURE_2D,0,k.RGBA,p,d,0,k.RGBA,k.UNSIGNED_BYTE,null),k.bindTexture(k.TEXTURE_2D,null));k.bindFramebuffer(k.FRAMEBUFFER,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,x){n.Pill=function(v,k,p,d){var e=1,c=2*v;k-=c;0>k?(e=0,k+=c):k<c&&(e=k/c,k=c);c=[];for(var a=[],f=0;f<=p;f++){var m=f*E.PI/p,q=E.sin(m);m=E.cos(m)*e;for(var l=0;l<=d;l++){var r=2*l*E.PI/d,y=E.sin(r);r=E.cos(r)*q;var w=m;y*=q;a.push(r,w,y);c.push(v*r,v*w+(f<p/2?k:0),v*y)}}v=[];d+=1;for(k=0;k<p;k++)for(e=0;e<d;e++)f=k*d+e%d,q=f+d,v.push(f,f+1,q),e<d-1&&v.push(q,f+1,q+1);this.storeData(c,a,v)};n.Pill.prototype=new n._Mesh})(ChemDoodle.structures.d3,Math);
(function(n,E,x,v,k,p,d,e,c){function a(q,l,r){var y=new x.Residue(-1);y.cp1=y.cp2=new x.Atom("",q,l,r);return y}function f(q,l){this.a1=q;this.a2=l}function m(q,l,r){this.a1=q;this.a2=l;this.vx=r}f.prototype.render=function(q,l){var r=this.a1,y=this.a2,w=1.001*r.distance3D(y);l=l.proteins_cylinderHelixDiameter/2;w=[l,w,l];l=p.translate(p.identity(),[r.x,r.y,r.z]);var A=[0,1,0],G=0;r.x===y.x&&r.z===y.z?(A=[0,0,1],y.y<r.y&&(G=k.PI)):(r=[y.x-r.x,y.y-r.y,y.z-r.z],G=n.vec3AngleFrom(A,r),A=d.cross(A,r,
[]));0!==G&&p.rotate(l,G,A);p.scale(l,w);q.shader.setMatrixUniforms(q,l);q.drawArrays(q.TRIANGLE_STRIP,0,q.cylinderClosedBuffer.vertexPositionBuffer.numItems)};m.prototype.render=function(q,l){this.styles&&(l=this.styles);var r=1.001*this.a1.distance3D(this.a2),y=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z],w=d.cross(y,this.vx,[]),A=d.cross(w,y,[]);d.normalize(A);d.normalize(y);d.normalize(w);y=[A[0],A[1],A[2],0,y[0],y[1],y[2],0,w[0],w[1],w[2],0,this.a1.x,this.a1.y,this.a1.z,1];p.scale(y,
[l.proteins_plankSheetWidth,r,l.proteins_tubeThickness]);q.shader.setMatrixUniforms(q,y);q.drawArrays(q.TRIANGLE_STRIP,0,q.boxBuffer.vertexPositionBuffer.numItems)};v.PipePlank=function(q,l){this.tubes=[];this.helixCylinders=[];this.sheetPlanks=[];this.chainColor=q.chainColor;var r=[],y=[],w=[],A=[];if(1<q.length){var G=q[0],b=q[1];b.helix?w.push(G):b.sheet?A.push(G):y.push(G)}G=1;for(b=q.length-1;G<=b;G++){var g=q[G];if(g.helix){if(w.push(g),g.arrow){var t=d.create(),B=d.create();if(1===w.length)t=
[g.guidePointsSmall[0].x,g.guidePointsSmall[0].y,g.guidePointsSmall[0].z],B=g.guidePointsSmall[g.guidePointsSmall.length-1],B=[B.x,B.y,B.z];else if(2===w.length)t=[w[0].cp1.x,w[0].cp1.y,w[0].cp1.z],B=[w[1].cp1.x,w[1].cp1.y,w[1].cp1.z];else{3===w.length&&w.unshift(q[k.max(G-3,0)]);for(var F=[],I=[],L=1,O=w.length-1;L<O;L++){var S=[w[L].cp1.x,w[L].cp1.y,w[L].cp1.z],W=[w[L-1].cp1.x,w[L-1].cp1.y,w[L-1].cp1.z],V=[w[L+1].cp1.x,w[L+1].cp1.y,w[L+1].cp1.z];d.subtract(W,S);d.subtract(V,S);var Z=d.scale(W,d.length(V),
[]);W=d.scale(V,d.length(W),[]);Z=d.normalize(d.add(Z,W,[]));F.push(S);I.push(Z)}w=[];L=0;for(O=F.length-1;L<O;L++){W=F[L];V=I[L];S=F[L+1];Z=I[L+1];var ba=d.normalize(d.cross(V,Z,[])),X=d.subtract(S,W,[]),ea=d.dot(X,ba);ba=d.scale(ba,ea,[]);ba=d.length(ba);X=d.length(X);X=-(ba*ba-X*X)/(2*d.dot(d.subtract(W,S,[]),Z));W=d.add(W,d.scale(V,X,[]),[]);S=d.add(S,d.scale(Z,X,[]),[]);w.push([W,S])}F=w[0][0];I=w[0][1];I=d.subtract(F,I,[]);d.add(F,I,t);F=w[w.length-1][1];I=w[w.length-1][0];I=d.subtract(F,I,
[]);d.add(F,I,B)}w=new x.Atom("",t[0],t[1],t[2]);F=new x.Atom("",B[0],B[1],B[2]);this.helixCylinders.push(new f(w,F));w=[];F=d.subtract(t,B,[]);d.normalize(F);d.scale(F,.5);0<y.length&&(I=d.add(t,F,[]),L=y[y.length-1].cp1,L=d.subtract([L.x,L.y,L.z],I,[]),d.normalize(L),d.scale(L,.5),d.add(I,L),L=new x.Residue(-1),L.cp1=L.cp2=new x.Atom("",I[0],I[1],I[2]),y.push(L),L=a(t[0],t[1],t[2]),y.push(L),r.push(y));y=[];G<b&&(t=a(B[0],B[1],B[2]),y.push(t),t=q[G+1],t.sheet?(y.push(g),y.push(g),r.push(y),y=[],
A.push(g)):(d.scale(F,-1),g=d.add(B,F,[]),B=t.cp1,B=d.subtract([B.x,B.y,B.z],g,[]),d.normalize(B),d.scale(B,.5),d.add(g,B),g=a(g[0],g[1],g[2]),y.push(g)))}}else if(g.sheet){if(A.push(g),g.arrow){t=[0,0,0];F=[0,0,0];B=A.length;for(I=0;I<B;I++)O=A[I].guidePointsLarge,L=O[0],O=O[O.length-1],d.add(t,[L.x,L.y,L.z]),d.add(F,[O.x,O.y,O.z]);d.scale(t,1/B);d.scale(F,1/B);t=d.subtract(t,F);B=A[B-1].guidePointsSmall[0];this.sheetPlanks.push(new m(A[0].guidePointsSmall[0],B,t));A=[];G<b&&(q[G+1].sheet?A.push(g):
(g=a(B.x,B.y,B.z),y.push(g)))}}else y.push(g),G<b&&q[G+1].sheet&&(B=g.guidePointsSmall[0],B=a(B.x,B.y,B.z),y.push(B),r.push(y),y=[],A.push(g))}1<y.length&&(2==y.length&&y.push(y[y.length-1]),r.push(y));y=[];A=0;for(G=r.length;A<G;A++){b=r[A];g=[];B=0;for(t=b.length-1;B<=t;B++)g.push(b[B].cp1);y.push(g)}r=0;for(A=y.length;r<A;r++)G=new v.CatmullTube(y[r],l.proteins_tubeThickness,l.proteins_tubeResolution_3D,l.proteins_horizontalResolution),G.chainColor=q.chainColor,this.tubes.push(G)};(v.PipePlank.prototype=
new v._Mesh).render=function(q,l){q.material.setTempColors(q,l.proteins_materialAmbientColor_3D,c,l.proteins_materialSpecularColor_3D,l.proteins_materialShininess_3D);q.material.setDiffuseColor(q,l.macro_colorByChain?this.chainColor:l.proteins_tubeColor);for(var r=0,y=this.tubes.length;r<y;r++)q.shader.setMatrixUniforms(q),this.tubes[r].render(q,l);l.macro_colorByChain||q.material.setDiffuseColor(q,l.proteins_ribbonCartoonHelixSecondaryColor);q.cylinderClosedBuffer.bindBuffers(q);r=0;for(y=this.helixCylinders.length;r<
y;r++)this.helixCylinders[r].render(q,l);l.macro_colorByChain||q.material.setDiffuseColor(q,l.proteins_ribbonCartoonSheetColor);q.boxBuffer.bindBuffers(q);r=0;for(y=this.sheetPlanks.length;r<y;r++)this.sheetPlanks[r].render(q,l)}})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math);
(function(n,E){n.Quad=function(){this.storeData([-1,1,0,-1,-1,0,1,1,0,1,-1,0],[0,0,0,0,0,0,0,0,0,0,0,0])};n.Quad.prototype=new n._Mesh})(ChemDoodle.structures.d3);
(function(n,E,x,v){E.Shape=function(k,p){for(var d=k.length,e=[],c=[],a=new n.Point,f=0;f<d;f++){var m=f+1;f===d-1&&(m=0);var q=k[f],l=k[m];m=x.cross([0,0,1],[l.x-q.x,l.y-q.y,0]);for(var r=0;2>r;r++)e.push(q.x,q.y,p/2),e.push(q.x,q.y,-p/2),e.push(l.x,l.y,p/2),e.push(l.x,l.y,-p/2);for(l=0;4>l;l++)c.push(m[0],m[1],m[2]);c.push(0,0,1);c.push(0,0,-1);c.push(0,0,1);c.push(0,0,-1);a.add(q)}a.x/=d;a.y/=d;c.push(0,0,1);e.push(a.x,a.y,p/2);c.push(0,0,-1);e.push(a.x,a.y,-p/2);k=[];p=8*d;for(a=0;a<d;a++)f=8*
a,k.push(f),k.push(f+3),k.push(f+1),k.push(f),k.push(f+2),k.push(f+3),k.push(f+4),k.push(p),k.push(f+6),k.push(f+5),k.push(f+7),k.push(p+1);this.storeData(e,c,k)};E.Shape.prototype=new E._Mesh})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.lib.vec3);
(function(n,E,x,v){n.Star=function(){for(var k=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,
-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],p=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,
1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],e=[],c=[],a=0,f=p.length;a<f;a+=3){var m=3*p[a],q=3*p[a+1],l=3*p[a+2];m=[k[m],k[m+1],k[m+2]];q=[k[q],k[q+1],k[q+2]];l=[k[l],k[l+1],k[l+2]];var r=x.cross([l[0]-q[0],l[1]-q[1],l[2]-q[2]],[m[0]-q[0],m[1]-q[1],m[2]-q[2]],[]);x.normalize(r);d.push(m[0],m[1],m[2],q[0],q[1],q[2],l[0],l[1],l[2]);e.push(r[0],r[1],r[2],r[0],r[1],r[2],r[0],r[1],r[2]);c.push(a,a+1,a+2)}this.storeData(d,e,c)};n.Star.prototype=
new n._Mesh})(ChemDoodle.structures.d3,Math,ChemDoodle.lib.vec3);
(function(n,E,x,v,k){var p=1;v.devicePixelRatio&&(p=v.devicePixelRatio);n.TextImage=function(){this.ctx=x.createElement("canvas").getContext("2d");this.data=[];this.text="";this.charHeight=0};n=n.TextImage.prototype;n.init=function(d){this.textureImage=d.createTexture();d.bindTexture(d.TEXTURE_2D,this.textureImage);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,!1);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,
d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.bindTexture(d.TEXTURE_2D,null);this.updateFont(d,12,["Sans-serif"],!1,!1,!1)};n.charData=function(d){d=this.text.indexOf(d);return 0<=d?this.data[d]:null};n.updateFont=function(d,e,c,a,f,m){var q=this.ctx,l=this.ctx.canvas,r=[],y="";e*=p;c=E.getFontString(e,c,a,f);q.font=c;q.save();a=0;e*=1.5;for(f=32;127>f;f++){var w=String.fromCharCode(f),A=q.measureText(w).width;r.push({text:w,width:A,height:e});a+=2*
A}f=["\u00b0","\u212b","\u00ae"];w=0;for(A=f.length;w<A;w++){var G=f[w],b=q.measureText(G).width;r.push({text:G,width:b,height:e});a+=2*b}f=Math.ceil(Math.sqrt(a*e)/e);a=Math.ceil(a/(f-1));l.width=a;l.height=f*e;q.font=c;q.textAlign="left";q.textBaseline="middle";q.strokeStyle="#000";q.lineWidth=1.4;q.fillStyle="#fff";w=f=c=0;for(A=r.length;w<A;w++){G=r[w];b=2*G.width;var g=G.height,t=G.text;f+b>a&&(c++,f=0);var B=c*g;m&&q.strokeText(t,f,B+g/2);q.fillText(t,f,B+g/2);G.x=f;G.y=B;y+=t;f+=b}this.text=
y;this.data=r;this.charHeight=e;d.bindTexture(d.TEXTURE_2D,this.textureImage);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,l);d.bindTexture(d.TEXTURE_2D,null)};n.pushVertexData=function(d,e,c,a){var f=d.toString().split(""),m=this.getHeight(),q=this.getWidth();d=-this.textWidth(d)/2/p;for(var l=-this.charHeight/2/p,r=0,y=f.length;r<y;r++){var w=this.charData(f[r]),A=w.width,G=w.x/q,b=G+1.8*w.width/q,g=w.y/m;w=g+w.height/m;var t=d+1.8*A/p,B=this.charHeight/2/p;a.position.push(e[0],e[1],
e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2],e[0],e[1],e[2]);a.texCoord.push(G,g,b,w,b,g,G,g,G,w,b,w);a.translation.push(d,B,c,t,l,c,t,B,c,d,B,c,d,l,c,t,l,c);d=t+(A-1.8*A)/p}};n.getCanvas=function(){return this.ctx.canvas};n.getHeight=function(){return this.getCanvas().height};n.getWidth=function(){return this.getCanvas().width};n.textWidth=function(d){return this.ctx.measureText(d).width};n.test=function(){x.body.appendChild(this.getCanvas())};n.useTexture=function(d){d.bindTexture(d.TEXTURE_2D,
this.textureImage)}})(ChemDoodle.structures.d3,ChemDoodle.extensions,document,window);
(function(n,E,x){n.TextMesh=function(){};n=n.TextMesh.prototype;n.init=function(v){this.vertexPositionBuffer=v.createBuffer();this.vertexTexCoordBuffer=v.createBuffer();this.vertexTranslationBuffer=v.createBuffer()};n.setVertexData=function(v,k,p,d){v.bindBuffer(v.ARRAY_BUFFER,k);v.bufferData(v.ARRAY_BUFFER,new Float32Array(p),v.STATIC_DRAW);k.itemSize=d;k.numItems=p.length/d};n.storeData=function(v,k,p,d){this.setVertexData(v,this.vertexPositionBuffer,k,3);this.setVertexData(v,this.vertexTexCoordBuffer,
p,2);this.setVertexData(v,this.vertexTranslationBuffer,d,3)};n.bindBuffers=function(v){v.bindBuffer(v.ARRAY_BUFFER,this.vertexPositionBuffer);v.vertexAttribPointer(v.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,v.FLOAT,!1,0,0);v.bindBuffer(v.ARRAY_BUFFER,this.vertexTexCoordBuffer);v.vertexAttribPointer(v.shader.vertexTexCoordAttribute,this.vertexTexCoordBuffer.itemSize,v.FLOAT,!1,0,0);v.bindBuffer(v.ARRAY_BUFFER,this.vertexTranslationBuffer);v.vertexAttribPointer(v.shader.vertexNormalAttribute,
this.vertexTranslationBuffer.itemSize,v.FLOAT,!1,0,0)};n.render=function(v){var k=this.vertexPositionBuffer.numItems;k&&(this.bindBuffers(v),v.drawArrays(v.TRIANGLES,0,k))}})(ChemDoodle.structures.d3,Math);
(function(n,E,x,v,k,p,d){x.Torsion=function(e,c,a,f){this.a1=e;this.a2=c;this.a3=a;this.a4=f};n=x.Torsion.prototype=new x._Measurement;n.calculateData=function(e){var c=[],a=[],f=[],m=this.a2.distance3D(this.a1),q=this.a2.distance3D(this.a3);this.distUse=v.min(m,q)/2;q=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];m=[this.a3.x-this.a2.x,this.a3.y-this.a2.y,this.a3.z-this.a2.z];var l=[this.a4.x-this.a3.x,this.a4.y-this.a3.y,this.a4.z-this.a3.z],r=p.cross(q,m,[]);l=p.cross(m,l,[]);p.scale(q,
p.length(m));this.torsion=v.atan2(p.dot(q,l),p.dot(r,l));r=p.normalize(p.cross(r,m,[]));q=p.normalize(p.cross(m,r,[]));this.pos=p.add([this.a2.x,this.a2.y,this.a2.z],p.scale(p.normalize(m,[]),this.distUse));l=[];var y=e.measurement_angleBands_3D,w=d;for(e=0;e<=y;++e){var A=this.torsion*e/y;w=p.scale(r,v.cos(A),[]);A=p.scale(q,v.sin(A),[]);w=p.scale(p.normalize(p.add(w,A,[])),this.distUse);0==e&&(l=w);c.push(this.pos[0]+w[0],this.pos[1]+w[1],this.pos[2]+w[2]);a.push(0,0,0);e<y&&f.push(e,e+1)}this.vecText=
p.normalize(p.add(l,w,[]));m=p.normalize(m,[]);p.scale(m,.0625);l=this.torsion-2*v.asin(.125)*this.torsion/v.abs(this.torsion);r=p.scale(r,v.cos(l),[]);q=p.scale(q,v.sin(l),[]);w=p.scale(p.normalize(p.add(r,q,[])),this.distUse);c.push(this.pos[0]+m[0]+w[0],this.pos[1]+m[1]+w[1],this.pos[2]+m[2]+w[2]);a.push(0,0,0);c.push(this.pos[0]-m[0]+w[0],this.pos[1]-m[1]+w[1],this.pos[2]-m[2]+w[2]);a.push(0,0,0);f.push(--e,e+1,e,e+2);this.storeData(c,a,f)};n.getText=function(e){p.add(this.pos,p.scale(this.vecText,
this.distUse+.3,[]));return{pos:this.pos,value:[E.angleBounds(this.torsion,!0,!0).toFixed(2)," \u00b0"].join("")}}})(ChemDoodle.ELEMENT,ChemDoodle.math,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,x,v,k,p,d,e,c){var a=function(m,q){m.bindBuffer(m.ARRAY_BUFFER,q.vertexPositionBuffer);m.vertexAttribPointer(m.shader.vertexPositionAttribute,q.vertexPositionBuffer.itemSize,m.FLOAT,!1,0,0);m.bindBuffer(m.ARRAY_BUFFER,q.vertexNormalBuffer);m.vertexAttribPointer(m.shader.vertexNormalAttribute,q.vertexNormalBuffer.itemSize,m.FLOAT,!1,0,0);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,q.vertexIndexBuffer)},f=function(m,q,l){var r=k.sqrt(q[1]*q[1]+q[2]*q[2]),y=[1,0,0,0,0,q[2]/r,-q[1]/r,0,0,q[1]/r,
q[2]/r,0,0,0,0,1],w=[1,0,0,0,0,q[2]/r,q[1]/r,0,0,-q[1]/r,q[2]/r,0,0,0,0,1],A=[r,0,-q[0],0,0,1,0,0,q[0],0,r,0,0,0,0,1];q=[r,0,q[0],0,0,1,0,0,-q[0],0,r,0,0,0,0,1];l=[k.cos(l),-k.sin(l),0,0,k.sin(l),k.cos(l),0,0,0,0,1,0,0,0,0,1];var G=p.multiply(y,p.multiply(A,p.multiply(l,p.multiply(q,w,[]))));this.rotate=function(){return p.multiplyVec3(G,m)}};v.Tube=function(m,q,l){var r=m[0].lineSegments[0].length;this.partitions=[];this.ends=[];this.ends.push(m[0].lineSegments[0][0]);this.ends.push(m[m.length-1].lineSegments[0][0]);
for(var y=[1,0,0],w=0,A=m.length;w<A;w++){if(!G||65E3<G.positionData.length){0<this.partitions.length&&w--;var G={count:0,positionData:[],normalData:[],indexData:[]};this.partitions.push(G)}var b=m[w];G.count++;for(var g=Infinity,t=new x.Atom("",m[w].cp1.x,m[w].cp1.y,m[w].cp1.z),B=0;B<r;B++){var F=b.lineSegments[0][B],I=void 0;I=B===r-1?w===m.length-1?b.lineSegments[0][B-1]:m[w+1].lineSegments[0][0]:b.lineSegments[0][B+1];I=[I.x-F.x,I.y-F.y,I.z-F.z];d.normalize(I);w===m.length-1&&B===r-1&&d.scale(I,
-1);var L=d.cross(I,y,[]);d.normalize(L);d.scale(L,q/2);I=new f(L,I,2*Math.PI/l);L=0;for(var O=l;L<O;L++){var S=I.rotate();L===k.floor(l/4)&&(y=[S[0],S[1],S[2]]);G.normalData.push(S[0],S[1],S[2]);G.positionData.push(F.x+S[0],F.y+S[1],F.z+S[2])}t&&(I=F.distance3D(t),I<g&&(g=I,m[w].pPoint=F))}}G=0;for(y=this.partitions.length;G<y;G++)for(w=this.partitions[G],A=0,b=w.count-1;A<b;A++)for(g=A*r*l,t=0,B=r;t<B;t++)for(F=g+t*l,I=0;I<l;I++)L=F+I,w.indexData.push(L),w.indexData.push(L+l),w.indexData.push(L+
l+1),w.indexData.push(L),w.indexData.push(L+l+1),w.indexData.push(L+1);this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);l=[new x.Point(2,0)];for(r=0;60>r;r++)G=r/60*k.PI,l.push(new x.Point(2*k.cos(G),-2*k.sin(G)));l.push(new x.Point(-2,0),new x.Point(-2,4),new x.Point(2,4));var W=new x.d3.Shape(l,1);this.render=function(V,Z){this.bindBuffers(V);V.material.setDiffuseColor(V,Z.macro_colorByChain?this.chainColor:Z.nucleics_tubeColor);V.drawElements(V.TRIANGLES,
this.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,0);if(this.partitions)for(var ba=1,X=this.partitions.length;ba<X;ba++){var ea=this.partitions[ba];a(V,ea);V.drawElements(V.TRIANGLES,ea.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,0)}V.sphereBuffer.bindBuffers(V);for(ba=0;2>ba;ba++)X=this.ends[ba],X=p.translate(p.identity(),[X.x,X.y,X.z]),ea=q/2,p.scale(X,[ea,ea,ea]),V.shader.setMatrixUniforms(V,X),V.drawElements(V.TRIANGLES,V.sphereBuffer.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,0);V.cylinderBuffer.bindBuffers(V);
ba=0;for(X=m.length-1;ba<X;ba++){var Y=m[ba];ea=Y.pPoint;Y=new x.Atom("",Y.cp2.x,Y.cp2.y,Y.cp2.z);var aa=1.001*ea.distance3D(Y);aa=[q/4,aa,q/4];var da=p.translate(p.identity(),[ea.x,ea.y,ea.z]),ia=[0,1,0],ja=0,la=[Y.x-ea.x,Y.y-ea.y,Y.z-ea.z];ea.x===Y.x&&ea.z===Y.z?(Y=[0,0,1],ea.y<ea.y&&(ja=k.PI)):(ja=n.vec3AngleFrom(ia,la),Y=d.cross(ia,la,[]));0!==ja&&p.rotate(da,ja,Y);p.scale(da,aa);V.shader.setMatrixUniforms(V,da);V.drawArrays(V.TRIANGLE_STRIP,0,V.cylinderBuffer.vertexPositionBuffer.numItems)}W.bindBuffers(V);
"none"!==Z.nucleics_residueColor||Z.macro_colorByChain||V.material.setDiffuseColor(V,Z.nucleics_baseColor);ba=0;for(X=m.length-1;ba<X;ba++)if(ea=m[ba],da=ea.cp2,Y=p.translate(p.identity(),[da.x,da.y,da.z]),ia=[0,1,0],ja=0,la=ea.cp3){aa=[la.x-da.x,la.y-da.y,la.z-da.z];da.x===la.x&&da.z===la.z?(ia=[0,0,1],da.y<da.y&&(ja=k.PI)):(ja=n.vec3AngleFrom(ia,aa),ia=d.cross(ia,aa,[]));0!==ja&&p.rotate(Y,ja,ia);da=[1,0,0];ja=p.rotate(p.identity([]),ja,ia);p.multiplyVec3(ja,da);ja=ea.cp4;ia=ea.cp5;if(ja.y!==ia.y||
ja.z!==ia.z)ja=[ia.x-ja.x,ia.y-ja.y,ia.z-ja.z],ia=n.vec3AngleFrom(da,ja),0>d.dot(aa,d.cross(da,ja))&&(ia*=-1),p.rotateY(Y,ia);Z.macro_colorByChain||("shapely"===Z.nucleics_residueColor?E[ea.name]?V.material.setDiffuseColor(V,E[ea.name].shapelyColor):V.material.setDiffuseColor(V,E["*"].shapelyColor):"rainbow"===Z.nucleics_residueColor&&V.material.setDiffuseColor(V,e.rainbowAt(ba,X,Z.macro_rainbowColors)));V.shader.setMatrixUniforms(V,Y);V.drawElements(V.TRIANGLES,W.vertexIndexBuffer.numItems,V.UNSIGNED_SHORT,
0)}}};v.Tube.prototype=new v._Mesh;v.CatmullTube=function(m,q,l,r){var y=[];m.push(m[m.length-1]);for(var w=0,A=m.length-2;w<=A;w++){for(var G=m[0==w?0:w-1],b=m[w+0],g=m[w+1],t=m[w==A?w+1:w+2],B=[],F=0;F<r;F++){var I=F/r;w==A&&(I=F/(r-1));I=new x.Atom("C",.5*(2*b.x+(g.x-G.x)*I+(2*G.x-5*b.x+4*g.x-t.x)*I*I+(3*b.x-G.x-3*g.x+t.x)*I*I*I),.5*(2*b.y+(g.y-G.y)*I+(2*G.y-5*b.y+4*g.y-t.y)*I*I+(3*b.y-G.y-3*g.y+t.y)*I*I*I),.5*(2*b.z+(g.z-G.z)*I+(2*G.z-5*b.z+4*g.z-t.z)*I*I+(3*b.z-G.z-3*g.z+t.z)*I*I*I));B.push(I)}y.push(B)}m=
y[0].length;this.partitions=[];this.ends=[];this.ends.push(y[0][0]);this.ends.push(y[y.length-1][0]);r=[1,0,0];w=0;for(A=y.length;w<A;w++){if(!L||65E3<L.positionData.length){0<this.partitions.length&&w--;var L={count:0,positionData:[],normalData:[],indexData:[]};this.partitions.push(L)}G=y[w];L.count++;for(b=0;b<m;b++)for(g=G[b],t=b===m-1?w===y.length-1?G[b-1]:y[w+1][0]:G[b+1],t=[t.x-g.x,t.y-g.y,t.z-g.z],d.normalize(t),w===y.length-1&&b===m-1&&d.scale(t,-1),B=d.cross(t,r,[]),d.normalize(B),d.scale(B,
q/2),t=new f(B,t,2*Math.PI/l),B=0,F=l;B<F;B++)I=t.rotate(),B===k.floor(l/4)&&(r=[I[0],I[1],I[2]]),L.normalData.push(I[0],I[1],I[2]),L.positionData.push(g.x+I[0],g.y+I[1],g.z+I[2])}q=0;for(y=this.partitions.length;q<y;q++)for(L=this.partitions[q],r=0,w=L.count-1;r<w;r++)for(A=r*m*l,G=0,b=m;G<b;G++)for(g=A+G*l,t=0;t<=l;t++)B=g+t%l,L.indexData.push(B,B+l);this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData)};(v.CatmullTube.prototype=new v._Mesh).render=
function(m,q){this.bindBuffers(m);for(var l=0,r=this.partitions.length;l<r;l++){var y=this.partitions[l];a(m,y);m.drawElements(m.TRIANGLE_STRIP,y.vertexIndexBuffer.numItems,m.UNSIGNED_SHORT,0)}m.sphereBuffer.bindBuffers(m);for(l=0;2>l;l++)r=this.ends[l],r=p.translate(p.identity(),[r.x,r.y,r.z]),y=q.proteins_tubeThickness/2,p.scale(r,[y,y,y]),m.shader.setMatrixUniforms(m,r),m.drawElements(m.TRIANGLES,m.sphereBuffer.vertexIndexBuffer.numItems,m.UNSIGNED_SHORT,0)}})(ChemDoodle.extensions,ChemDoodle.RESIDUE,
ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3,ChemDoodle.math);
(function(n,E,x,v,k){n.UnitCell=function(p,d,e){this.lengths=p;this.angles=d;this.offset=e;p=E.CIFInterpreter.generateABC2XYZ(p[0],p[1],p[2],d[0],d[1],d[2]);e||(this.offset=[0,0,0]);this.unitCellVectors={o:x.multiplyVec3(p,this.offset,[]),x:x.multiplyVec3(p,[this.offset[0]+1,this.offset[1],this.offset[2]]),y:x.multiplyVec3(p,[this.offset[0],this.offset[1]+1,this.offset[2]]),z:x.multiplyVec3(p,[this.offset[0],this.offset[1],this.offset[2]+1]),xy:x.multiplyVec3(p,[this.offset[0]+1,this.offset[1]+1,
this.offset[2]]),xz:x.multiplyVec3(p,[this.offset[0]+1,this.offset[1],this.offset[2]+1]),yz:x.multiplyVec3(p,[this.offset[0],this.offset[1]+1,this.offset[2]+1]),xyz:x.multiplyVec3(p,[this.offset[0]+1,this.offset[1]+1,this.offset[2]+1])};var c=[],a=[];e=function(f,m,q,l){c.push(f[0],f[1],f[2]);c.push(m[0],m[1],m[2]);c.push(q[0],q[1],q[2]);c.push(l[0],l[1],l[2]);for(f=0;4>f;f++)a.push(0,0,0)};e(this.unitCellVectors.o,this.unitCellVectors.x,this.unitCellVectors.xy,this.unitCellVectors.y);e(this.unitCellVectors.o,
this.unitCellVectors.y,this.unitCellVectors.yz,this.unitCellVectors.z);e(this.unitCellVectors.o,this.unitCellVectors.z,this.unitCellVectors.xz,this.unitCellVectors.x);e(this.unitCellVectors.yz,this.unitCellVectors.y,this.unitCellVectors.xy,this.unitCellVectors.xyz);e(this.unitCellVectors.xyz,this.unitCellVectors.xz,this.unitCellVectors.z,this.unitCellVectors.yz);e(this.unitCellVectors.xy,this.unitCellVectors.x,this.unitCellVectors.xz,this.unitCellVectors.xyz);e=[];for(p=0;6>p;p++)d=4*p,e.push(d,d+
1,d+1,d+2,d+2,d+3,d+3,d);this.storeData(c,a,e)};(n.UnitCell.prototype=new n._Mesh).render=function(p,d){p.shader.setMatrixUniforms(p);this.bindBuffers(p);p.material.setDiffuseColor(p,d.shapes_color);p.lineWidth(d.shapes_lineWidth);p.drawElements(p.LINES,this.vertexIndexBuffer.numItems,p.UNSIGNED_SHORT,0)}})(ChemDoodle.structures.d3,ChemDoodle.io,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,x,v){n.Framebuffer=function(){};n=n.Framebuffer.prototype;n.init=function(k){this.framebuffer=k.createFramebuffer()};n.setColorTexture=function(k,p,d){d=d===v?0:d;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);k.bindTexture(k.TEXTURE_2D,p);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0+d,k.TEXTURE_2D,p,0);k.bindTexture(k.TEXTURE_2D,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setColorRenderbuffer=function(k,p,d){d=d===v?0:d;k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);
k.bindRenderbuffer(k.RENDERBUFFER,p);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0+d,k.RENDERBUFFER,p);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setDepthTexture=function(k,p){k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);k.bindTexture(k.TEXTURE_2D,p);k.framebufferTexture2D(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.TEXTURE_2D,p,0);k.bindTexture(k.TEXTURE_2D,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.setDepthRenderbuffer=function(k,p){k.bindFramebuffer(k.FRAMEBUFFER,
this.framebuffer);k.bindRenderbuffer(k.RENDERBUFFER,p);k.framebufferRenderbuffer(k.FRAMEBUFFER,k.DEPTH_ATTACHMENT,k.RENDERBUFFER,p);k.bindRenderbuffer(k.RENDERBUFFER,null);k.bindFramebuffer(k.FRAMEBUFFER,null)};n.bind=function(k,p,d){k.bindFramebuffer(k.FRAMEBUFFER,this.framebuffer);k.viewport(0,0,p,d)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,x,v){n.Renderbuffer=function(){};n=n.Renderbuffer.prototype;n.init=function(k,p){this.renderbuffer=k.createRenderbuffer();this.format=p};n.setParameter=function(k,p,d){this.width=p;this.height=d;k.bindRenderbuffer(k.RENDERBUFFER,this.renderbuffer);k.renderbufferStorage(k.RENDERBUFFER,this.format,this.width,this.height);k.bindRenderbuffer(k.RENDERBUFFER,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,x,v){E.SSAO=function(){};n=E.SSAO.prototype;n.initSampleKernel=function(k){for(var p=[],d=0;d<k;d++){var e=2*x.random()-1,c=2*x.random()-1,a=2*x.random()-1,f=d/k;f=.1+f*f*.9;e*=f;c*=f;a*=f;p.push(e,c,a)}this.sampleKernel=new Float32Array(p)};n.initNoiseTexture=function(k){for(var p=[],d=0;16>d;d++)p.push(2*x.random()-1),p.push(2*x.random()-1),p.push(0);this.noiseTexture=k.createTexture();k.bindTexture(k.TEXTURE_2D,this.noiseTexture);k.texImage2D(k.TEXTURE_2D,0,k.RGB,4,4,0,k.RGB,k.FLOAT,
new Float32Array(p));k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.REPEAT);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.REPEAT);k.bindTexture(k.TEXTURE_2D,null)}})(ChemDoodle.math,ChemDoodle.structures.d3,Math);
(function(n,E,x,v){n.Texture=function(){};n=n.Texture.prototype;n.init=function(k,p,d,e){this.texture=k.createTexture();this.type=p;this.internalFormat=d;this.format=e!==v?e:d;k.bindTexture(k.TEXTURE_2D,this.texture);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MAG_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_MIN_FILTER,k.NEAREST);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE);k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE);k.bindTexture(k.TEXTURE_2D,null)};n.setParameter=
function(k,p,d){this.width=p;this.height=d;k.bindTexture(k.TEXTURE_2D,this.texture);k.texImage2D(k.TEXTURE_2D,0,this.internalFormat,this.width,this.height,0,this.format,this.type,null);k.bindTexture(k.TEXTURE_2D,null)}})(ChemDoodle.structures.d3,ChemDoodle.math,document);
(function(n,E,x,v,k){n._Shader=function(){};n=n._Shader.prototype;n.useShaderProgram=function(p){p.useProgram(this.gProgram);p.shader=this};n.init=function(p){var d=this.getShader(p,"vertex-shader");d||(d=this.loadDefaultVertexShader(p));var e=this.getShader(p,"fragment-shader");e||(e=this.loadDefaultFragmentShader(p));this.gProgram=p.createProgram();p.attachShader(this.gProgram,d);p.attachShader(this.gProgram,e);this.onShaderAttached(p);p.linkProgram(this.gProgram);p.getProgramParameter(this.gProgram,
p.LINK_STATUS)||alert("Could not initialize shaders: "+p.getProgramInfoLog(this.gProgram));p.useProgram(this.gProgram);this.initUniformLocations(p);p.useProgram(null)};n.onShaderAttached=function(p){this.vertexPositionAttribute=0;this.vertexNormalAttribute=1;p.bindAttribLocation(this.gProgram,this.vertexPositionAttribute,"a_vertex_position");p.bindAttribLocation(this.gProgram,this.vertexNormalAttribute,"a_vertex_normal")};n.getShaderFromStr=function(p,d,e){d=p.createShader(d);p.shaderSource(d,e);
p.compileShader(d);return p.getShaderParameter(d,p.COMPILE_STATUS)?d:(alert(shaderScript.type+" "+p.getShaderInfoLog(d)),p.deleteShader(d),k)};n.enableAttribsArray=function(p){p.enableVertexAttribArray(this.vertexPositionAttribute)};n.disableAttribsArray=function(p){p.disableVertexAttribArray(this.vertexPositionAttribute)};n.getShader=function(p,d){d=v.getElementById(d);if(!d)return k;for(var e=[],c=d.firstChild;c;)3===c.nodeType&&e.push(c.textContent),c=c.nextSibling;e=e.join("");if("x-shader/x-fragment"===
d.type)p=this.getShaderFromStr(p,p.FRAGMENT_SHADER,e);else if("x-shader/x-vertex"===d.type)p=this.getShaderFromStr(p,p.VERTEX_SHADER,e);else return k;return p};n.initUniformLocations=function(p){this.modelViewMatrixUniform=p.getUniformLocation(this.gProgram,"u_model_view_matrix");this.projectionMatrixUniform=p.getUniformLocation(this.gProgram,"u_projection_matrix")};n.loadDefaultVertexShader=function(p){};n.loadDefaultFragmentShader=function(p){};n.setMatrixUniforms=function(p,d){d===k?this.setModelViewMatrix(p,
p.modelViewMatrix):this.setModelViewMatrix(p,x.multiply(p.modelViewMatrix,d,[]))};n.setProjectionMatrix=function(p,d){p.uniformMatrix4fv(this.projectionMatrixUniform,!1,d)};n.setModelViewMatrix=function(p,d){p.uniformMatrix4fv(this.modelViewMatrixUniform,!1,d)};n.setMaterialAmbientColor=function(p,d){};n.setMaterialDiffuseColor=function(p,d){};n.setMaterialSpecularColor=function(p,d){};n.setMaterialShininess=function(p,d){};n.setMaterialAlpha=function(p,d){}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,
ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.FXAAShader=function(){};var p=n._Shader.prototype;n=n.FXAAShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.buffersizeUniform=d.getUniformLocation(this.gProgram,"u_buffersize");this.antialiasUniform=d.getUniformLocation(this.gProgram,"u_antialias");this.edgeThresholdUniform=d.getUniformLocation(this.gProgram,"u_edge_threshold");this.edgeThresholdMinUniform=d.getUniformLocation(this.gProgram,"u_edge_threshold_min");this.searchStepsUniform=
d.getUniformLocation(this.gProgram,"u_search_steps");this.searchThresholdUniform=d.getUniformLocation(this.gProgram,"u_search_threshold");this.subpixCapUniform=d.getUniformLocation(this.gProgram,"u_subpix_cap");this.subpixTrimUniform=d.getUniformLocation(this.gProgram,"u_subpix_trim")};n.setBuffersize=function(d,e,c){d.uniform2f(this.buffersizeUniform,e,c)};n.setAntialias=function(d,e){d.uniform1f(this.antialiasUniform,e)};n.setEdgeThreshold=function(d,e){d.uniform1f(this.edgeThresholdUniform,e)};
n.setEdgeThresholdMin=function(d,e){d.uniform1f(this.edgeThresholdMinUniform,e)};n.setSearchSteps=function(d,e){d.uniform1i(this.searchStepsUniform,e)};n.setSearchThreshold=function(d,e){d.uniform1f(this.searchThresholdUniform,e)};n.setSubpixCap=function(d,e){d.uniform1f(this.subpixCapUniform,e)};n.setSubpixTrim=function(d,e){d.uniform1f(this.subpixTrimUniform,e)};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};
n.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"precision mediump float;\nconst int fxaaMaxSearchSteps = 128;\nuniform float u_edge_threshold;\nuniform float u_edge_threshold_min;\nuniform int u_search_steps;\nuniform float u_search_threshold;\nuniform float u_subpix_cap;\nuniform float u_subpix_trim;\nuniform sampler2D u_sampler0;\nuniform vec2 u_buffersize;\nuniform bool u_antialias;\nvarying vec2 v_texcoord;\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x;\n}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 off, vec2 rcpFrame) {\nreturn texture2D(tex, pos + off * rcpFrame);\n}\nvec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame) {\nfloat subpix_trim_scale = (1.0/(1.0 - u_subpix_trim));\nvec3 rgbN = FxaaTexOff(tex, pos.xy, vec2( 0.,-1.), rcpFrame).xyz;\nvec3 rgbW = FxaaTexOff(tex, pos.xy, vec2(-1., 0.), rcpFrame).xyz;\nvec3 rgbM = FxaaTexOff(tex, pos.xy, vec2( 0., 0.), rcpFrame).xyz;\nvec3 rgbE = FxaaTexOff(tex, pos.xy, vec2( 1., 0.), rcpFrame).xyz;\nvec3 rgbS = FxaaTexOff(tex, pos.xy, vec2( 0., 1.), rcpFrame).xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaM = FxaaLuma(rgbM);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaS = FxaaLuma(rgbS);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(u_edge_threshold_min, rangeMax * u_edge_threshold)) {\nreturn rgbM;\n}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - u_subpix_trim) * subpix_trim_scale;\nblendL = min(u_subpix_cap, blendL);\nvec3 rgbNW = FxaaTexOff(tex, pos.xy, vec2(-1.,-1.), rcpFrame).xyz;\nvec3 rgbNE = FxaaTexOff(tex, pos.xy, vec2( 1.,-1.), rcpFrame).xyz;\nvec3 rgbSW = FxaaTexOff(tex, pos.xy, vec2(-1., 1.), rcpFrame).xyz;\nvec3 rgbSE = FxaaTexOff(tex, pos.xy, vec2( 1., 1.), rcpFrame).xyz;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma(rgbNW);\nfloat lumaNE = FxaaLuma(rgbNE);\nfloat lumaSW = FxaaLuma(rgbSW);\nfloat lumaSE = FxaaLuma(rgbSE);\nfloat edgeVert =\nabs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz =\nabs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -rcpFrame.y : -rcpFrame.x;\nif(!horzSpan) {\nlumaN = lumaW;\nlumaS = lumaE;\n}\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nif (gradientN < gradientS) {\nlumaN = lumaS;\nlumaN = lumaS;\ngradientN = gradientS;\nlengthSign *= -1.0;\n}\nvec2 posN;\nposN.x = pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= u_search_threshold;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < fxaaMaxSearchSteps; i++) {\nif(i >= u_search_steps) break;\nif(!doneN) {\nlumaEndN = FxaaLuma(texture2D(tex, posN.xy).xyz);\n}\nif(!doneP) {\nlumaEndP = FxaaLuma(texture2D(tex, posP.xy).xyz);\n}\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP) {\nbreak;\n}\nif(!doneN) {\nposN -= offNP;\n}\nif(!doneP) {\nposP += offNP;\n}\n}\nfloat dstN = horzSpan ? pos.x - posN.x : pos.y - posN.y;\nfloat dstP = horzSpan ? posP.x - pos.x : posP.y - pos.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0)) {\nlengthSign = 0.0;\n}\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = texture2D(tex, vec2(\npos.x + (horzSpan ? 0.0 : subPixelOffset),\npos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\nreturn FxaaLerp3(rgbL, rgbF, blendL);\n}\nvoid main() {\ngl_FragColor = texture2D(u_sampler0, v_texcoord);\nif(u_antialias) {\ngl_FragColor.xyz = FxaaPixelShader(v_texcoord, u_sampler0, 1. / u_buffersize).xyz;\n}\n}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.LabelShader=function(){};var p=n._Shader.prototype;n=n.LabelShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.dimensionUniform=d.getUniformLocation(this.gProgram,"u_dimension")};n.onShaderAttached=function(d){p.onShaderAttached.call(this,d);this.vertexTexCoordAttribute=2;d.bindAttribLocation(this.gProgram,this.vertexTexCoordAttribute,"a_vertex_texcoord")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,
d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;attribute vec2 a_vertex_texcoord;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform vec2 u_dimension;varying vec2 v_texcoord;void main() {gl_Position = u_model_view_matrix * vec4(a_vertex_position, 1.);vec4 depth_pos = vec4(gl_Position);depth_pos.z += a_vertex_normal.z;gl_Position = u_projection_matrix * gl_Position;depth_pos = u_projection_matrix * depth_pos;gl_Position /= gl_Position.w;gl_Position.xy += a_vertex_normal.xy / u_dimension * 2.;gl_Position.z = depth_pos.z / depth_pos.w;v_texcoord = a_vertex_texcoord;}")};
n.loadDefaultFragmentShader=function(d){var e=[d.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;uniform sampler2D u_image;varying vec2 v_texcoord;void main(void) {gl_FragColor = texture2D(u_image, v_texcoord);}"].join("");return this.getShaderFromStr(d,d.FRAGMENT_SHADER,e)};n.enableAttribsArray=function(d){p.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute);d.enableVertexAttribArray(this.vertexTexCoordAttribute)};n.disableAttribsArray=function(d){p.disableAttribsArray.call(this,
d);d.disableVertexAttribArray(this.vertexNormalAttribute);d.disableVertexAttribArray(this.vertexTexCoordAttribute)};n.setDimension=function(d,e,c){d.uniform2f(this.dimensionUniform,e,c)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.LightingShader=function(){};var p=n._Shader.prototype;n=n.LightingShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.positionSampleUniform=d.getUniformLocation(this.gProgram,"u_position_sample");this.colorSampleUniform=d.getUniformLocation(this.gProgram,"u_color_sample");this.ssaoSampleUniform=d.getUniformLocation(this.gProgram,"u_ssao_sample");this.outlineSampleUniform=d.getUniformLocation(this.gProgram,"u_outline_sample")};
n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};n.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"precision mediump float;uniform sampler2D u_position_sample;uniform sampler2D u_color_sample;uniform sampler2D u_ssao_sample;uniform sampler2D u_outline_sample;varying vec2 v_texcoord;void main() {vec4 position = texture2D(u_position_sample, v_texcoord);vec4 color = texture2D(u_color_sample, v_texcoord);vec4 ao = texture2D(u_ssao_sample, v_texcoord);float outline = texture2D(u_outline_sample, v_texcoord).r;if(position.w == 0. && outline == 1.) {return;}gl_FragColor = vec4(color.rgb * ao.r * outline, 1.);}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.NormalShader=function(){};var p=n._Shader.prototype;n=n.NormalShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.normalMatrixUniform=d.getUniformLocation(this.gProgram,"u_normal_matrix")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;varying vec3 v_normal;void main() {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);}")};n.loadDefaultFragmentShader=
function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,"precision mediump float;varying vec3 v_normal;void main(void) {vec3 normal = length(v_normal)==0. ? vec3(0., 0., 1.) : normalize(v_normal);gl_FragColor = vec4(normal, 0.);}")};n.enableAttribsArray=function(d){p.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute)};n.disableAttribsArray=function(d){p.disableAttribsArray.call(this,d);d.disableVertexAttribArray(this.vertexNormalAttribute)};n.setModelViewMatrix=
function(d,e){p.setModelViewMatrix.call(this,d,e);e=E.transpose(x.toInverseMat3(e,[]));d.uniformMatrix3fv(this.normalMatrixUniform,!1,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.OutlineShader=function(){};var p=n._Shader.prototype;n=n.OutlineShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.normalSampleUniform=d.getUniformLocation(this.gProgram,"u_normal_sample");this.depthSampleUniform=d.getUniformLocation(this.gProgram,"u_depth_sample");this.gbufferTextureSizeUniform=d.getUniformLocation(this.gProgram,"u_gbuffer_texture_size");this.normalThresholdUniform=d.getUniformLocation(this.gProgram,"u_normal_threshold");
this.depthThresholdUniform=d.getUniformLocation(this.gProgram,"u_depth_threshold");this.thicknessUniform=d.getUniformLocation(this.gProgram,"u_thickness")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};n.loadDefaultFragmentShader=function(d){return this.getShaderFromStr(d,d.FRAGMENT_SHADER,
"precision mediump float;uniform sampler2D u_normal_sample;uniform sampler2D u_depth_sample;uniform float u_normal_threshold;uniform float u_depth_threshold;uniform float u_thickness;uniform vec2 u_gbuffer_texture_size;varying vec2 v_texcoord;void main() {vec3 normal = texture2D(u_normal_sample, v_texcoord).xyz;float depth = texture2D(u_depth_sample, v_texcoord).r;vec2 texelSize = u_thickness/u_gbuffer_texture_size * .5;vec2 offsets[8];offsets[0] = vec2(-texelSize.x, -texelSize.y);offsets[1] = vec2(-texelSize.x, 0);offsets[2] = vec2(-texelSize.x, texelSize.y);offsets[3] = vec2(0, -texelSize.y);offsets[4] = vec2(0,  texelSize.y);offsets[5] = vec2(texelSize.x, -texelSize.y);offsets[6] = vec2(texelSize.x, 0);offsets[7] = vec2(texelSize.x, texelSize.y);float edge = 0.;for (int i = 0; i < 8; i++) {vec3 sampleNorm = texture2D(u_normal_sample, v_texcoord + offsets[i]).xyz;if(normal == vec3(.0, .0, .0)) {if(sampleNorm != vec3(.0, .0, .0)) {edge = 1.0;break;}continue;}if (dot(sampleNorm, normal) < u_normal_threshold) {edge = 1.0;break;}float sampleDepth = texture2D(u_depth_sample, v_texcoord + offsets[i]).r;if (abs(sampleDepth - depth) > u_depth_threshold) {edge = 1.0;break;}}edge = 1. - edge;gl_FragColor = vec4(edge, edge, edge, 1.);}")};
n.setGbufferTextureSize=function(d,e,c){d.uniform2f(this.gbufferTextureSizeUniform,e,c)};n.setNormalThreshold=function(d,e){d.uniform1f(this.normalThresholdUniform,e)};n.setDepthThreshold=function(d,e){d.uniform1f(this.depthThresholdUniform,e)};n.setThickness=function(d,e){d.uniform1f(this.thicknessUniform,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.PhongShader=function(){};var p=n._Shader.prototype;n=n.PhongShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.shadowUniform=d.getUniformLocation(this.gProgram,"u_shadow");this.flatColorUniform=d.getUniformLocation(this.gProgram,"u_flat_color");this.normalMatrixUniform=d.getUniformLocation(this.gProgram,"u_normal_matrix");this.lightModelViewMatrixUniform=d.getUniformLocation(this.gProgram,"u_light_model_view_matrix");this.lightProjectionMatrixUniform=
d.getUniformLocation(this.gProgram,"u_light_projection_matrix");this.lightDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_light_diffuse_color");this.lightSpecularColorUniform=d.getUniformLocation(this.gProgram,"u_light_specular_color");this.lightDirectionUniform=d.getUniformLocation(this.gProgram,"u_light_direction");this.materialAmbientColorUniform=d.getUniformLocation(this.gProgram,"u_material_ambient_color");this.materialDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_material_diffuse_color");
this.materialSpecularColorUniform=d.getUniformLocation(this.gProgram,"u_material_specular_color");this.materialShininessUniform=d.getUniformLocation(this.gProgram,"u_material_shininess");this.materialAlphaUniform=d.getUniformLocation(this.gProgram,"u_material_alpha");this.fogModeUniform=d.getUniformLocation(this.gProgram,"u_fog_mode");this.fogColorUniform=d.getUniformLocation(this.gProgram,"u_fog_color");this.fogStartUniform=d.getUniformLocation(this.gProgram,"u_fog_start");this.fogEndUniform=d.getUniformLocation(this.gProgram,
"u_fog_end");this.fogDensityUniform=d.getUniformLocation(this.gProgram,"u_fog_density");this.shadowDepthSampleUniform=d.getUniformLocation(this.gProgram,"u_shadow_depth_sample");this.shadowTextureSizeUniform=d.getUniformLocation(this.gProgram,"u_shadow_texture_size");this.shadowIntensityUniform=d.getUniformLocation(this.gProgram,"u_shadow_intensity");this.gammaCorrectionUniform=d.getUniformLocation(this.gProgram,"u_gamma_inverted");this.pointSizeUniform=d.getUniformLocation(this.gProgram,"u_point_size")};
n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;attribute vec3 a_vertex_normal;uniform vec3 u_light_diffuse_color;uniform vec3 u_material_ambient_color;uniform vec3 u_material_diffuse_color;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;uniform mat3 u_normal_matrix;uniform mat4 u_light_model_view_matrix;uniform mat4 u_light_projection_matrix;uniform bool u_shadow;varying vec3 v_viewpos;varying vec4 v_shadcoord;varying vec3 v_diffuse;varying vec3 v_ambient;varying vec3 v_normal;uniform float u_point_size;void main() {v_normal = length(a_vertex_normal)==0. ? a_vertex_normal : u_normal_matrix * a_vertex_normal;v_ambient = u_material_ambient_color;v_diffuse = u_material_diffuse_color * u_light_diffuse_color;if(u_shadow) {v_shadcoord = u_light_projection_matrix * u_light_model_view_matrix * vec4(a_vertex_position, 1.);v_shadcoord /= v_shadcoord.w;}vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);v_viewpos = viewPos.xyz / viewPos.w;gl_Position = u_projection_matrix * viewPos;gl_Position /= gl_Position.w;gl_PointSize = u_point_size;}")};
n.loadDefaultFragmentShader=function(d){var e=[d.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;uniform vec3 u_light_specular_color;uniform vec3 u_light_direction;uniform vec3 u_material_specular_color;uniform float u_material_shininess;uniform float u_material_alpha;uniform int u_fog_mode;uniform vec3 u_fog_color;uniform float u_fog_density;uniform float u_fog_start;uniform float u_fog_end;uniform bool u_shadow;uniform float u_shadow_intensity;uniform bool u_flat_color;uniform float u_gamma_inverted;uniform sampler2D u_shadow_depth_sample;uniform vec2 u_shadow_texture_size;varying vec3 v_viewpos;varying vec4 v_shadcoord;varying vec3 v_diffuse;varying vec3 v_ambient;varying vec3 v_normal;\n#ifndef CWC_DEPTH_TEX\nfloat unpack (vec4 colour) {const vec4 bitShifts = vec4(1.,1. / 255.,1. / (255. * 255.),1. / (255. * 255. * 255.));return dot(colour, bitShifts);}\n#endif\nfloat shadowMapDepth(vec4 shadowMapColor) {float zShadowMap;\n#ifdef CWC_DEPTH_TEX\nzShadowMap = shadowMapColor.r;\n#else\nzShadowMap = unpack(shadowMapColor);\n#endif\nreturn zShadowMap;}void main(void) {vec3 color = v_diffuse;if(length(v_normal)!=0.){vec3 normal = normalize(v_normal);vec3 lightDir = normalize(-u_light_direction);float nDotL = dot(normal, lightDir);float shadow = 0.0;if(u_shadow) {vec3 depthCoord = .5 + v_shadcoord.xyz / v_shadcoord.w * .5;if(depthCoord.z <= 1. && depthCoord.z >= 0.) {float bias = max(.05 * (1. - nDotL), .005);vec2 texelSize = 1. / u_shadow_texture_size;for(int x = -1; x <= 1; ++x) {for(int y = -1; y <= 1; ++y)  {vec4 shadowMapColor = texture2D(u_shadow_depth_sample, depthCoord.xy + vec2(x, y) * texelSize);float zShadowMap = shadowMapDepth(shadowMapColor);shadow += zShadowMap + bias < depthCoord.z ? 1. : 0.;}}shadow /= 9.;shadow *= u_shadow_intensity;}}if(!u_flat_color) {vec3 viewDir = normalize(-v_viewpos);vec3 halfDir = normalize(lightDir + viewDir);float nDotHV = max(dot(halfDir, normal), 0.);vec3 specular = u_material_specular_color * u_light_specular_color;color*=max(nDotL, 0.);color+=specular * pow(nDotHV, u_material_shininess);}color = (1.-shadow)*color+v_ambient;}gl_FragColor = vec4(pow(color, vec3(u_gamma_inverted)), u_material_alpha);if(u_fog_mode != 0){float fogCoord = 1.-clamp((u_fog_end - gl_FragCoord.z/gl_FragCoord.w) / (u_fog_end - u_fog_start), 0., 1.);float fogFactor = 1.;if(u_fog_mode == 1){fogFactor = 1.-fogCoord;}else if(u_fog_mode == 2) {fogFactor = clamp(exp(-u_fog_density*fogCoord), 0., 1.);}else if(u_fog_mode == 3) {fogFactor = clamp(exp(-pow(u_fog_density*fogCoord, 2.)), 0., 1.);}gl_FragColor = mix(vec4(u_fog_color, 1.), gl_FragColor, fogFactor);}}"].join("");
return this.getShaderFromStr(d,d.FRAGMENT_SHADER,e)};n.enableAttribsArray=function(d){p.enableAttribsArray.call(this,d);d.enableVertexAttribArray(this.vertexNormalAttribute)};n.disableAttribsArray=function(d){p.disableAttribsArray.call(this,d);d.disableVertexAttribArray(this.vertexNormalAttribute)};n.setMatrixUniforms=function(d,e){if(e===k)this.setModelViewMatrix(d,d.modelViewMatrix),this.setLightModelViewMatrix(d,d.lightViewMatrix);else{var c=x.multiply(d.modelViewMatrix,e,[]);e=x.multiply(d.lightViewMatrix,
e,[]);this.setModelViewMatrix(d,c);this.setLightModelViewMatrix(d,e)}};n.setModelViewMatrix=function(d,e){p.setModelViewMatrix.call(this,d,e);e=E.transpose(x.toInverseMat3(e,[]));d.uniformMatrix3fv(this.normalMatrixUniform,!1,e)};n.setFlatColor=function(d,e){d.uniform1i(this.flatColorUniform,e)};n.setShadow=function(d,e){d.uniform1i(this.shadowUniform,e)};n.setFogMode=function(d,e){d.uniform1i(this.fogModeUniform,e)};n.setFogColor=function(d,e){d.uniform3fv(this.fogColorUniform,e)};n.setFogStart=
function(d,e){d.uniform1f(this.fogStartUniform,e)};n.setFogEnd=function(d,e){d.uniform1f(this.fogEndUniform,e)};n.setFogDensity=function(d,e){d.uniform1f(this.fogDensityUniform,e)};n.setMaterialAmbientColor=function(d,e){d.uniform3fv(this.materialAmbientColorUniform,e)};n.setMaterialDiffuseColor=function(d,e){d.uniform3fv(this.materialDiffuseColorUniform,e)};n.setMaterialSpecularColor=function(d,e){d.uniform3fv(this.materialSpecularColorUniform,e)};n.setMaterialShininess=function(d,e){d.uniform1f(this.materialShininessUniform,
e)};n.setMaterialAlpha=function(d,e){d.uniform1f(this.materialAlphaUniform,e)};n.setLightDiffuseColor=function(d,e){d.uniform3fv(this.lightDiffuseColorUniform,e)};n.setLightSpecularColor=function(d,e){d.uniform3fv(this.lightSpecularColorUniform,e)};n.setLightDirection=function(d,e){d.uniform3fv(this.lightDirectionUniform,e)};n.setLightModelViewMatrix=function(d,e){d.uniformMatrix4fv(this.lightModelViewMatrixUniform,!1,e)};n.setLightProjectionMatrix=function(d,e){d.uniformMatrix4fv(this.lightProjectionMatrixUniform,
!1,e)};n.setShadowTextureSize=function(d,e,c){d.uniform2f(this.shadowTextureSizeUniform,e,c)};n.setShadowIntensity=function(d,e){d.uniform1f(this.shadowIntensityUniform,e)};n.setGammaCorrection=function(d,e){d.uniform1f(this.gammaCorrectionUniform,1/e)};n.setPointSize=function(d,e){d.uniform1f(this.pointSizeUniform,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.PickShader=function(){};var p=n._Shader.prototype;n=n.PickShader.prototype=new n._Shader;n.initUniformLocations=function(d){p.initUniformLocations.call(this,d);this.materialDiffuseColorUniform=d.getUniformLocation(this.gProgram,"u_material_diffuse_color")};n.loadDefaultVertexShader=function(d){return this.getShaderFromStr(d,d.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;void main() {gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position /= gl_Position.w;}")};
n.loadDefaultFragmentShader=function(d){var e=[d.depthTextureExt?"#define CWC_DEPTH_TEX\n":"","precision mediump float;uniform vec3 u_material_diffuse_color;void main(void) {gl_FragColor = vec4(u_material_diffuse_color, 1.);}"].join("");return this.getShaderFromStr(d,d.FRAGMENT_SHADER,e)};n.setMaterialDiffuseColor=function(d,e){d.uniform3fv(this.materialDiffuseColorUniform,e)}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.PositionShader=function(){};n=n.PositionShader.prototype=new n._Shader;n.loadDefaultVertexShader=function(p){return this.getShaderFromStr(p,p.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;uniform mat4 u_model_view_matrix;uniform mat4 u_projection_matrix;varying vec4 v_position;void main() {vec4 viewPos = u_model_view_matrix * vec4(a_vertex_position, 1.);gl_Position = u_projection_matrix * viewPos;v_position = viewPos / viewPos.w;}")};n.loadDefaultFragmentShader=
function(p){return this.getShaderFromStr(p,p.FRAGMENT_SHADER,"precision mediump float;varying vec4 v_position;void main(void) {gl_FragColor = v_position;}")}})(ChemDoodle.structures.d3,ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k){n.QuadShader=function(){};n=n.QuadShader.prototype=new n._Shader;n.loadDefaultVertexShader=function(p){return this.getShaderFromStr(p,p.VERTEX_SHADER,"precision mediump float;attribute vec3 a_vertex_position;varying vec2 v_texcoord;void main() {gl_Position = vec4(a_vertex_position, 1.);v_texcoord = a_vertex_position.xy * .5 + .5;}")};n.loadDefaultFragmentShader=function(p){return this.getShaderFromStr(p,p.FRAGMENT_SHADER,"precision mediump float;uniform sampler2D u_image;varying vec2 v_texcoord;void main() {gl_FragColor = texture2D(u_image, v_texcoord);}")}})(ChemDoodle.structures.d3,
ChemDoodle.lib.mat3,ChemDoodle.lib.mat4,document);
(function(n,E,x,v,k,p,d){var e=function(c,a,f){this.i1=c;this.i2=a;this.i3=f};E._Surface=function(){};E=E._Surface.prototype=new E._Mesh;E.generate=function(c,a,f,m,q,l,r,y){c=[];a=q[4]-m;for(f=0;f<y;f++){for(var w=q[2]-m,A=0;A<r;A++){for(var G=q[0]-m,b=0;b<l;b++)c.push(this.calculate(G,w,a)),G+=m;w+=m}a+=m}return c};E.build=function(c,a,f){var m=[],q=[],l=[],r=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity];a+=2;for(var y=0,w=c.length;y<w;y++){var A=c[y];r[0]=p.min(r[0],A.x-a);r[1]=p.max(r[1],
A.x+a);r[2]=p.min(r[2],A.y-a);r[3]=p.max(r[3],A.y+a);r[4]=p.min(r[4],A.z-a);r[5]=p.max(r[5],A.z+a)}a=r[1]-r[0];y=r[3]-r[2];w=r[5]-r[4];c=p.min(a,p.min(y,w))/f;f=2+p.ceil(a/c);A=2+p.ceil(y/c);var G=2+p.ceil(w/c);a=this.generate(a,y,w,c,r,f,A,G);a=v(a,[f,A,G]);f=[];y=[];w=0;for(A=a.vertices.length;w<A;w++){G=y;var b=G.push,g=a.vertices[w],t=f,B=g[0]*c+r[0]-c,F=g[1]*c+r[2]-c;g=g[2]*c+r[4]-c;for(var I=-1,L=0,O=t.length;L<O;L++){var S=t[L];if(.001>p.abs(S.x-B)&&.001>p.abs(S.y-F)&&.001>p.abs(S.z-g)){I=
L;break}}-1==I&&(I=t.length,t.push(new n.Atom("C",B,F,g)));b.call(G,I)}r=[];c=0;for(w=a.faces.length;c<w;c++)b=a.faces[c],A=y[b[0]],G=y[b[1]],b=y[b[2]],r.push(new e(A,G,b)),l.push(A,G,b);c=[];a=0;for(y=f.length;a<y;a++){w=[];A=0;for(G=r.length;A<G;A++)if(b=r[A],b.i1===a||b.i2===a||b.i3===a)b.i1!=a&&-1===w.indexOf(b.i1)&&w.push(b.i1),b.i2!=a&&-1===w.indexOf(b.i2)&&w.push(b.i2),b.i3!=a&&-1===w.indexOf(b.i3)&&w.push(b.i3);c.push(w)}a=[];y=0;for(w=f.length;y<w;y++){G=f[y];b=c[y];A=new n.Atom;if(3>b.length)A.x=
G.x,A.y=G.y,A.z=G.z;else{t=1;5>b.length&&(t=.5);B=0;for(F=b.length;B<F;B++)g=f[b[B]],A.x+=g.x,A.y+=g.y,A.z+=g.z;A.x+=G.x*t;A.y+=G.y*t;A.z+=G.z*t;G=1/(t+b.length);A.x*=G;A.y*=G;A.z*=G}a.push(A)}f=a;c=0;for(a=f.length;c<a;c++)y=f[c],m.push(y.x,y.y,y.z);c=0;for(a=r.length;c<a;c++)y=r[c],w=f[y.i1],G=f[y.i2],A=f[y.i3],G=[G.x-w.x,G.y-w.y,G.z-w.z],k.cross(G,[A.x-w.x,A.y-w.y,A.z-w.z]),isNaN(G[0])&&(G=[0,0,0]),y.normal=G;c=0;for(f=f.length;c<f;c++){a=[0,0,0];y=0;for(w=r.length;y<w;y++)if(A=r[y],A.i1===c||
A.i2===c||A.i3===c)a[0]+=A.normal[0],a[1]+=A.normal[1],a[2]+=A.normal[2];k.normalize(a);q.push(a[0],a[1],a[2])}this.storeData(m,q,l)};E.render=function(c,a){this.styles&&(a=this.styles);a.surfaces_display&&(c.shader.setMatrixUniforms(c),this.bindBuffers(c),c.material.setTempColors(c,a.surfaces_materialAmbientColor_3D,a.surfaces_color,a.surfaces_materialSpecularColor_3D,a.surfaces_materialShininess_3D),c.material.setAlpha(c,a.surfaces_alpha),"Dots"===a.surfaces_style?(c.shader.setPointSize(c,a.shapes_pointSize),
c.drawElements(c.POINTS,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)):"Mesh"===a.surfaces_style?(c.lineWidth(a.shapes_lineWidth),c.drawElements(c.LINES,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0)):c.drawElements(c.TRIANGLES,this.vertexIndexBuffer.numItems,c.UNSIGNED_SHORT,0))}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,ChemDoodle.lib.MarchingCubes,ChemDoodle.lib.vec3,Math);
(function(n,E,x,v,k){E.SASSurface=function(p,d,e){this.atoms=p;this.probeRadius=d;this.resolution=e;this.build(p,d,e)};(E.SASSurface.prototype=new E._Surface).calculate=function(p,d,e){var c=Infinity;p=new n.Atom("C",p,d,e);d=0;for(e=this.atoms.length;d<e;d++){var a=this.atoms[d],f=x[a.label]&&0!==x[a.label].vdWRadius?x[a.label].vdWRadius:2;a=a.distance3D(p)-this.probeRadius-f;c=v.min(c,a)}return c}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(n,E,x,v,k){E.VDWSurface=function(p,d){this.atoms=p;this.probeRadius=0;this.resolution=d;this.build(p,0,d)};(E.VDWSurface.prototype=new E._Surface).calculate=function(p,d,e){var c=Infinity;p=new n.Atom("C",p,d,e);d=0;for(e=this.atoms.length;d<e;d++){var a=this.atoms[d],f=x[a.label]&&0!==x[a.label].vdWRadius?x[a.label].vdWRadius:2;a=a.distance3D(p)-f;c=v.min(c,a)}return c}})(ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.ELEMENT,Math);
(function(n,E,x,v){n.Plate=function(k){this.lanes=Array(k);i=0;for(ii=k;i<ii;i++)this.lanes[i]=[]};v=n.Plate.prototype;v.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(k,p){return k-p})};v.draw=function(k,p){p=k.canvas.width;var d=k.canvas.height;this.origin=9*d/10;this.front=d/10;this.laneLength=this.origin-this.front;k.strokeStyle="#000000";k.beginPath();k.moveTo(0,this.front);k.lineTo(p,this.front);k.setLineDash([3]);k.stroke();k.setLineDash([]);k.beginPath();
k.moveTo(0,this.origin);k.lineTo(p,this.origin);k.closePath();k.stroke();i=0;for(ii=this.lanes.length;i<ii;i++)for(d=(i+1)*p/(ii+1),k.beginPath(),k.moveTo(d,this.origin),k.lineTo(d,this.origin+3),k.closePath(),k.stroke(),s=0,ss=this.lanes[i].length;s<ss;s++){var e=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":k.beginPath();k.arc(d,e,3,0,2*x.PI,!1);k.closePath();break;case "expanded":k.beginPath();k.arc(d,e,7,0,2*x.PI,!1);k.closePath();break;case "widened":E.contextEllipse(k,
d-18,e-10,36,10);break;case "cresent":k.beginPath(),k.arc(d,e,9,0,x.PI,!0),k.closePath()}switch(this.lanes[i][s].style){case "solid":k.fillStyle="#000000";k.fill();break;case "transparent":k.stroke()}}};n.Plate.Spot=function(k,p,d){this.type=k;this.rf=p;this.style=d?d:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(n,E,x,v,k,p){n.DEFAULT_STYLES={backgroundColor:"#FFFFFF",scale:1,rotateAngle:0,bondLength_2D:20,angstromsPerBondLength:1.25,lightDirection_3D:[-.1,-.1,-1],lightDiffuseColor_3D:"#FFFFFF",lightSpecularColor_3D:"#FFFFFF",projectionPerspective_3D:!0,projectionPerspectiveVerticalFieldOfView_3D:45,projectionOrthoWidth_3D:40,projectionWidthHeightRatio_3D:p,projectionFrontCulling_3D:.1,projectionBackCulling_3D:1E4,cullBackFace_3D:!0,fog_mode_3D:0,fog_color_3D:"#000000",fog_start_3D:0,fog_end_3D:1,
fog_density_3D:1,shadow_3D:!1,shadow_intensity_3D:.85,flat_color_3D:!1,antialias_3D:!0,gammaCorrection_3D:2.2,colorHover:"#885110",colorSelect:"#0060B2",colorError:"#c10000",colorPreview:"#00FF00",ssao_3D:!1,ssao_kernel_radius:17,ssao_kernel_samples:32,ssao_power:1,outline_3D:!1,outline_thickness:1,outline_normal_threshold:.85,outline_depth_threshold:.1,fxaa_edgeThreshold:.0625,fxaa_edgeThresholdMin:1/12,fxaa_searchSteps:64,fxaa_searchThreshold:.25,fxaa_subpixCap:1,fxaa_subpixTrim:0,atoms_display:!0,
atoms_color:"#000000",atoms_font_size_2D:12,atoms_font_families_2D:["Helvetica","Arial","Dialog"],atoms_font_bold_2D:!1,atoms_font_italic_2D:!1,atoms_circles_2D:!1,atoms_circleDiameter_2D:10,atoms_circleBorderWidth_2D:1,atoms_lonePairDistance_2D:8,atoms_lonePairSpread_2D:4,atoms_lonePairDiameter_2D:1,atoms_useJMOLColors:!1,atoms_usePYMOLColors:!1,atoms_HBlack_2D:!0,atoms_implicitHydrogens_2D:!0,atoms_displayTerminalCarbonLabels_2D:!1,atoms_showHiddenCarbons_2D:!0,atoms_showAttributedCarbons_2D:!0,
atoms_displayAllCarbonLabels_2D:!1,atoms_resolution_3D:30,atoms_sphereDiameter_3D:.8,atoms_useVDWDiameters_3D:!1,atoms_vdwMultiplier_3D:1,atoms_materialAmbientColor_3D:"#000000",atoms_materialSpecularColor_3D:"#555555",atoms_materialShininess_3D:32,atoms_nonBondedAsStars_3D:!1,atoms_displayLabels_3D:!1,bonds_display:!0,bonds_color:"#000000",bonds_width_2D:1,bonds_useAbsoluteSaturationWidths_2D:!0,bonds_saturationWidth_2D:.2,bonds_saturationWidthAbs_2D:5,bonds_ends_2D:"round",bonds_splitColor:!1,bonds_colorGradient:!1,
bonds_saturationAngle_2D:x.PI/3,bonds_symmetrical_2D:!1,bonds_clearOverlaps_2D:!1,bonds_overlapClearWidth_2D:.5,bonds_atomLabelBuffer_2D:1,bonds_wedgeThickness_2D:6,bonds_wavyLength_2D:4,bonds_hashWidth_2D:1,bonds_hashSpacing_2D:2.5,bonds_dotSize_2D:2,bonds_lewisStyle_2D:!1,bonds_showBondOrders_3D:!1,bonds_resolution_3D:30,bonds_renderAsLines_3D:!1,bonds_cylinderDiameter_3D:.3,bonds_pillLatitudeResolution_3D:10,bonds_pillLongitudeResolution_3D:20,bonds_pillHeight_3D:.3,bonds_pillSpacing_3D:.1,bonds_pillDiameter_3D:.3,
bonds_materialAmbientColor_3D:"#000000",bonds_materialSpecularColor_3D:"#555555",bonds_materialShininess_3D:32,proteins_displayRibbon:!0,proteins_displayBackbone:!1,proteins_backboneThickness:1.5,proteins_backboneColor:"#CCCCCC",proteins_ribbonCartoonize:!1,proteins_displayPipePlank:!1,proteins_residueColor:"none",proteins_primaryColor:"#FF0D0D",proteins_secondaryColor:"#FFFF30",proteins_ribbonCartoonHelixPrimaryColor:"#00E740",proteins_ribbonCartoonHelixSecondaryColor:"#9905FF",proteins_ribbonCartoonSheetColor:"#E8BB99",
proteins_tubeColor:"#FF0D0D",proteins_tubeResolution_3D:15,proteins_ribbonThickness:.2,proteins_tubeThickness:.5,proteins_plankSheetWidth:3.5,proteins_cylinderHelixDiameter:4,proteins_verticalResolution:8,proteins_horizontalResolution:8,proteins_materialAmbientColor_3D:"#000000",proteins_materialSpecularColor_3D:"#555555",proteins_materialShininess_3D:32,nucleics_display:!0,nucleics_tubeColor:"#CCCCCC",nucleics_baseColor:"#C10000",nucleics_residueColor:"none",nucleics_tubeThickness:1.5,nucleics_tubeResolution_3D:15,
nucleics_verticalResolution:8,nucleics_materialAmbientColor_3D:"#000000",nucleics_materialSpecularColor_3D:"#555555",nucleics_materialShininess_3D:32,macro_displayAtoms:!1,macro_displayBonds:!1,macro_atomToLigandDistance:-1,macro_showWater:!1,macro_colorByChain:!1,macro_rainbowColors:["#0000FF","#00FFFF","#00FF00","#FFFF00","#FF0000"],surfaces_display:!0,surfaces_alpha:.5,surfaces_style:"Solid",surfaces_color:"white",surfaces_materialAmbientColor_3D:"#000000",surfaces_materialSpecularColor_3D:"#000000",
surfaces_materialShininess_3D:32,plots_color:"#000000",plots_width:1,plots_showIntegration:!1,plots_integrationColor:"#c10000",plots_integrationLineWidth:1,plots_showGrid:!1,plots_gridColor:"gray",plots_gridLineWidth:.5,plots_showYAxis:!0,plots_flipXAxis:!1,text_font_size:12,text_font_families:["Helvetica","Arial","Dialog"],text_font_bold:!0,text_font_italic:!1,text_font_stroke_3D:!0,text_color:"#000000",shapes_color:"#000000",shapes_lineWidth:1,shapes_pointSize:2,shapes_arrowLength_2D:8,compass_display:!1,
compass_axisXColor_3D:"#FF0000",compass_axisYColor_3D:"#00FF00",compass_axisZColor_3D:"#0000FF",compass_size_3D:50,compass_resolution_3D:10,compass_displayText_3D:!0,compass_type_3D:0,measurement_update_3D:!1,measurement_angleBands_3D:10,measurement_displayText_3D:!0};E.Styles=function(d){k.assign(this,v.parse(v.stringify(d===p?n.DEFAULT_STYLES:d)))};x=E.Styles.prototype;x.set3DRepresentation=function(d){this.bonds_display=this.atoms_display=!0;this.bonds_color="#777777";this.bonds_showBondOrders_3D=
this.bonds_splitColor=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0;this.bonds_renderAsLines_3D=!1;"Ball and Stick"===d?(this.atoms_vdwMultiplier_3D=.3,this.bonds_splitColor=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=ChemDoodle.DEFAULT_STYLES.atoms_materialAmbientColor_3D,this.bonds_pillDiameter_3D=.15):"van der Waals Spheres"===d?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"===d?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,
this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"===d?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.bonds_pillDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=ChemDoodle.DEFAULT_STYLES.atoms_materialAmbientColor_3D):"Line"===d?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+
d+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')};x.copy=function(){return new E.Styles(this)}})(ChemDoodle,ChemDoodle.structures,Math,JSON,Object);
(function(n,E,x,v,k){x.getPointsPerAngstrom=function(){return n.DEFAULT_STYLES.bondLength_2D/n.DEFAULT_STYLES.angstromsPerBondLength};x.BondDeducer=function(){};k=x.BondDeducer.prototype;k.margin=1.1;k.deduceCovalentBonds=function(p,d){var e=x.getPointsPerAngstrom();d&&(e=d);d=0;for(var c=p.atoms.length;d<c;d++)for(var a=d+1;a<c;a++){var f=p.atoms[d],m=p.atoms[a];f.distance3D(m)<(E[f.label].covalentRadius+E[m.label].covalentRadius)*e*this.margin&&p.bonds.push(new v.Bond(f,m,1))}}})(ChemDoodle,ChemDoodle.ELEMENT,
ChemDoodle.informatics,ChemDoodle.structures);
(function(n,E,x){n.HydrogenDeducer=function(){};n.HydrogenDeducer.prototype.removeHydrogens=function(v,k){for(var p=[],d=[],e=0,c=v.bonds.length;e<c;e++){var a=v.bonds[e],f="H"!==a.a1.label&&"H"!==a.a2.label;f||k||a.stereo===E.Bond.STEREO_NONE||(f=!0);f?(a.a1.tag=!0,d.push(a)):("H"===a.a1.label&&(a.a1.remove=!0),"H"===a.a2.label&&(a.a2.remove=!0))}k=0;for(e=v.atoms.length;k<e;k++)c=v.atoms[k],c.remove?c.remove=x:p.push(c);v.atoms=p;v.bonds=d}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(n,E,x){n.Splitter=function(){};n.Splitter.prototype.split=function(v){for(var k=[],p=0,d=v.atoms.length;p<d;p++)v.atoms[p].visited=!1;p=0;for(d=v.bonds.length;p<d;p++)v.bonds[p].visited=!1;p=0;for(d=v.atoms.length;p<d;p++){var e=v.atoms[p];if(!e.visited){var c=new E.Molecule;c.atoms.push(e);e.visited=!0;var a=new E.Queue;for(a.enqueue(e);!a.isEmpty();){e=a.dequeue();for(var f=0,m=v.bonds.length;f<m;f++){var q=v.bonds[f];q.contains(e)&&!q.visited&&(q.visited=!0,c.bonds.push(q),q=q.getNeighbor(e),
q.visited||(q.visited=!0,c.atoms.push(q),a.enqueue(q)))}}k.push(c)}}return k}})(ChemDoodle.informatics,ChemDoodle.structures);(function(n,E,x,v){n.StructureBuilder=function(){};n.StructureBuilder.prototype.copy=function(k){var p=new E.JSONInterpreter;return p.molFrom(p.molTo(k))}})(ChemDoodle.informatics,ChemDoodle.io,ChemDoodle.structures);
(function(n,E){n._Counter=function(){};n=n._Counter.prototype;n.value=0;n.molecule=E;n.setMolecule=function(x){this.value=0;this.molecule=x;this.innerCalculate&&this.innerCalculate()}})(ChemDoodle.informatics);(function(n,E){n.FrerejacqueNumberCounter=function(x){this.setMolecule(x)};(n.FrerejacqueNumberCounter.prototype=new n._Counter).innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new n.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(n,E,x){E.NumberOfMoleculesCounter=function(v){this.setMolecule(v)};(E.NumberOfMoleculesCounter.prototype=new E._Counter).innerCalculate=function(){for(var v=0,k=this.molecule.atoms.length;v<k;v++)this.molecule.atoms[v].visited=!1;v=0;for(k=this.molecule.atoms.length;v<k;v++)if(!this.molecule.atoms[v].visited){this.value++;var p=new n.Queue;this.molecule.atoms[v].visited=!0;for(p.enqueue(this.molecule.atoms[v]);!p.isEmpty();)for(var d=p.dequeue(),e=0,c=this.molecule.bonds.length;e<c;e++){var a=
this.molecule.bonds[e];a.contains(d)&&(a=a.getNeighbor(d),a.visited||(a.visited=!0,p.enqueue(a)))}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(n,E){n._RingFinder=function(){};n=n._RingFinder.prototype;n.atoms=E;n.bonds=E;n.rings=E;n.reduce=function(x){for(var v=0,k=x.atoms.length;v<k;v++)x.atoms[v].visited=!1;v=0;for(k=x.bonds.length;v<k;v++)x.bonds[v].visited=!1;for(v=!0;v;){v=!1;k=0;for(var p=x.atoms.length;k<p;k++){for(var d=0,e=void 0,c=0,a=x.bonds.length;c<a;c++)if(x.bonds[c].contains(x.atoms[k])&&!x.bonds[c].visited){d++;if(2===d)break;e=x.bonds[c]}1===d&&(v=!0,e.visited=!0,x.atoms[k].visited=!0)}}v=0;for(k=x.atoms.length;v<
k;v++)x.atoms[v].visited||this.atoms.push(x.atoms[v]);v=0;for(k=x.bonds.length;v<k;v++)x.bonds[v].visited||this.bonds.push(x.bonds[v]);0===this.bonds.length&&0!==this.atoms.length&&(this.atoms=[])};n.setMolecule=function(x){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(x);2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()};n.fuse=function(){for(var x=0,v=this.rings.length;x<v;x++)for(var k=0,p=this.bonds.length;k<p;k++)-1!==this.rings[x].atoms.indexOf(this.bonds[k].a1)&&-1!==this.rings[x].atoms.indexOf(this.bonds[k].a2)&&
this.rings[x].bonds.push(this.bonds[k])}})(ChemDoodle.informatics);
(function(n,E,x){function v(p,d){this.atoms=[];if(d)for(var e=0,c=d.atoms.length;e<c;e++)this.atoms[e]=d.atoms[e];this.atoms.push(p)}var k=v.prototype;k.grow=function(p,d){for(var e=this.atoms[this.atoms.length-1],c=[],a=0,f=p.length;a<f;a++)if(p[a].contains(e)){var m=p[a].getNeighbor(e);-1===d.indexOf(m)&&c.push(m)}p=[];d=0;for(e=c.length;d<e;d++)p.push(new v(c[d],this));return p};k.check=function(p,d,e){for(var c=0,a=d.atoms.length-1;c<a;c++)if(-1!==this.atoms.indexOf(d.atoms[c]))return x;if(d.atoms[d.atoms.length-
1]===this.atoms[this.atoms.length-1]){var f=new E.Ring;f.atoms[0]=e;e=0;for(p=this.atoms.length;e<p;e++)f.atoms.push(this.atoms[e]);for(e=d.atoms.length-2;0<=e;e--)f.atoms.push(d.atoms[e])}else{c=[];a=0;for(var m=p.length;a<m;a++)p[a].contains(d.atoms[d.atoms.length-1])&&c.push(p[a]);p=0;for(a=c.length;p<a;p++)if((1===d.atoms.length||!c[p].contains(d.atoms[d.atoms.length-2]))&&c[p].contains(this.atoms[this.atoms.length-1])){f=new E.Ring;f.atoms[0]=e;e=0;for(p=this.atoms.length;e<p;e++)f.atoms.push(this.atoms[e]);
for(e=d.atoms.length-1;0<=e;e--)f.atoms.push(d.atoms[e]);break}}return f};n.EulerFacetRingFinder=function(p){this.setMolecule(p)};n=n.EulerFacetRingFinder.prototype=new n._RingFinder;n.fingerBreak=5;n.innerGetRings=function(){for(var p=0,d=this.atoms.length;p<d;p++){for(var e=[],c=0,a=this.bonds.length;c<a;c++)this.bonds[c].contains(this.atoms[p])&&e.push(this.bonds[c].getNeighbor(this.atoms[p]));c=0;for(a=e.length;c<a;c++)for(var f=c+1;f<e.length;f++){var m=[];m[0]=new v(e[c]);m[1]=new v(e[f]);var q=
[];q[0]=this.atoms[p];for(var l=0,r=e.length;l<r;l++)l!==c&&l!==f&&q.push(e[l]);l=[];for((r=m[0].check(this.bonds,m[1],this.atoms[p]))&&(l[0]=r);0===l.length&&0<m.length&&m[0].atoms.length<this.fingerBreak;){r=[];for(var y=0,w=m.length;y<w;y++)for(var A=m[y].grow(this.bonds,q),G=0,b=A.length;G<b;G++)r.push(A[G]);m=r;r=0;for(y=m.length;r<y;r++)for(w=r+1;w<y;w++)(A=m[r].check(this.bonds,m[w],this.atoms[p]))&&l.push(A);if(0===l.length){r=[];y=0;for(w=q.length;y<w;y++)for(A=0,G=this.bonds.length;A<G;A++)this.bonds[A].contains(q[y])&&
(b=this.bonds[A].getNeighbor(q[y]),-1===q.indexOf(b)&&-1===r.indexOf(b)&&r.push(b));y=0;for(w=r.length;y<w;y++)q.push(r[y])}}if(0<l.length){m=x;q=0;for(r=l.length;q<r;q++)if(!m||m.atoms.length>l[q].atoms.length)m=l[q];l=!1;q=0;for(r=this.rings.length;q<r;q++){y=!0;w=0;for(A=m.atoms.length;w<A;w++)if(-1===this.rings[q].atoms.indexOf(m.atoms[w])){y=!1;break}if(y){l=!0;break}}l||this.rings.push(m)}}}this.fuse()}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(n,E){n.SSSRFinder=function(x){this.rings=[];if(0<x.atoms.length){var v=(new n.FrerejacqueNumberCounter(x)).value,k=(new n.EulerFacetRingFinder(x)).rings;k.sort(function(a,f){return a.atoms.length-f.atoms.length});for(var p=0,d=x.bonds.length;p<d;p++)x.bonds[p].visited=!1;x=0;for(p=k.length;x<p;x++){d=!1;for(var e=0,c=k[x].bonds.length;e<c;e++)if(!k[x].bonds[e].visited){d=!0;break}if(d){d=0;for(e=k[x].bonds.length;d<e;d++)k[x].bonds[d].visited=!0;this.rings.push(k[x])}if(this.rings.length===
v)break}}}})(ChemDoodle.informatics);(function(n,E){n._Interpreter=function(){};n._Interpreter.prototype.fit=function(x,v,k){for(var p=x.length,d=[],e=0;e<v-p;e++)d.push(" ");return k?x+d.join(""):d.join("")+x}})(ChemDoodle.io);
(function(n,E,x,v,k,p,d,e){var c=/\s+/g,a=/\(|\)|\s+/g,f=/'|\s+/g,m=/,|'|\s+/g,q=/^\s+/,l=/[0-9]/g,r=/[0-9]|\+|\-/g,y=function(b){return 0!==b.length},w={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},A=function(b){var g=0,t=0,B=0,F=0,I=b.indexOf("x"),L=b.indexOf("y"),O=b.indexOf("z");-1!==I&&(t++,0<I&&"+"!==b.charAt(I-1)&&(t*=-1));-1!==L&&(B++,0<L&&"+"!==
b.charAt(L-1)&&(B*=-1));-1!==O&&(F++,0<O&&"+"!==b.charAt(O-1)&&(F*=-1));if(2<b.length)for(I="+",L=0,O=b.length;L<O;L++){var S=b.charAt(L);"-"!==S&&"/"!==S||L!==b.length-1&&!b.charAt(L+1).match(l)||(I=S);S.match(l)&&("+"===I?g+=parseInt(S):"-"===I?g-=parseInt(S):"/"===I&&(g/=parseInt(S)))}return[g,t,B,F]};E.CIFInterpreter=function(){};E.CIFInterpreter.generateABC2XYZ=function(b,g,t,B,F,I){B=(k.cos(B)-k.cos(I)*k.cos(F))/k.sin(I);return[b,0,0,0,g*k.cos(I),g*k.sin(I),0,0,t*k.cos(F),t*B,t*k.sqrt(1-k.pow(k.cos(F),
2)-B*B),0,0,0,0,1]};(E.CIFInterpreter.prototype=new E._Interpreter).read=function(b,g,t,B){g=g?g:1;t=t?t:1;B=B?B:1;var F=new x.Molecule;if(!b)return F;for(var I=b.split("\n"),L=b=0,O=0,S=0,W=0,V=0,Z="P",ba,X,ea,Y,aa=!0;0<I.length;)if(aa?Y=I.shift():aa=!0,0<Y.length)if(Y.startsWith("_cell_length_a"))b=parseFloat(Y.split(a)[1]);else if(Y.startsWith("_cell_length_b"))L=parseFloat(Y.split(a)[1]);else if(Y.startsWith("_cell_length_c"))O=parseFloat(Y.split(a)[1]);else if(Y.startsWith("_cell_angle_alpha"))S=
k.PI*parseFloat(Y.split(a)[1])/180;else if(Y.startsWith("_cell_angle_beta"))W=k.PI*parseFloat(Y.split(a)[1])/180;else if(Y.startsWith("_cell_angle_gamma"))V=k.PI*parseFloat(Y.split(a)[1])/180;else if(Y.startsWith("_symmetry_space_group_name_H-M"))Z=Y.split(f)[1];else if(Y.startsWith("loop_")){for(var da={fields:[],lines:[]},ia=!1;(Y=I.shift())!==e&&!(Y=Y.replace(q,"")).startsWith("loop_")&&0<Y.length;)if(Y.startsWith("_")){if(ia)break;da.fields=da.fields.concat(Y.split(c).filter(y))}else ia=!0,da.lines.push(Y);
0!==I.length&&(Y.startsWith("loop_")||Y.startsWith("_"))&&(aa=!1);-1!==da.fields.indexOf("_symmetry_equiv_pos_as_xyz")||-1!==da.fields.indexOf("_space_group_symop_operation_xyz")?ba=da:-1!==da.fields.indexOf("_atom_site_label")?X=da:-1!==da.fields.indexOf("_geom_bond_atom_site_label_1")&&(ea=da)}I=E.CIFInterpreter.generateABC2XYZ(b,L,O,S,W,V);if(X){var ja=ia=da=aa=-1,la=-1;Y=0;for(var ra=X.fields.length;Y<ra;Y++){var za=X.fields[Y];"_atom_site_type_symbol"===za?aa=Y:"_atom_site_label"===za?da=Y:"_atom_site_fract_x"===
za?ia=Y:"_atom_site_fract_y"===za?ja=Y:"_atom_site_fract_z"===za&&(la=Y)}ra=0;for(za=X.lines.length;ra<za;ra++){Y=X.lines[ra];Y=Y.split(c).filter(y);var Ba=new x.Atom(Y[-1===aa?da:aa].split(r)[0],parseFloat(Y[ia]),parseFloat(Y[ja]),parseFloat(Y[la]));F.atoms.push(Ba);-1!==da&&(Ba.cifId=Y[da],Ba.cifPart=0)}}if(ba&&!ea){Y=X=0;for(aa=ba.fields.length;Y<aa;Y++)if(da=ba.fields[Y],"_symmetry_equiv_pos_as_xyz"===da||"_space_group_symop_operation_xyz"===da)X=Y;Y=w[Z];Z=[];aa=0;for(da=ba.lines.length;aa<da;aa++)for(la=
ba.lines[aa].split(m).filter(y),ia=A(la[X]),ja=A(la[X+1]),la=A(la[X+2]),ra=0,za=F.atoms.length;ra<za;ra++){Ba=F.atoms[ra];var Ra=Ba.x*ia[1]+Ba.y*ia[2]+Ba.z*ia[3]+ia[0],Sa=Ba.x*ja[1]+Ba.y*ja[2]+Ba.z*ja[3]+ja[0],Ta=Ba.x*la[1]+Ba.y*la[2]+Ba.z*la[3]+la[0],Qa=new x.Atom(Ba.label,Ra,Sa,Ta);Z.push(Qa);Ba.cifId!==e&&(Qa.cifId=Ba.cifId,Qa.cifPart=aa+1);if(Y){Qa=0;for(var Va=Y.length;Qa<Va;Qa++){var oa=Y[Qa];oa=new x.Atom(Ba.label,Ra+oa[0],Sa+oa[1],Ta+oa[2]);Z.push(oa);Ba.cifId!==e&&(oa.cifId=Ba.cifId,oa.cifPart=
aa+1)}}}X=0;for(Y=Z.length;X<Y;X++){for(aa=Z[X];1<=aa.x;)aa.x--;for(;0>aa.x;)aa.x++;for(;1<=aa.y;)aa.y--;for(;0>aa.y;)aa.y++;for(;1<=aa.z;)aa.z--;for(;0>aa.z;)aa.z++}X=[];Y=0;for(aa=Z.length;Y<aa;Y++){da=!1;ia=Z[Y];ja=0;for(la=F.atoms.length;ja<la;ja++)if(1E-4>F.atoms[ja].distance3D(ia)){da=!0;break}if(!da){ja=0;for(la=X.length;ja<la;ja++)if(1E-4>X[ja].distance3D(ia)){da=!0;break}da||X.push(ia)}}F.atoms=F.atoms.concat(X)}Z=[];for(X=0;X<g;X++)for(Y=0;Y<t;Y++)for(aa=0;aa<B;aa++)if(0!==X||0!==Y||0!==
aa)for(da=0,ia=F.atoms.length;da<ia;da++)ja=F.atoms[da],la=new x.Atom(ja.label,ja.x+X,ja.y+Y,ja.z+aa),Z.push(la),ja.cifId!==e&&(la.cifId=ja.cifId,la.cifPart=ja.cifPart+(ba?ba.lines.length:0)+X+10*Y+100*aa);F.atoms=F.atoms.concat(Z);g=0;for(t=F.atoms.length;g<t;g++)B=F.atoms[g],ba=p.multiplyVec3(I,[B.x,B.y,B.z]),B.x=ba[0],B.y=ba[1],B.z=ba[2];if(ea){t=g=-1;B=0;for(ba=ea.fields.length;B<ba;B++)I=ea.fields[B],"_geom_bond_atom_site_label_1"===I?g=B:"_geom_bond_atom_site_label_2"===I&&(t=B);B=0;for(ba=
ea.lines.length;B<ba;B++)for(Z=ea.lines[B].split(c).filter(y),I=Z[g],Z=Z[t],X=0,Y=F.atoms.length;X<Y;X++)for(aa=X+1;aa<Y;aa++){da=F.atoms[X];ia=F.atoms[aa];if(da.cifPart!==ia.cifPart)break;(da.cifId===I&&ia.cifId===Z||da.cifId===Z&&ia.cifId===I)&&F.bonds.push(new x.Bond(da,ia))}}else(new n.informatics.BondDeducer).deduceCovalentBonds(F,1);return{molecule:F,unitCell:new v.UnitCell([b,L,O],[S,W,V],[0,0,0])}};var G=new E.CIFInterpreter;n.readCIF=function(b,g,t,B){return G.read(b,g,t,B)}})(ChemDoodle,
ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d3,Math,ChemDoodle.lib.mat4,ChemDoodle.lib.vec3);
(function(n,E,x,v,k){E.CMLInterpreter=function(){};var p=E.CMLInterpreter.prototype=new E._Interpreter;p.read=function(e){var c=[];e=v.parseXML(e);e=v(e).find("cml");for(var a=0,f=e.length;a<f;a++)for(var m=v(e[a]).find("molecule"),q=0,l=m.length;q<l;q++){for(var r=c[q]=new x.Molecule,y=[],w=v(m[q]).find("atom"),A=0,G=w.length;A<G;A++){var b=v(w[A]),g=b.attr("elementType");if(b.attr("x2")==k){var t=b.attr("x3");var B=b.attr("y3");var F=b.attr("z3")}else t=b.attr("x2"),B=b.attr("y2"),F=0;g=c[q].atoms[A]=
new x.Atom(g,t,B,F);y[A]=b.attr("id");b.attr("formalCharge")!=k&&(g.charge=b.attr("formalCharge"))}w=v(m[q]).find("bond");A=0;for(G=w.length;A<G;A++){b=v(w[A]);t=b.attr("atomRefs2").split(" ");g=r.atoms[v.inArray(t[0],y)];t=r.atoms[v.inArray(t[1],y)];switch(b.attr("order")){case "2":case "D":B=2;break;case "3":case "T":B=3;break;case "A":B=1.5;break;default:B=1}g=c[q].bonds[A]=new x.Bond(g,t,B);switch(b.find("bondStereo").text()){case "W":g.stereo=x.Bond.STEREO_PROTRUDING;break;case "H":g.stereo=
x.Bond.STEREO_RECESSED}}}return c};p.write=function(e){var c=[];c.push('<?xml version="1.0" encoding="UTF-8"?>\n');c.push('<cml convention="conventions:molecular" xmlns="http://www.xml-cml.org/schema" xmlns:conventions="http://www.xml-cml.org/convention/" xmlns:dc="http://purl.org/dc/elements/1.1/">\n');for(var a=0,f=e.length;a<f;a++){c.push('<molecule id="m');c.push(a);c.push('">');c.push("<atomArray>");for(var m=0,q=e[a].atoms.length;m<q;m++){var l=e[a].atoms[m];c.push('<atom elementType="');c.push(l.label);
c.push('" id="a');c.push(m);c.push('" ');c.push('x3="');c.push(l.x);c.push('" y3="');c.push(l.y);c.push('" z3="');c.push(l.z);c.push('" ');0!=l.charge&&(c.push('formalCharge="'),c.push(l.charge),c.push('" '));c.push("/>")}c.push("</atomArray>");c.push("<bondArray>");m=0;for(q=e[a].bonds.length;m<q;m++){l=e[a].bonds[m];c.push('<bond atomRefs2="a');c.push(e[a].atoms.indexOf(l.a1));c.push(" a");c.push(e[a].atoms.indexOf(l.a2));c.push('" order="');switch(l.bondOrder){case 1.5:c.push("A");break;case 1:case 2:case 3:c.push(l.bondOrder);
break;default:c.push("S")}c.push('"/>')}c.push("</bondArray>");c.push("</molecule>")}c.push("</cml>");return c.join("")};var d=new E.CMLInterpreter;n.readCML=function(e){return d.read(e)};n.writeCML=function(e){return d.write(e)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery);
(function(n,E,x,v,k){x.MOLInterpreter=function(){};var p=x.MOLInterpreter.prototype=new x._Interpreter;p.version=2;p.read=function(c,a){a||(a=n.DEFAULT_STYLES.bondLength_2D);var f=new v.Molecule;if(!c)return f;c=c.split("\n");var m=c[3],q=parseInt(m.substring(0,3)),l=parseInt(m.substring(3,6));m="V3000"===m.substring(34,39).trim().toUpperCase()?3:2;if(2===m){for(var r=0;r<q;r++){m=c[4+r];var y=new v.Atom(m.substring(31,34),parseFloat(m.substring(0,10))*a,(1===a?1:-1)*parseFloat(m.substring(10,20))*
a,parseFloat(m.substring(20,30))*a),w=parseInt(m.substring(34,36));0!==w&&E[y.label]&&(y.mass=E[y.label].mass+w);switch(parseInt(m.substring(36,39))){case 1:y.charge=3;break;case 2:y.charge=2;break;case 3:y.charge=1;break;case 5:y.charge=-1;break;case 6:y.charge=-2;break;case 7:y.charge=-3}f.atoms[r]=y}for(a=0;a<l;a++){m=c[4+q+a];y=parseInt(m.substring(6,9));r=parseInt(m.substring(9,12));if(3<y)switch(y){case 4:y=1.5;break;default:y=1}m=new v.Bond(f.atoms[parseInt(m.substring(0,3))-1],f.atoms[parseInt(m.substring(3,
6))-1],y);switch(r){case 3:m.stereo=v.Bond.STEREO_AMBIGUOUS;break;case 1:m.stereo=v.Bond.STEREO_PROTRUDING;break;case 6:m.stereo=v.Bond.STEREO_RECESSED}f.bonds[a]=m}}else if(3===m)for(q=4,l=c.length;q<l;q++)if(y=c[q].trim(),y.startsWith("M  V30 "))if(y=y.substring(7),y.startsWith("BEGIN "))r=y.substring(6);else if(y.startsWith("END "))r=k;else if(m=y.split(/(\s+)/).filter(function(t){return 0<t.trim().length}),"ATOM"===r){y=new v.Atom(m[1],parseFloat(m[2])*a,(1===a?1:-1)*parseFloat(m[3])*a,parseFloat(m[4])*
a);w=6;for(var A=m.length;w<A;w++){var G=m[w],b=G.indexOf("=");if(-1!==b){var g=G.substring(0,b);G=G.substring(b+1);"CHG"===g?y.charge=parseInt(G):"RAD"===g?y.numRadical=parseInt(G):"MASS"===g&&(y.mass=parseInt(G))}}f.atoms.push(y)}else if("BOND"===r){y=parseInt(m[1]);if(3<y)switch(y){case 4:y=1.5;break;default:y=1}y=new v.Bond(f.atoms[parseInt(m[2])-1],f.atoms[parseInt(m[3])-1],y);w=4;for(A=m.length;w<A;w++)if(G=m[w],b=G.indexOf("="),-1!==b&&(g=G.substring(0,b),G=G.substring(b+1),"CFG"===g))switch(parseInt(G)){case 2:y.stereo=
v.Bond.STEREO_AMBIGUOUS;break;case 1:y.stereo=v.Bond.STEREO_PROTRUDING;break;case 3:y.stereo=v.Bond.STEREO_RECESSED}f.bonds.push(y)}else if("COLLECTION"===r)if(y.startsWith("MDLV30/STEREL"))for(y=y.substring(13),w=y.indexOf(" "),m=parseInt(y.substring(0,w)),y=y.substring(w+1),y=y.substring(7,y.length-1),y=y.split(/(\s+)/).filter(function(t){return 0<t.trim().length}),w=1,A=y.length;w<A;w++)f.atoms[parseInt(y[w])-1].enhancedStereo={type:v.Atom.ESTEREO_OR,group:m};else if(y.startsWith("MDLV30/STERAC"))for(y=
y.substring(13),w=y.indexOf(" "),m=parseInt(y.substring(0,w)),y=y.substring(w+1),y=y.substring(7,y.length-1),y=y.split(/(\s+)/).filter(function(t){return 0<t.trim().length}),w=1,A=y.length;w<A;w++)f.atoms[parseInt(y[w])-1].enhancedStereo={type:v.Atom.ESTEREO_AND,group:m};return f};p.write=function(c,a){var f=[];f.push("Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");f.push(this.fit(c.atoms.length.toString(),3));f.push(this.fit(c.bonds.length.toString(),3));f.push("  0  0  0  0            999 V"+
this.version+"000\n");var m=c.getCenter();if(2===this.version){for(var q=0,l=c.atoms.length;q<l;q++){var r=c.atoms[q],y=" 0";if(-1!==r.mass&&E[r.label]){var w=r.mass-E[r.label].mass;5>w&&-4<w&&(y=(-1<w?" ":"")+w)}w="  0";if(0!==r.charge)switch(r.charge){case 3:w="  1";break;case 2:w="  2";break;case 1:w="  3";break;case -1:w="  5";break;case -2:w="  6";break;case -3:w="  7"}var A=0,G=0;if("undefined"!==typeof a)for(var b=0,g=a.length;b<g;b++)a[b]instanceof v.d2.AtomMapping&&(A++,r===a[b].o1||r===
a[b].o2)&&(G=A);f.push(this.fit(((r.x-m.x)/n.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));f.push(this.fit((-(r.y-m.y)/n.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));f.push(this.fit((r.z/n.DEFAULT_STYLES.bondLength_2D).toFixed(4),10));f.push(" ");f.push(this.fit(r.label,3,!0));f.push(y);f.push(w);f.push("  0  0  0  0  0  0  0");f.push(this.fit(G.toString(),3));f.push("  0  0\n")}q=0;for(l=c.bonds.length;q<l;q++){a=c.bonds[q];m=0;a.stereo===v.Bond.STEREO_AMBIGUOUS?m=3:a.stereo===v.Bond.STEREO_PROTRUDING?
m=1:a.stereo===v.Bond.STEREO_RECESSED&&(m=6);f.push(this.fit((c.atoms.indexOf(a.a1)+1).toString(),3));f.push(this.fit((c.atoms.indexOf(a.a2)+1).toString(),3));a=a.bondOrder;if(1.5==a)a=4;else if(3<a||0!=a%1)a=1;f.push(this.fit(a.toString(),3));f.push("  ");f.push(m);f.push("  0  0  0\n")}}else if(3===this.version){f.push("M  V30 BEGIN CTAB\n");f.push("M  V30 COUNTS ");f.push(c.atoms.length);f.push(" ");f.push(c.bonds.length);f.push(" 0 0 0\n");f.push("M  V30 BEGIN ATOM\n");a=0;for(r=c.atoms.length;a<
r;a++)y=c.atoms[a],f.push("M  V30 "),f.push(a+1),f.push(" "),f.push(y.label),f.push(" "),f.push(((y.x-m.x)/n.DEFAULT_STYLES.bondLength_2D).toFixed(6)),f.push(" "),f.push((-(y.y-m.y)/n.DEFAULT_STYLES.bondLength_2D).toFixed(6)),f.push(" "),f.push((y.z/n.DEFAULT_STYLES.bondLength_2D).toFixed(6)),f.push(" 0"),0!==y.charge&&(f.push(" CHG="),f.push(y.charge)),0!==y.numRadical&&(f.push(" RAD="),f.push(y.numRadical)),-1!==y.mass&&(f.push(" MASS="),f.push(y.mass)),f.push("\n");f.push("M  V30 END ATOM\n");
f.push("M  V30 BEGIN BOND\n");m=0;for(a=c.bonds.length;m<a;m++){r=c.bonds[m];y=r.bondOrder;if(1.5==y)y=4;else if(3<y||0!=y%1)y=1;f.push("M  V30 ");f.push(m+1);f.push(" ");f.push(y);f.push(" ");f.push(c.atoms.indexOf(r.a1)+1);f.push(" ");f.push(c.atoms.indexOf(r.a2)+1);r.stereo!==v.Bond.STEREO_NONE&&(y=0,r.stereo===v.Bond.STEREO_AMBIGUOUS?y=2:r.stereo===v.Bond.STEREO_PROTRUDING?y=1:r.stereo===v.Bond.STEREO_RECESSED&&(y=3),f.push(" CFG="),f.push(y));f.push("\n")}f.push("M  V30 END BOND\n");m=0;for(a=
c.atoms.length;m<a;m++)if(r=c.atoms[m],r.enhancedStereo.type!==v.Atom.ESTEREO_ABSOLUTE){l||(l=[],q=[]);y=void 0;r.enhancedStereo.type===v.Atom.ESTEREO_AND?y=l:r.enhancedStereo.type===v.Atom.ESTEREO_OR&&(y=q);w=void 0;A=0;for(G=y.length;A<G;A++)if(b=y[A],b.group==r.enhancedStereo.group){w=b;break}w||(w={group:r.enhancedStereo.group,list:[]},y.push(w));w.list.push(r)}if(l&&(0<l.length||0<q.length)){f.push("M  V30 BEGIN COLLECTION\n");if(0<l.length)for(m=0,a=l.length;m<a;m++){r=l[m];f.push("M  V30 MDLV30/STERAC");
f.push(r.group);f.push(" ATOMS=(");f.push(r.list.length);y=0;for(w=r.list.length;y<w;y++)f.push(" "),f.push(c.atoms.indexOf(r.list[y])+1);f.push(")\n")}if(0<q.length)for(l=0,m=q.length;l<m;l++){a=q[l];f.push("M  V30 MDLV30/STEREL");f.push(a.group);f.push(" ATOMS=(");f.push(a.list.length);r=0;for(y=a.list.length;r<y;r++)f.push(" "),f.push(c.atoms.indexOf(a.list[r])+1);f.push(")\n")}f.push("M  V30 END COLLECTION\n")}f.push("M  V30 END CTAB\n")}f.push("M  END");return f.join("")};var d=new x.MOLInterpreter;
n.readMOL=function(c,a){return d.read(c,a)};n.writeMOL=function(c,a){return d.write(c,a)};var e=new x.MOLInterpreter;e.version=3;n.writeMOLV3=function(c){return e.write(c)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures);
(function(n,E,x,v,k,p,d){function e(a,f,m,q,l){for(var r=0,y=f.length;r<y;r++){var w=f[r];if(w.id===m&&q>=w.start&&q<=w.end){l?a.helix=!0:a.sheet=!0;q===w.end&&(a.arrow=!0);break}}}E.PDBInterpreter=function(){};d=E.PDBInterpreter.prototype=new E._Interpreter;d.calculateRibbonDistances=!1;d.deduceResidueBonds=!1;d.read=function(a,f){var m=new x.Molecule;m.chains=[];if(!a)return m;var q=a.split("\n");f||(f=1);var l=[],r=[],y=[];a=[];for(var w=[],A=0,G=q.length;A<G;A++){var b=q[A];if(b.startsWith("HELIX"))l.push({id:b.substring(19,
20),start:parseInt(b.substring(21,25)),end:parseInt(b.substring(33,37))});else if(b.startsWith("SHEET"))r.push({id:b.substring(21,22),start:parseInt(b.substring(22,26)),end:parseInt(b.substring(33,37))});else if(b.startsWith("ATOM")){var g=b.substring(16,17);if(" "===g||"A"===g){g=k(b.substring(76,78));if(0===g.length){var t=k(b.substring(12,14));"HD"===t?g="H":0<t.length&&(g=1<t.length?t.charAt(0)+t.substring(1).toLowerCase():t)}g=new x.Atom(g,parseFloat(b.substring(30,38))*f,parseFloat(b.substring(38,
46))*f,parseFloat(b.substring(46,54))*f);g.hetatm=!1;a.push(g);t=parseInt(b.substring(22,26));if(0===y.length)for(var B=0;3>B;B++){var F=new x.Residue(-1);F.cp1=g;F.cp2=g;y.push(F)}y[y.length-1].resSeq!==t&&(B=new x.Residue(t),B.name=k(b.substring(17,20)),3===B.name.length?B.name=B.name.substring(0,1)+B.name.substring(1).toLowerCase():2===B.name.length&&"D"===B.name.charAt(0)&&(B.name=B.name.substring(1)),y.push(B),F=b.substring(21,22),e(B,l,F,t,!0),e(B,r,F,t,!1));b=k(b.substring(12,16));t=y[y.length-
1];if("CA"===b||"P"===b||"O5'"===b)t.cp1||(t.cp1=g);else if("N3"===b&&("C"===t.name||"U"===t.name||"T"===t.name)||"N1"===b&&("A"===t.name||"G"===t.name))t.cp3=g;else if("C2"===b)t.cp4=g;else if("C4"===b&&("C"===t.name||"U"===t.name||"T"===t.name)||"C6"===b&&("A"===t.name||"G"===t.name))t.cp5=g;else if("O"===b||"C6"===b&&("C"===t.name||"U"===t.name||"T"===t.name)||"N9"===b){if(!y[y.length-1].cp2){if("C6"===b||"N9"===b)var I=g;t.cp2=g}}else"C"===b&&(I=g)}}else if(b.startsWith("HETATM"))g=k(b.substring(76,
78)),0===g.length&&(g=k(b.substring(12,16))),1<g.length&&(g=g.substring(0,1)+g.substring(1).toLowerCase()),g=new x.Atom(g,parseFloat(b.substring(30,38))*f,parseFloat(b.substring(38,46))*f,parseFloat(b.substring(46,54))*f),g.hetatm=!0,"HOH"===k(b.substring(17,20))&&(g.isWater=!0),m.atoms.push(g),w[parseInt(k(b.substring(6,11)))]=g;else if(b.startsWith("CONECT")){if(g=parseInt(k(b.substring(6,11))),w[g])for(g=w[g],t=0;4>t;t++)if(B=k(b.substring(11+5*t,16+5*t)),0!==B.length&&(B=parseInt(B),w[B])){B=
w[B];F=!1;for(var L=0,O=m.bonds.length;L<O;L++){var S=m.bonds[L];if(S.a1===g&&S.a2===B||S.a1===B&&S.a2===g){F=!0;break}}F||m.bonds.push(new x.Bond(g,B))}}else if(b.startsWith("TER"))this.endChain(m,y,I,a),y=[];else if(b.startsWith("ENDMDL"))break}this.endChain(m,y,I,a);0===m.bonds.length&&(new n.informatics.BondDeducer).deduceCovalentBonds(m,f);if(this.deduceResidueBonds)for(f=0,I=a.length;f<I;f++)for(q=p.min(I,f+20),l=f+1;l<q;l++)r=a[f],y=a[l],r.distance3D(y)<1.1*(v[r.label].covalentRadius+v[y.label].covalentRadius)&&
m.bonds.push(new x.Bond(r,y,1));m.atoms=m.atoms.concat(a);this.calculateRibbonDistances&&this.calculateDistances(m,a);return m};d.endChain=function(a,f,m,q){if(0<f.length){var l=f[f.length-1];l.cp1||(l.cp1=q[q.length-2]);l.cp2||(l.cp2=q[q.length-1]);for(q=0;4>q;q++)l=new x.Residue(-1),l.cp1=m,l.cp2=f[f.length-1].cp2,f.push(l);a.chains.push(f)}};d.calculateDistances=function(a,f){for(var m=[],q=0,l=a.atoms.length;q<l;q++){var r=a.atoms[q];r.hetatm&&(r.isWater||m.push(r))}a=0;for(q=f.length;a<q;a++)if(l=
f[a],l.closestDistance=Number.POSITIVE_INFINITY,0===m.length)l.closestDistance=0;else{r=0;for(var y=m.length;r<y;r++)l.closestDistance=Math.min(l.closestDistance,l.distance3D(m[r]))}};var c=new E.PDBInterpreter;n.readPDB=function(a,f){return c.read(a,f)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,ChemDoodle.lib.jQuery.trim,Math);
(function(n,E,x,v,k){var p={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},d={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},e={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};E.JCAMPInterpreter=function(){};v=E.JCAMPInterpreter.prototype=new E._Interpreter;v.convertHZ2PPM=!1;v.read=function(a){this.isBreak=function(la){return p[la]!==k||d[la]!==k||e[la]!==k||" "===la||"-"===la||"+"===la};this.getValue=function(la,ra){var za=la.charAt(0);
la=la.substring(1);return p[za]!==k?parseFloat(p[za]+la):d[za]!==k?parseFloat(d[za]+la)+ra:parseFloat(la)};var f=new x.Spectrum;if(a===k||0===a.length)return f;a=a.split("\n");for(var m=[],q,l,r,y,w=1,A=1,G=1,b=-1,g=-1,t=!0,B=!1,F=0,I=a.length;F<I;F++){var L=a[F].trim(),O=L.indexOf("$$");-1!==O&&(L=L.substring(0,O));if(0!==m.length&&a[F].startsWith("##"))if(O=m.join(""),t&&100>O.length&&f.metadata.push(O),m=[L],O.startsWith("##TITLE="))f.title=O.substring(8).trim();else if(O.startsWith("##XUNITS="))f.xUnit=
O.substring(9).trim(),this.convertHZ2PPM&&"HZ"===f.xUnit.toUpperCase()&&(f.xUnit="PPM",B=!0);else if(O.startsWith("##YUNITS="))f.yUnit=O.substring(9).trim();else{if(!O.startsWith("##XYPAIRS="))if(O.startsWith("##FIRSTX="))l=parseFloat(O.substring(9).trim());else if(O.startsWith("##LASTX="))q=parseFloat(O.substring(8).trim());else if(O.startsWith("##FIRSTY="))r=parseFloat(O.substring(9).trim());else if(O.startsWith("##NPOINTS="))y=parseFloat(O.substring(10).trim());else if(O.startsWith("##XFACTOR="))w=
parseFloat(O.substring(10).trim());else if(O.startsWith("##YFACTOR="))A=parseFloat(O.substring(10).trim());else if(O.startsWith("##DELTAX="))parseFloat(O.substring(9).trim());else if(O.startsWith("##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(G=parseFloat(O.substring(21).trim()));else if(O.startsWith("##.SHIFT REFERENCE="))this.convertHZ2PPM&&(g=O.substring(19).split(","),b=parseInt(g[2].trim()),g=parseFloat(g[3].trim()));else if(O.startsWith("##XYDATA=")){B||(G=1);L=t=!1;O=O.split("\n");for(var S=
(q-l)/(y-1),W=l-S,V=r,Z=0,ba=void 0,X=1,ea=O.length;X<ea;X++){var Y=[];W=O[X].trim();var aa=[],da=0;for(V=W.length;da<V;da++)this.isBreak(W.charAt(da))?(0<aa.length&&(1!==aa.length||" "!==aa[0])&&Y.push(aa.join("")),aa=[W.charAt(da)]):aa.push(W.charAt(da));Y.push(aa.join(""));W=parseFloat(Y[0])*w-S;aa=1;for(da=Y.length;aa<da;aa++)if(V=Y[aa],e[V.charAt(0)]!==k)for(var ia=parseInt(e[V.charAt(0)]+V.substring(1))-1,ja=0;ja<ia;ja++)W+=S,Z=this.getValue(ba,Z),V=Z*A,f.data[f.data.length-1]=new x.Point(W/
G,V);else p[V.charAt(0)]!==k&&L?V=this.getValue(V,Z)*A:(L=d[V.charAt(0)]!==k,ba=V,W+=S,Z=this.getValue(V,Z),V=Z*A,f.data.push(new x.Point(W/G,V)))}if(-1!==b)for(L=g-f.data[b-1].x,O=0,S=f.data.length;O<S;O++)f.data[O].x+=L}else if(O.startsWith("##PEAK TABLE="))for(t=!1,f.continuous=!1,L=O.split("\n"),O=/[\s,]+/,S=1,Z=L.length;S<Z;S++)for(ba=L[S].split(O),X=0,ea=ba.length;X+1<ea;X+=2)f.data.push(new x.Point(parseFloat(ba[X].trim()),parseFloat(ba[X+1].trim())));else if(O.startsWith("##ATOMLIST="))for(f.molecule=
new x.Molecule,L=O.split("\n"),O=/[\s]+/,S=1,Z=L.length;S<Z;S++)ba=L[S].split(O),f.molecule.atoms.push(new x.Atom(ba[1]));else if(O.startsWith("##BONDLIST="))for(L=O.split("\n"),O=/[\s]+/,S=1,Z=L.length;S<Z;S++)ba=L[S].split(O),X=1,"D"===ba[2]?X=2:"T"===ba[2]&&(X=3),f.molecule.bonds.push(new x.Bond(f.molecule.atoms[parseInt(ba[0])-1],f.molecule.atoms[parseInt(ba[1])-1],X));else if(f.molecule&&O.startsWith("##XY_RASTER=")){L=O.split("\n");O=/[\s]+/;S=1;for(Z=L.length;S<Z;S++)ba=L[S].split(O),X=f.molecule.atoms[parseInt(ba[0])-
1],X.x=parseInt(ba[1]),X.y=parseInt(ba[2]),4==ba.length&&(X.z=parseInt(ba[3]));f.molecule.scaleToAverageBondLength(20)}else if(O.startsWith("##PEAK ASSIGNMENTS="))for(L=O.split("\n"),O=/[\s,()<>]+/,f.assignments=[],S=1,Z=L.length;S<Z;S++){ea=L[S].split(O);ba=parseFloat(ea[1]);X=parseFloat(ea[2]);ea=f.molecule.atoms[parseInt(ea[3])-1];Y=!1;W=0;for(aa=f.assignments.length;W<aa;W++)if(da=f.assignments[W],da.x===ba){da.as.push(ea);ea.assigned=da;Y=!0;break}Y||(ba={x:ba,y:X,as:[ea]},ea.assigned=ba,f.assignments.push(ba))}}else L=
L.trim(),0!==m.length&&0!==L.length&&m.push("\n"),m.push(L)}f.setup();return f};v.makeStructureSpectrumSet=function(a,f){this.convertHZ2PPM=!0;var m=this.read(f),q=new n.ViewerCanvas(a+"_molecule",200,200);q.styles.atoms_displayTerminalCarbonLabels_2D=!0;q.styles.atoms_displayImplicitHydrogens_2D=!0;q.mouseout=function(r){if(0!==this.molecules.length){r=0;for(var y=this.molecules[0].atoms.length;r<y;r++)this.molecules[0].atoms[r].isHover=!1;m.hovered=k;this.repaint();l.repaint()}};q.touchend=q.mouseout;
q.mousemove=function(r){if(0!==this.molecules.length){for(var y=k,w=0,A=this.molecules[0].atoms.length;w<A;w++){var G=this.molecules[0].atoms[w];G.isHover=!1;G.assigned&&(y===k||r.p.distance(G)<r.p.distance(y))&&(y=G)}m.hovered=k;if(20>r.p.distance(y)){r=0;for(w=y.assigned.as.length;r<w;r++)y.assigned.as[r].isHover=!0;l.spectrum.hovered=y.assigned}this.repaint();l.repaint()}};q.touchmove=q.mousemove;q.drawChildExtras=function(r,y){if(0!==this.molecules.length)for(var w=0,A=this.molecules[0].atoms.length;w<
A;w++)this.molecules[0].atoms[w].drawDecorations(r,y)};var l=new n.ObserverCanvas(a+"_spectrum",400,200);l.styles.plots_showYAxis=!1;l.styles.plots_flipXAxis=!0;l.mouseout=function(r){if(this.spectrum&&this.spectrum.assignments){r=0;for(var y=q.molecules[0].atoms.length;r<y;r++)q.molecules[0].atoms[r].isHover=!1;this.spectrum.hovered=k;q.repaint();this.repaint()}};l.touchend=l.mouseout;l.mousemove=function(r){if(this.spectrum&&this.spectrum.assignments){for(var y=k,w=0,A=q.molecules[0].atoms.length;w<
A;w++)q.molecules[0].atoms[w].isHover=!1;this.spectrum.hovered=k;w=0;for(A=this.spectrum.assignments.length;w<A;w++){var G=this.spectrum.assignments[w];if(y===k||Math.abs(this.spectrum.getTransformedX(G.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-r.p.x)<Math.abs(this.spectrum.getTransformedX(y.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-r.p.x))y=G}if(20>Math.abs(this.spectrum.getTransformedX(y.x,this.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft)-
r.p.x)){r=0;for(w=y.as.length;r<w;r++)y.as[r].isHover=!0;this.spectrum.hovered=y}q.repaint();this.repaint()}};l.touchmove=l.mousemove;l.drawChildExtras=function(r){if(this.spectrum&&this.spectrum.hovered){var y=this.spectrum.getTransformedX(this.spectrum.hovered.x,l.styles,this.spectrum.memory.width,this.spectrum.memory.offsetLeft);y>=this.spectrum.memory.offsetLeft&&y<this.spectrum.memory.width&&(r.save(),r.strokeStyle="#885110",r.lineWidth=3,r.beginPath(),r.moveTo(y,this.spectrum.memory.height-
this.spectrum.memory.offsetBottom),r.lineTo(y,this.spectrum.getTransformedY(this.spectrum.hovered.y,l.styles,this.spectrum.memory.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)),r.stroke(),r.restore())}};m&&(l.loadSpectrum(m),m.molecule&&q.loadMolecule(m.molecule));return[q,l]};var c=new E.JCAMPInterpreter;c.convertHZ2PPM=!0;n.readJCAMP=function(a){return c.read(a)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery);
(function(n,E,x,v,k,p,d){E.JSONInterpreter=function(){};var e=E.JSONInterpreter.prototype;e.contentTo=function(a,f){a||(a=[]);f||(f=[]);for(var m=0,q=0,l=0,r=a.length;l<r;l++){for(var y=a[l],w=0,A=y.atoms.length;w<A;w++)y.atoms[w].tmpid="a"+m++;w=0;for(A=y.bonds.length;w<A;w++)y.bonds[w].tmpid="b"+q++}q=m=0;for(l=f.length;q<l;q++)f[q].tmpid="s"+m++;m={};if(a&&0<a.length)for(m.m=[],q=0,l=a.length;q<l;q++)m.m.push(this.molTo(a[q]));if(f&&0<f.length)for(m.s=[],q=0,l=f.length;q<l;q++)m.s.push(this.shapeTo(f[q]));
q=0;for(l=a.length;q<l;q++){r=a[q];y=0;for(w=r.atoms.length;y<w;y++)r.atoms[y].tmpid=d;y=0;for(w=r.bonds.length;y<w;y++)r.bonds[y].tmpid=d}a=0;for(q=f.length;a<q;a++)f[a].tmpid=d;return m};e.contentFrom=function(a){var f={molecules:[],shapes:[]};if(a.m)for(var m=0,q=a.m.length;m<q;m++)f.molecules.push(this.molFrom(a.m[m]));if(a.s)for(m=0,q=a.s.length;m<q;m++)f.shapes.push(this.shapeFrom(a.s[m],f.molecules));a=0;for(m=f.molecules.length;a<m;a++){q=f.molecules[a];for(var l=0,r=q.atoms.length;l<r;l++)q.atoms[l].tmpid=
d;l=0;for(r=q.bonds.length;l<r;l++)q.bonds[l].tmpid=d}a=0;for(m=f.shapes.length;a<m;a++)f.shapes[a].tmpid=d;return f};e.queryTo=function(a){var f={},m=function(q,l,r,y){l&&(q[r]={v:y?a.outputRange(l.v):l.v,n:l.not})};a.type===x.Query.TYPE_ATOM?(m(f,a.elements,"as"),m(f,a.chirality,"@"),m(f,a.aromatic,"A"),m(f,a.charge,"C",!0),m(f,a.hydrogens,"H",!0),m(f,a.ringCount,"R",!0),m(f,a.saturation,"S"),m(f,a.connectivity,"X",!0),m(f,a.connectivityNoH,"x",!0)):(m(f,a.orders,"bs"),m(f,a.stereo,"@"),m(f,a.aromatic,
"A"),m(f,a.ringCount,"R",!0));return f};e.molTo=function(a){for(var f={a:[]},m=0,q=a.atoms.length;m<q;m++){var l=a.atoms[m],r={x:l.x,y:l.y};l.tmpid&&(r.i=l.tmpid);"C"!==l.label&&(r.l=l.label);0!==l.z&&(r.z=l.z);0!==l.charge&&(r.c=l.charge);-1!==l.mass&&(r.m=l.mass);-1!==l.implicitH&&(r.h=l.implicitH);0!==l.numRadical&&(r.r=l.numRadical);0!==l.numLonePair&&(r.p=l.numLonePair);l.enhancedStereo&&l.enhancedStereo.type!==x.Atom.ESTEREO_ABSOLUTE&&(r.s2={t:l.enhancedStereo.type},1<l.enhancedStereo.group&&
(r.s2.g=l.enhancedStereo.group));l.query&&(r.q=this.queryTo(l.query));f.a.push(r)}if(0<a.bonds.length)for(f.b=[],m=0,q=a.bonds.length;m<q;m++)l=a.bonds[m],r={b:a.atoms.indexOf(l.a1),e:a.atoms.indexOf(l.a2)},l.tmpid&&(r.i=l.tmpid),1!==l.bondOrder&&(r.o=l.bondOrder),l.stereo!==x.Bond.STEREO_NONE&&(r.s=l.stereo),l.query&&(r.q=this.queryTo(l.query)),f.b.push(r);return f};e.queryFrom=function(a){var f=new x.Query(a.as?x.Query.TYPE_ATOM:x.Query.TYPE_BOND),m=function(q,l,r,y){l&&(q[r]={},q[r].v=y?q.parseRange(l.v):
l.v,l.n&&(q[r].not=!0))};f.type===x.Query.TYPE_ATOM?(m(f,a.as,"elements"),m(f,a["@"],"chirality"),m(f,a.A,"aromatic"),m(f,a.C,"charge",!0),m(f,a.H,"hydrogens",!0),m(f,a.R,"ringCount",!0),m(f,a.S,"saturation"),m(f,a.X,"connectivity",!0),m(f,a.x,"connectivityNoH",!0)):(m(f,a.bs,"orders"),m(f,a["@"],"stereo"),m(f,a.A,"aromatic"),m(f,a.R,"ringCount",!0));return f};e.molFrom=function(a){for(var f=new x.Molecule,m=0,q=a.a.length;m<q;m++){var l=a.a[m],r=new x.Atom(l.l?l.l:"C",l.x,l.y);l.i&&(r.tmpid=l.i);
l.z&&(r.z=l.z);l.c&&(r.charge=l.c);l.m&&(r.mass=l.m);l.h&&(r.implicitH=l.h);l.r&&(r.numRadical=l.r);l.p&&(r.numLonePair=l.p);l.s2&&(r.enhancedStereo={type:l.s2.t,group:l.s2.g===d?1:l.s2.g});l.q&&(r.query=this.queryFrom(l.q));l.p_h!==d&&(r.hetatm=l.p_h);l.p_w!==d&&(r.isWater=l.p_w);l.p_d!==d&&(r.closestDistance=l.p_d);f.atoms.push(r)}if(a.b)for(m=0,q=a.b.length;m<q;m++)l=a.b[m],r=new x.Bond(f.atoms[l.b],f.atoms[l.e],l.o===d?1:l.o),l.i&&(r.tmpid=l.i),l.s&&(r.stereo=l.s),l.q&&(r.query=this.queryFrom(l.q)),
f.bonds.push(r);return f};e.shapeTo=function(a){var f={};a.tmpid&&(f.i=a.tmpid);if(a instanceof v.Line)f.t="Line",f.x1=a.p1.x,f.y1=a.p1.y,f.x2=a.p2.x,f.y2=a.p2.y,f.a=a.arrowType;else if(a instanceof v.Pusher)f.t="Pusher",f.o1=a.o1.tmpid,f.o2=a.o2.tmpid,1!==a.numElectron&&(f.e=a.numElectron);else if(a instanceof v.AtomMapping)f.t="AtomMapping",f.a1=a.o1.tmpid,f.a2=a.o2.tmpid;else if(a instanceof v.Bracket)f.t="Bracket",f.x1=a.p1.x,f.y1=a.p1.y,f.x2=a.p2.x,f.y2=a.p2.y,0!==a.charge&&(f.c=a.charge),0!==
a.mult&&(f.m=a.mult),0!==a.repeat&&(f.r=a.repeat);else if(a instanceof v.RepeatUnit)f.t="RepeatUnit",f.b1=a.b1.tmpid,f.b2=a.b2.tmpid,f.n1=a.n1,f.n2=a.n2,!0===a.flip&&(f.f=!0);else if(a instanceof v.VAP){f.t="VAP";f.x=a.asterisk.x;f.y=a.asterisk.y;1!==a.bondType&&(f.o=a.bondType);a.substituent&&(f.s=a.substituent.tmpid);f.a=[];for(var m=0,q=a.attachments.length;m<q;m++)f.a.push(a.attachments[m].tmpid)}else if(a instanceof k.Distance)f.t="Distance",f.a1=a.a1.tmpid,f.a2=a.a2.tmpid,a.node&&(f.n=a.node,
f.o=a.offset);else if(a instanceof k.Angle)f.t="Angle",f.a1=a.a1.tmpid,f.a2=a.a2.tmpid,f.a3=a.a3.tmpid;else if(a instanceof k.Torsion)f.t="Torsion",f.a1=a.a1.tmpid,f.a2=a.a2.tmpid,f.a3=a.a3.tmpid,f.a4=a.a4.tmpid;else if(a instanceof k._Surface){f.t="Surface";f.a=[];m=0;for(q=a.atoms.length;m<q;m++)f.a.push(a.atoms[m].tmpid);a instanceof k.VDWSurface||(f.p=a.probeRadius);f.r=a.resolution;m="vdw";a instanceof k.SASSurface?m="sas":k.SESSurface&&a instanceof k.SESSurface&&(m="ses");f.f=m}else a instanceof
k.UnitCell&&(f.t="UnitCell",f.ls=a.lengths,f.as=a.angles,f.os=a.offset);return f};e.shapeFrom=function(a,f){if("Line"===a.t){var m=new v.Line(new x.Point(a.x1,a.y1),new x.Point(a.x2,a.y2));m.arrowType=a.a}else if("Pusher"===a.t){var q,l;m=0;for(var r=f.length;m<r;m++){for(var y=f[m],w=0,A=y.atoms.length;w<A;w++){var G=y.atoms[w];G.tmpid===a.o1?q=G:G.tmpid===a.o2&&(l=G)}w=0;for(A=y.bonds.length;w<A;w++)G=y.bonds[w],G.tmpid===a.o1?q=G:G.tmpid===a.o2&&(l=G)}m=new v.Pusher(q,l);a.e&&(m.numElectron=a.e)}else if("AtomMapping"===
a.t){m=0;for(q=f.length;m<q;m++)for(l=f[m],w=0,A=l.atoms.length;w<A;w++)G=l.atoms[w],G.tmpid===a.a1?r=G:G.tmpid===a.a2&&(y=G);m=new v.AtomMapping(r,y)}else if("Bracket"===a.t)m=new v.Bracket(new x.Point(a.x1,a.y1),new x.Point(a.x2,a.y2)),a.c!==d&&(m.charge=a.c),a.m!==d&&(m.mult=a.m),a.r!==d&&(m.repeat=a.r);else if("RepeatUnit"===a.t||"DynamicBracket"===a.t){m=0;for(q=f.length;m<q;m++)for(l=f[m],r=0,y=l.bonds.length;r<y;r++)G=l.bonds[r],G.tmpid===a.b1?w=G:G.tmpid===a.b2&&(A=G);m=new v.RepeatUnit(w,
A);m.n1=a.n1;m.n2=a.n2;a.f&&(m.flip=!0)}else if("VAP"===a.t)for(m=new v.VAP(a.x,a.y),a.o&&(m.bondType=a.o),q=0,l=f.length;q<l;q++)for(r=f[q],y=0,w=r.atoms.length;y<w;y++)if(A=r.atoms[y],A.tmpid===a.s)m.substituent=A;else{G=0;for(var b=a.a.length;G<b;G++)A.tmpid===a.a[G]&&m.attachments.push(A)}else if("Distance"===a.t){m=0;for(q=f.length;m<q;m++)for(l=f[m],r=0,y=l.atoms.length;r<y;r++)w=l.atoms[r],w.tmpid===a.a1?G=w:w.tmpid===a.a2&&(b=w);m=new k.Distance(G,b,a.n,a.o)}else if("Angle"===a.t){var g,t,
B;m=0;for(q=f.length;m<q;m++)for(l=f[m],r=0,y=l.atoms.length;r<y;r++)w=l.atoms[r],w.tmpid===a.a1?g=w:w.tmpid===a.a2?t=w:w.tmpid===a.a3&&(B=w);m=new k.Angle(g,t,B)}else if("Torsion"===a.t){var F,I,L,O;m=0;for(q=f.length;m<q;m++)for(l=f[m],r=0,y=l.atoms.length;r<y;r++)w=l.atoms[r],w.tmpid===a.a1?F=w:w.tmpid===a.a2?I=w:w.tmpid===a.a3?L=w:w.tmpid===a.a4&&(O=w);m=new k.Torsion(F,I,L,O)}else if("Surface"===a.t){q=[];l=0;for(r=f.length;l<r;l++)for(y=f[l],w=0,A=y.atoms.length;w<A;w++)for(G=y.atoms[w],b=0,
g=a.a.length;b<g;b++)G.tmpid===a.a[b]&&q.push(G);f=a.p?a.p:1.4;l=a.r?a.r:30;"vdw"===a.f?m=new k.VDWSurface(q,l):"sas"===a.f?m=new k.SASSurface(q,f,l):"ses"===a.f&&(m=new k.SESSurface(q,f,l))}else"UnitCell"===a.t&&(m=new k.UnitCell(a.ls,a.as,a.os));return m};e.pdbFrom=function(a){var f=this.molFrom(a.mol);f.findRings=!1;f.fromJSON=!0;f.chains=this.chainsFrom(a.ribbons);return f};e.chainsFrom=function(a){for(var f=[],m=0,q=a.cs.length;m<q;m++){for(var l=a.cs[m],r=[],y=0,w=l.length;y<w;y++){var A=l[y],
G=new x.Residue;G.name=A.n;G.cp1=new x.Atom("",A.x1,A.y1,A.z1);G.cp2=new x.Atom("",A.x2,A.y2,A.z2);A.x3&&(G.cp3=new x.Atom("",A.x3,A.y3,A.z3),G.cp4=new x.Atom("",A.x4,A.y4,A.z4),G.cp5=new x.Atom("",A.x5,A.y5,A.z5));G.helix=A.h;G.sheet=A.s;G.arrow=0<y&&l[y-1].a;r.push(G)}f.push(r)}return f};var c=new E.JSONInterpreter;n.readJSON=function(a){try{var f=p.parse(a)}catch(m){return d}return f?f.m||f.s?c.contentFrom(f):f.a?{molecules:[c.molFrom(f)],shapes:[]}:{molecules:[],shapes:[]}:d};n.writeJSON=function(a,
f){return p.stringify(c.contentTo(a,f))}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.structures.d2,ChemDoodle.structures.d3,JSON);
(function(n,E,x,v){E.RXNInterpreter=function(){};var k=E.RXNInterpreter.prototype=new E._Interpreter;k.read=function(d,e){e||(e=n.DEFAULT_STYLES.bondLength_2D);var c=[];if(d){var a=d.split("$MOL\n");d=a[0].split("\n")[4];for(var f=parseInt(d.substring(0,3)),m=parseInt(d.substring(3,6)),q=1,l=d=0,r=f+m;l<r;l++){c[l]=n.readMOL(a[q],e);var y=c[l].getBounds();d-=y.maxX-y.minX+40;q++}for(e=0;e<f;e++){a=c[e].getBounds();a=a.maxX-a.minX;q=c[e].getCenter();l=0;for(r=c[e].atoms.length;l<r;l++)y=c[e].atoms[l],
y.x+=d+a/2-q.x,y.y-=q.y;d+=a+40}e=new x.d2.Line(new x.Point(d,0),new x.Point(d+40,0));d+=80;a=f;for(f+=m;a<f;a++){m=c[a].getBounds();m=m.maxX-m.minX;q=c[a].getCenter();for(l=0;l<c[a].atoms.length;l++)r=c[a].atoms[l],r.x+=d+m/2-q.x,r.y-=q.y;d+=m+40}}else c.push(new x.Molecule),e=new x.d2.Line(new x.Point(-20,0),new x.Point(20,0));e.arrowType=x.d2.Line.ARROW_SYNTHETIC;return{molecules:c,shapes:[e]}};k.write=function(d,e){var c=v;if(d&&e){for(var a=0,f=e.length;a<f;a++)if(e[a]instanceof x.d2.Line){c=
e[a];break}if(!c)return"";d=(new x.Reaction).resolve(c,d);c=[];c.push("$RXN\nReaction from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n");c.push(this.fit(d.reactants.length.toString(),3));c.push(this.fit(d.products.length.toString(),3));c.push("\n");a=0;for(f=d.reactants.length;a<f;a++)c.push("$MOL\n"),c.push(n.writeMOL(d.reactants[a],e)),c.push("\n");a=0;for(f=d.products.length;a<f;a++)c.push("$MOL\n"),c.push(n.writeMOL(d.products[a],e)),c.push("\n");return c.join("")}};var p=new E.RXNInterpreter;
n.readRXN=function(d,e){return p.read(d,e)};n.writeRXN=function(d,e){return p.write(d,e)}})(ChemDoodle,ChemDoodle.io,ChemDoodle.structures);
(function(n,E,x,v,k,p,d){v.XYZInterpreter=function(){};E=v.XYZInterpreter.prototype=new v._Interpreter;E.deduceCovalentBonds=!0;E.read=function(c){var a=new k.Molecule;if(!c)return a;c=c.split("\n");for(var f=parseInt(p(c[0])),m=0;m<f;m++){var q=c[m+2].split(/\s+/g);a.atoms[m]=new k.Atom(isNaN(q[0])?q[0]:x[parseInt(q[0])-1],parseFloat(q[1]),parseFloat(q[2]),parseFloat(q[3]))}this.deduceCovalentBonds&&(new n.informatics.BondDeducer).deduceCovalentBonds(a,1);return a};var e=new v.XYZInterpreter;n.readXYZ=
function(c){return e.read(c)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery.trim);
ChemDoodle.monitor=function(n,E,x,v){var k={};k.CANVAS_DRAGGING=v;k.CANVAS_OVER=v;k.ALT=!1;k.SHIFT=!1;k.META=!1;n.supports_touch()||E(x).ready(function(){E(x).mousemove(function(p){k.CANVAS_DRAGGING&&k.CANVAS_DRAGGING.drag&&(k.CANVAS_DRAGGING.prehandleEvent(p),k.CANVAS_DRAGGING.drag(p))});E(x).mouseup(function(p){k.CANVAS_DRAGGING&&k.CANVAS_DRAGGING!==k.CANVAS_OVER&&k.CANVAS_DRAGGING.mouseup&&(k.CANVAS_DRAGGING.prehandleEvent(p),k.CANVAS_DRAGGING.mouseup(p));k.CANVAS_DRAGGING=v});E(x).keydown(function(p){k.SHIFT=
p.shiftKey;k.ALT=p.altKey;k.META=p.metaKey||p.ctrlKey;var d=k.CANVAS_OVER;k.CANVAS_DRAGGING&&(d=k.CANVAS_DRAGGING);d&&d.keydown&&(d.prehandleEvent(p),d.keydown(p))});E(x).keypress(function(p){var d=k.CANVAS_OVER;k.CANVAS_DRAGGING&&(d=k.CANVAS_DRAGGING);d&&d.keypress&&(d.prehandleEvent(p),d.keypress(p))});E(x).keyup(function(p){k.SHIFT=p.shiftKey;k.ALT=p.altKey;k.META=p.metaKey||p.ctrlKey;var d=k.CANVAS_OVER;k.CANVAS_DRAGGING&&(d=k.CANVAS_DRAGGING);d&&d.keyup&&(d.prehandleEvent(p),d.keyup(p))})});
return k}(ChemDoodle.featureDetection,ChemDoodle.lib.jQuery,document);
(function(n,E,x,v,k,p,d,e,c,a,f){n._Canvas=function(){};var m=n._Canvas.prototype;m.molecules=f;m.shapes=f;m.emptyMessage=f;m.image=f;m.repaint=function(){if(!this.test){var q=e.getElementById(this.id);if(q.getContext){var l=q.getContext("2d");1!==this.pixelRatio&&q.width===this.width&&(q.width=this.width*this.pixelRatio,q.height=this.height*this.pixelRatio,l.scale(this.pixelRatio,this.pixelRatio));if(this.image)l.drawImage(this.image,0,0);else{var r=this.styles.backgroundColor?this.styles.backgroundColor:
"transparent";l.clearRect(0,0,this.width,this.height);this.bgCache!==r&&(q.style.backgroundColor=r,this.bgCache=q.style.backgroundColor);"transparent"!==r&&(l.fillStyle=r,l.fillRect(0,0,this.width,this.height))}if(this.innerRepaint)this.innerRepaint(l);else if(0!==this.molecules.length||0!==this.shapes.length){l.save();l.translate(this.width/2,this.height/2);l.rotate(this.styles.rotateAngle);l.scale(this.styles.scale,this.styles.scale);l.translate(-this.width/2,-this.height/2);q=0;for(r=this.molecules.length;q<
r;q++)this.molecules[q].check(!0),this.molecules[q].draw(l,this.styles);this.checksOnAction&&this.checksOnAction(!0);q=0;for(r=this.shapes.length;q<r;q++)this.shapes[q].draw(l,this.styles);l.restore()}else this.emptyMessage&&(l.fillStyle="#737683",l.textAlign="center",l.textBaseline="middle",l.font="18px Helvetica, Verdana, Arial, Sans-serif",l.fillText(this.emptyMessage,this.width/2,this.height/2));this.drawChildExtras&&this.drawChildExtras(l,this.styles)}}};m.resize=function(q,l){var r=p("#"+this.id);
r.attr({width:q,height:l});r.css("width",q);r.css("height",l);this.width=q;this.height=l;if(n._Canvas3D&&this instanceof n._Canvas3D)1!==this.pixelRatio&&(q*=this.pixelRatio,l*=this.pixelRatio,this.gl.canvas.width=q,this.gl.canvas.height=l),this.gl.viewport(0,0,q,l),this.afterLoadContent();else if(0<this.molecules.length)for(this.center(),l=0,q=this.molecules.length;l<q;l++)this.molecules[l].check();this.repaint()};m.setBackgroundImage=function(q){this.image=new Image;var l=this;this.image.onload=
function(){l.repaint()};this.image.src=q};m.loadMolecule=function(q){this.clear();this.molecules.push(q);for(var l=0;2>l;l++)this.center(),n._Canvas3D&&this instanceof n._Canvas3D||q.check(),this.afterLoadContent&&this.afterLoadContent(),this.repaint()};m.loadContent=function(q,l){this.molecules=q?q:[];this.shapes=l?l:[];for(q=0;2>q;q++){this.center();if(!(n._Canvas3D&&this instanceof n._Canvas3D)){l=0;for(var r=this.molecules.length;l<r;l++)this.molecules[l].check()}this.afterLoadContent&&this.afterLoadContent();
this.repaint()}};m.addMolecule=function(q){this.molecules.push(q);n._Canvas3D&&this instanceof n._Canvas3D||q.check();this.repaint()};m.removeMolecule=function(q){this.molecules=p.grep(this.molecules,function(l){return l!==q});this.repaint()};m.getMolecule=function(){return 0<this.molecules.length?this.molecules[0]:f};m.getMolecules=function(){return this.molecules};m.addShape=function(q){this.shapes.push(q);this.repaint()};m.removeShape=function(q){this.shapes=p.grep(this.shapes,function(l){return l!==
q});this.repaint()};m.getShapes=function(){return this.shapes};m.clear=function(){this.molecules=[];this.shapes=[];this.styles.scale=1;this.repaint()};m.center=function(){for(var q=this.getContentBounds(),l=new k.Point((this.width-q.minX-q.maxX)/2,(this.height-q.minY-q.maxY)/2),r=0,y=this.molecules.length;r<y;r++)for(var w=this.molecules[r],A=0,G=w.atoms.length;A<G;A++)w.atoms[A].add(l);r=0;for(y=this.shapes.length;r<y;r++)for(w=this.shapes[r].getPoints(),A=0,G=w.length;A<G;A++)w[A].add(l);this.styles.scale=
1;l=q.maxX-q.minX;q=q.maxY-q.minY;if(l>this.width-20||q>this.height-20)this.styles.scale=.85*d.min(this.width/l,this.height/q)};m.bondExists=function(q,l){for(var r=0,y=this.molecules.length;r<y;r++)for(var w=this.molecules[r],A=0,G=w.bonds.length;A<G;A++){var b=w.bonds[A];if(b.contains(q)&&b.contains(l))return!0}return!1};m.getBond=function(q,l){for(var r=0,y=this.molecules.length;r<y;r++)for(var w=this.molecules[r],A=0,G=w.bonds.length;A<G;A++){var b=w.bonds[A];if(b.contains(q)&&b.contains(l))return b}return f};
m.getMoleculeByAtom=function(q){for(var l=0,r=this.molecules.length;l<r;l++){var y=this.molecules[l];if(-1!==y.atoms.indexOf(q))return y}return c.undefined};m.getAllAtoms=function(){for(var q=[],l=0,r=this.molecules.length;l<r;l++)q=q.concat(this.molecules[l].atoms);return q};m.getAllBonds=function(){for(var q=[],l=0,r=this.molecules.length;l<r;l++)q=q.concat(this.molecules[l].bonds);return q};m.getAllPoints=function(){for(var q=[],l=0,r=this.molecules.length;l<r;l++)q=q.concat(this.molecules[l].atoms);
l=0;for(r=this.shapes.length;l<r;l++)q=q.concat(this.shapes[l].getPoints());return q};m.getContentBounds=function(){for(var q=new x.Bounds,l=0,r=this.molecules.length;l<r;l++)q.expand(this.molecules[l].getBounds());l=0;for(r=this.shapes.length;l<r;l++)q.expand(this.shapes[l].getBounds());return q};m.create=function(q,l,r){this.id=q;this.width=l;this.height=r;this.molecules=[];this.shapes=[];if(e.getElementById(q)){var y=p("#"+q);l?y.attr("width",l):this.width=parseInt(y.attr("width"));r?y.attr("height",
r):this.height=parseInt(y.attr("height"));y.attr("class","ChemDoodleWebComponent")}else if(n.featureDetection.supports_canvas_text()||-1==a.indexOf("MSIE"))e.writeln('<canvas class="ChemDoodleWebComponent" id="'+q+'" width="'+l+'" height="'+r+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>');else{e.writeln('<div style="border: 1px solid black;" width="'+l+'" height="'+r+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>');
return}q=p("#"+q);q.css("width",this.width);q.css("height",this.height);this.pixelRatio=c.devicePixelRatio?c.devicePixelRatio:1;this.styles=new k.Styles;var w=this;E.supports_touch()?(q.bind("touchstart",function(A){var G=(new Date).getTime();if(!E.supports_gesture()&&2===A.originalEvent.touches.length){var b=A.originalEvent.touches,g=new k.Point(b[0].pageX,b[0].pageY);b=new k.Point(b[1].pageX,b[1].pageY);w.implementedGestureDist=g.distance(b);w.implementedGestureAngle=g.angle(b);w.gesturestart&&
(w.prehandleEvent(A),w.gesturestart(A))}w.lastTouch&&1===A.originalEvent.touches.length&&500>G-w.lastTouch?w.dbltap?(w.prehandleEvent(A),w.dbltap(A)):w.dblclick?(w.prehandleEvent(A),w.dblclick(A)):w.touchstart?(w.prehandleEvent(A),w.touchstart(A)):w.mousedown&&(w.prehandleEvent(A),w.mousedown(A)):w.touchstart?(w.prehandleEvent(A),w.touchstart(A),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){w.touchhold(A)},1E3))):w.mousedown&&(w.prehandleEvent(A),w.mousedown(A));
w.lastTouch=G}),q.bind("touchmove",function(A){this.hold&&(clearTimeout(this.hold),this.hold=f);if(!E.supports_gesture()&&2===A.originalEvent.touches.length&&w.gesturechange){var G=A.originalEvent.touches,b=new k.Point(G[0].pageX,G[0].pageY),g=new k.Point(G[1].pageX,G[1].pageY);G=b.distance(g);b=b.angle(g);A.originalEvent.scale=G/w.implementedGestureDist;A.originalEvent.rotation=180*(w.implementedGestureAngle-b)/d.PI;w.prehandleEvent(A);w.gesturechange(A)}if(1<A.originalEvent.touches.length&&w.multitouchmove){b=
A.originalEvent.touches.length;w.prehandleEvent(A);G=new k.Point(-A.offset.left*b,-A.offset.top*b);for(g=0;g<b;g++)G.x+=A.originalEvent.changedTouches[g].pageX,G.y+=A.originalEvent.changedTouches[g].pageY;G.x/=b;G.y/=b;A.p=G;w.multitouchmove(A,b)}else w.touchmove?(w.prehandleEvent(A),w.touchmove(A)):w.drag&&(w.prehandleEvent(A),w.drag(A))}),q.bind("touchend",function(A){this.hold&&(clearTimeout(this.hold),this.hold=f);!E.supports_gesture()&&w.implementedGestureDist&&(w.implementedGestureDist=f,w.implementedGestureAngle=
f,w.gestureend&&(w.prehandleEvent(A),w.gestureend(A)));w.touchend?(w.prehandleEvent(A),w.touchend(A)):w.mouseup&&(w.prehandleEvent(A),w.mouseup(A));250>(new Date).getTime()-w.lastTouch&&(w.tap?(w.prehandleEvent(A),w.tap(A)):w.click&&(w.prehandleEvent(A),w.click(A)))}),q.bind("gesturestart",function(A){w.gesturestart&&(w.prehandleEvent(A),w.gesturestart(A))}),q.bind("gesturechange",function(A){w.gesturechange&&(w.prehandleEvent(A),w.gesturechange(A))}),q.bind("gestureend",function(A){w.gestureend&&
(w.prehandleEvent(A),w.gestureend(A))})):(q.click(function(A){switch(A.which){case 1:w.click&&(w.prehandleEvent(A),w.click(A));break;case 2:w.middleclick&&(w.prehandleEvent(A),w.middleclick(A));break;case 3:w.rightclick&&(w.prehandleEvent(A),w.rightclick(A))}}),q.dblclick(function(A){w.dblclick&&(w.prehandleEvent(A),w.dblclick(A))}),q.mousedown(function(A){switch(A.which){case 1:v.CANVAS_DRAGGING=w;w.mousedown&&(w.prehandleEvent(A),w.mousedown(A));break;case 2:w.middlemousedown&&(w.prehandleEvent(A),
w.middlemousedown(A));break;case 3:w.rightmousedown&&(w.prehandleEvent(A),w.rightmousedown(A))}}),q.mousemove(function(A){!v.CANVAS_DRAGGING&&w.mousemove&&(w.prehandleEvent(A),w.mousemove(A))}),q.mouseout(function(A){v.CANVAS_OVER=f;w.mouseout&&(w.prehandleEvent(A),w.mouseout(A))}),q.mouseover(function(A){v.CANVAS_OVER=w;w.mouseover&&(w.prehandleEvent(A),w.mouseover(A))}),q.mouseup(function(A){switch(A.which){case 1:w.mouseup&&(w.prehandleEvent(A),w.mouseup(A));break;case 2:w.middlemouseup&&(w.prehandleEvent(A),
w.middlemouseup(A));break;case 3:w.rightmouseup&&(w.prehandleEvent(A),w.rightmouseup(A))}}),q.mousewheel(function(A,G){w.mousewheel&&(w.prehandleEvent(A),w.mousewheel(A,G))}));this.subCreate&&this.subCreate()};m.prehandleEvent=function(q){q.originalEvent.changedTouches&&(q.pageX=q.originalEvent.changedTouches[0].pageX,q.pageY=q.originalEvent.changedTouches[0].pageY);q.offset=p("#"+this.id).offset();q.p=new k.Point(q.pageX-q.offset.left,q.pageY-q.offset.top);this.doEventDefault||(q.preventDefault(),
q.returnValue=!1)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.math,ChemDoodle.monitor,ChemDoodle.structures,ChemDoodle.lib.jQuery,Math,document,window,navigator.userAgent);
(function(n,E,x){n._AnimatorCanvas=function(v,k,p){v&&this.create(v,k,p)};n=n._AnimatorCanvas.prototype=new n._Canvas;n.timeout=33;n.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var v=this;this.nextFrame&&(this.handle=E.requestInterval(function(){var k=(new Date).getTime();v.nextFrame(k-v.lastTime);v.repaint();v.lastTime=k},this.timeout))};n.stopAnimation=function(){this.handle&&(E.clearRequestInterval(this.handle),this.handle=x)};n.isRunning=function(){return this.handle!==
x}})(ChemDoodle,ChemDoodle.animations);
(function(n,E,x){n.FileCanvas=function(v,k,p,d){v&&this.create(v,k,p);E.writeln('<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+d+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+v+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+v+"', "+v+')"></iframe>');this.emptyMessage="Click below to load file";this.repaint()};n.FileCanvas.prototype=
new n._Canvas})(ChemDoodle,document);
(function(n,E){n.HyperlinkCanvas=function(x,v,k,p,d,e){x&&this.create(x,v,k);this.urlOrFunction=p;this.color=d?d:"blue";this.size=e?e:2};n=n.HyperlinkCanvas.prototype=new n._Canvas;n.openInNewWindow=!0;n.hoverImage=E;n.drawChildExtras=function(x){this.e&&(this.hoverImage?x.drawImage(this.hoverImage,0,0):(x.strokeStyle=this.color,x.lineWidth=2*this.size,x.strokeRect(0,0,this.width,this.height)))};n.setHoverImage=function(x){this.hoverImage=new Image;this.hoverImage.src=x};n.click=function(x){this.e=
E;this.repaint();this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction};n.mouseout=function(x){this.e=E;this.repaint()};n.mouseover=function(x){this.e=x;this.repaint()}})(ChemDoodle);
(function(n,E,x,v,k){n.MolGrabberCanvas=function(p,d,e){p&&this.create(p,d,e);d=[];d.push('<br><input type="text" id="');d.push(p);d.push('_query" size="32" value="" />');d.push(this.getInputFields());v.getElementById(p);x("#"+p).after(d.join(""));var c=this;x("#"+p+"_submit").click(function(){c.search()});x("#"+p+"_query").keypress(function(a){13===a.which&&c.search()});this.emptyMessage="Enter search term below";this.repaint()};n=n.MolGrabberCanvas.prototype=new n._Canvas;n.setSearchTerm=function(p){x("#"+
this.id+"_query").val(p);this.search()};n.getInputFields=function(){var p=[];p.push("<br><nobr>");p.push('<select id="');p.push(this.id);p.push('_select">');p.push('<option value="chemexper">ChemExper');p.push('<option value="chemspider">ChemSpider');p.push('<option value="pubchem" selected>PubChem');p.push("</select>");p.push('<button type="button" id="');p.push(this.id);p.push('_submit">Show Molecule</button>');p.push("</nobr>");return p.join("")};n.search=function(){this.emptyMessage="Searching...";
this.clear();var p=this;E.getMoleculeFromDatabase(x("#"+this.id+"_query").val(),{database:x("#"+this.id+"_select").val()},function(d){p.loadMolecule(d)})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document);
(function(n,E,x,v){var k=[],p=[1,0,0],d=[0,1,0],e=[0,0,1];n.RotatorCanvas=function(c,a,f,m){c&&this.create(c,a,f);this.rotate3D=m};n=n.RotatorCanvas.prototype=new n._AnimatorCanvas;E=E.PI/15;n.xIncrement=E;n.yIncrement=E;n.zIncrement=E;n.nextFrame=function(c){if(0===this.molecules.length&&0===this.shapes.length)this.stopAnimation();else if(c/=1E3,this.rotate3D){x.identity(k);x.rotate(k,this.xIncrement*c,p);x.rotate(k,this.yIncrement*c,d);x.rotate(k,this.zIncrement*c,e);c=0;for(var a=this.molecules.length;c<
a;c++){for(var f=this.molecules[c],m=0,q=f.atoms.length;m<q;m++){var l=f.atoms[m],r=[l.x-this.width/2,l.y-this.height/2,l.z];x.multiplyVec3(k,r);l.x=r[0]+this.width/2;l.y=r[1]+this.height/2;l.z=r[2]}m=0;for(q=f.rings.length;m<q;m++)f.rings[m].center=f.rings[m].getCenter();this.styles.atoms_display&&this.styles.atoms_circles_2D&&f.sortAtomsByZ();this.styles.bonds_display&&this.styles.bonds_clearOverlaps_2D&&f.sortBondsByZ()}c=0;for(a=this.shapes.length;c<a;c++)for(f=this.shapes[c].getPoints(),m=0,
q=f.length;m<q;m++)l=f[m],r=[l.x-this.width/2,l.y-this.height/2,0],x.multiplyVec3(k,r),l.x=r[0]+this.width/2,l.y=r[1]+this.height/2}else this.styles.rotateAngle+=this.zIncrement*c};n.dblclick=function(c){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,ChemDoodle.lib.mat4);
(function(n,E,x,v){n.SlideshowCanvas=function(k,p,d){k&&this.create(k,p,d)};n=n.SlideshowCanvas.prototype=new n._AnimatorCanvas;n.frames=[];n.curIndex=0;n.timeout=5E3;n.alpha=0;n.innerHandle=v;n.phase=0;n.drawChildExtras=function(k){var p=x.getRGB(this.styles.backgroundColor,255);k.fillStyle="rgba("+p[0]+", "+p[1]+", "+p[2]+", "+this.alpha+")";k.fillRect(0,0,this.width,this.height)};n.nextFrame=function(k){if(0===this.frames.length)this.stopAnimation();else{this.phase=0;var p=this,d=1;this.innerHandle=
setInterval(function(){p.alpha=d/15;p.repaint();15===d&&p.breakInnerHandle();d++},33)}};n.breakInnerHandle=function(){this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=v);if(0===this.phase){this.curIndex++;this.curIndex>this.frames.length-1&&(this.curIndex=0);this.alpha=1;var k=this.frames[this.curIndex];this.loadContent(k.mols,k.shapes);this.phase=1;var p=this,d=1;this.innerHandle=setInterval(function(){p.alpha=(15-d)/15;p.repaint();15===d&&p.breakInnerHandle();d++},33)}else 1===
this.phase&&(this.alpha=0,this.repaint())};n.addFrame=function(k,p){0===this.frames.length&&this.loadContent(k,p);this.frames.push({mols:k,shapes:p})}})(ChemDoodle,ChemDoodle.animations,ChemDoodle.math);
(function(n,E,x,v,k,p){n.TransformCanvas=function(d,e,c,a){d&&this.create(d,e,c);this.rotate3D=a};n=n.TransformCanvas.prototype=new n._Canvas;n.lastPoint=p;n.rotationMultMod=1.3;n.lastPinchScale=1;n.lastGestureRotate=0;n.mousedown=function(d){this.lastPoint=d.p};n.dblclick=function(d){this.center();this.repaint()};n.drag=function(d){if(!this.lastPoint.multi){if(E.ALT){var e=new x.Point(d.p.x,d.p.y);e.sub(this.lastPoint);for(var c=0,a=this.molecules.length;c<a;c++){for(var f=this.molecules[c],m=0,
q=f.atoms.length;m<q;m++)f.atoms[m].add(e);f.check()}c=0;for(a=this.shapes.length;c<a;c++)for(f=this.shapes[c].getPoints(),m=0,q=f.length;m<q;m++)f[m].add(e);this.lastPoint=d.p}else if(!0===this.rotate3D)for(e=v.max(this.width/4,this.height/4),c=(d.p.x-this.lastPoint.x)/e*this.rotationMultMod,a=-(d.p.y-this.lastPoint.y)/e*this.rotationMultMod,e=[],k.identity(e),k.rotate(e,a,[1,0,0]),k.rotate(e,c,[0,1,0]),c=0,a=this.molecules.length;c<a;c++){f=this.molecules[c];m=0;for(q=f.atoms.length;m<q;m++){var l=
f.atoms[m],r=[l.x-this.width/2,l.y-this.height/2,l.z];k.multiplyVec3(e,r);l.x=r[0]+this.width/2;l.y=r[1]+this.height/2;l.z=r[2]}m=0;for(q=f.rings.length;m<q;m++)f.rings[m].center=f.rings[m].getCenter();this.lastPoint=d.p;this.styles.atoms_display&&this.styles.atoms_circles_2D&&f.sortAtomsByZ();this.styles.bonds_display&&this.styles.bonds_clearOverlaps_2D&&f.sortBondsByZ()}else c=new x.Point(this.width/2,this.height/2),e=c.angle(this.lastPoint),c=c.angle(d.p),this.styles.rotateAngle-=c-e,this.lastPoint=
d.p;this.repaint()}};n.mousewheel=function(d,e){this.styles.scale+=e/50;.01>this.styles.scale&&(this.styles.scale=.01);this.repaint()};n.multitouchmove=function(d,e){if(2===e)if(this.lastPoint.multi){e=new x.Point(d.p.x,d.p.y);e.sub(this.lastPoint);for(var c=0,a=this.molecules.length;c<a;c++){for(var f=this.molecules[c],m=0,q=f.atoms.length;m<q;m++)f.atoms[m].add(e);f.check()}c=0;for(a=this.shapes.length;c<a;c++)for(f=this.shapes[c].getPoints(),m=0,q=f.length;m<q;m++)f[m].add(e);this.lastPoint=d.p;
this.lastPoint.multi=!0;this.repaint()}else this.lastPoint=d.p,this.lastPoint.multi=!0};n.gesturechange=function(d){0!==d.originalEvent.scale-this.lastPinchScale&&(this.styles.scale*=d.originalEvent.scale/this.lastPinchScale,.01>this.styles.scale&&(this.styles.scale=.01),this.lastPinchScale=d.originalEvent.scale);if(0!==this.lastGestureRotate-d.originalEvent.rotation){for(var e=(this.lastGestureRotate-d.originalEvent.rotation)/180*v.PI,c=new x.Point(this.width/2,this.height/2),a=0,f=this.molecules.length;a<
f;a++){for(var m=this.molecules[a],q=0,l=m.atoms.length;q<l;q++){var r=m.atoms[q],y=c.distance(r),w=c.angle(r)+e;r.x=c.x+y*v.cos(w);r.y=c.y-y*v.sin(w)}m.check()}this.lastGestureRotate=d.originalEvent.rotation}this.repaint()};n.gestureend=function(d){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,ChemDoodle.lib.mat4);
(function(n,E,x){n.ViewerCanvas=function(v,k,p){v&&this.create(v,k,p)};n.ViewerCanvas.prototype=new n._Canvas;(n.ViewerCanvas.prototype=new n._Canvas).checksOnAction=function(v){if(v&&this.doChecks){for(var k,p=[],d=[],e=[],c=0,a=this.shapes.length;c<a;c++){var f=this.shapes[c];f instanceof E.d2.AtomMapping?(f.error=!1,p.push(f)):f instanceof E.d2.Line&&!k?k=f:f instanceof E.d2.RepeatUnit?(f.error=!1,d.push(f)):f instanceof E.d2.VAP&&(f.error=!1,e.push(f))}k=0;for(c=p.length;k<c;k++){a=p[k];a.label=
(k+1).toString();f=k+1;for(var m=p.length;f<m;f++){var q=p[f];if(a.o1===q.o1||a.o2===q.o1||a.o1===q.o2||a.o2===q.o2)a.error=!0,q.error=!0}a.error||a.o1.label===a.o2.label||(a.error=!0);a.error||this.getMoleculeByAtom(a.o1)!==this.getMoleculeByAtom(a.o2)||(a.error=!0)}if(0!==d.length){p=this.getAllAtoms();k=0;for(c=p.length;k<c;k++)p[k].inBracket=!1;p=0;for(k=d.length;p<k;p++){c=d[p];c.setContents(this);if(0===c.contents.length)c.error=!0;else for(a=0,f=c.contents.length;a<f;a++)if(c.contents[a].inBracket){c.error=
!0;break}a=0;for(f=c.contents.length;a<f;a++)c.contents[a].inBracket=!0}}d=0;for(p=e.length;d<p;d++)if(c=e[d],c.substituent?0===c.attachments.length&&(c.error=!0):c.error=!0,!c.error){k=this.getMoleculeByAtom(c.attachments[0]);c.substituent.present=x;a=0;for(f=k.atoms.length;a<f;a++)k.atoms[a].present=!0;c.substituent.present&&(c.error=!0);if(!c.error)for(a=0,f=c.attachments.length;a<f;a++)if(!c.attachments[a].present){c.error=!0;break}c=0;for(a=k.atoms.length;c<a;c++)k.atoms[c].present=x}}this.doChecks=
!v}})(ChemDoodle,ChemDoodle.structures);
(function(n,E,x){n._SpectrumCanvas=function(v,k,p){v&&this.create(v,k,p)};n=n._SpectrumCanvas.prototype=new n._Canvas;n.spectrum=x;n.emptyMessage="No Spectrum Loaded or Recognized";n.loadMolecule=x;n.getMolecule=x;n.innerRepaint=function(v){this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(v,this.styles,this.width,this.height):this.emptyMessage&&(v.fillStyle="#737683",v.textAlign="center",v.textBaseline="middle",v.font="18px Helvetica, Verdana, Arial, Sans-serif",v.fillText(this.emptyMessage,
this.width/2,this.height/2))};n.loadSpectrum=function(v){this.spectrum=v;this.repaint()};n.getSpectrum=function(){return this.spectrum};n.getSpectrumCoordinates=function(v,k){return spectrum.getInternalCoordinates(v,k,this.width,this.height)}})(ChemDoodle,document);(function(n,E){n.ObserverCanvas=function(x,v,k){x&&this.create(x,v,k)};n.ObserverCanvas.prototype=new n._SpectrumCanvas})(ChemDoodle);
(function(n,E){n.OverlayCanvas=function(x,v,k){x&&this.create(x,v,k)};n=n.OverlayCanvas.prototype=new n._SpectrumCanvas;n.overlaySpectra=[];n.superRepaint=n.innerRepaint;n.innerRepaint=function(x){this.superRepaint(x);if(this.spectrum&&0<this.spectrum.data.length)for(var v=0,k=this.overlaySpectra.length;v<k;v++){var p=this.overlaySpectra[v];p&&0<p.data.length&&(p.minX=this.spectrum.minX,p.maxX=this.spectrum.maxX,p.drawPlot(x,this.styles,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,
this.spectrum.memory.offsetBottom))}};n.addSpectrum=function(x){this.spectrum?this.overlaySpectra.push(x):this.spectrum=x}})(ChemDoodle);
(function(n,E,x,v){n.PerspectiveCanvas=function(p,d,e){p&&this.create(p,d,e)};var k=n.PerspectiveCanvas.prototype=new n._SpectrumCanvas;k.dragRange=v;k.rescaleYAxisOnZoom=!0;k.lastPinchScale=1;k.mousedown=function(p){this.dragRange=new n.structures.Point(p.p.x,p.p.x)};k.mouseup=function(p){this.dragRange&&this.dragRange.x!==this.dragRange.y&&(this.dragRange.multi||(p=this.spectrum.zoom(this.dragRange.x,p.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.styles.scale=p)),this.dragRange=
v,this.repaint())};k.drag=function(p){this.dragRange&&(this.dragRange.multi?this.dragRange=v:(E.SHIFT&&(this.spectrum.translate(p.p.x-this.dragRange.x,this.width),this.dragRange.x=p.p.x),this.dragRange.y=p.p.x),this.repaint())};k.drawChildExtras=function(p){if(this.dragRange){var d=x.min(this.dragRange.x,this.dragRange.y),e=x.max(this.dragRange.x,this.dragRange.y);p.strokeStyle="gray";p.lineStyle=1;p.beginPath();for(p.moveTo(d,this.height/2);d<=e;d++)5>d%10?p.lineTo(d,x.round(this.height/2)):p.moveTo(d,
x.round(this.height/2));p.stroke()}};k.mousewheel=function(p,d){this.styles.scale-=d/10;.01>this.styles.scale&&(this.styles.scale=.01);this.repaint()};k.dblclick=function(p){this.spectrum.setup();this.styles.scale=1;this.repaint()};k.multitouchmove=function(p,d){2===d&&(this.dragRange&&this.dragRange.multi?(this.spectrum.translate(p.p.x-this.dragRange.x,this.width),this.dragRange.x=p.p.x,this.dragRange.y=p.p.x,this.repaint()):(this.dragRange=new n.structures.Point(p.p.x,p.p.x),this.dragRange.multi=
!0))};k.gesturechange=function(p){this.styles.scale*=p.originalEvent.scale/this.lastPinchScale;.01>this.styles.scale&&(this.styles.scale=.01);this.lastPinchScale=p.originalEvent.scale;this.repaint()};k.gestureend=function(p){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(n,E,x,v){n.SeekerCanvas=function(p,d,e,c){p&&this.create(p,d,e);this.seekType=c};var k=n.SeekerCanvas.prototype=new n._SpectrumCanvas;k.superRepaint=k.innerRepaint;k.innerRepaint=function(p){this.superRepaint(p);if(this.spectrum&&0<this.spectrum.data.length&&this.p){if(this.seekType===n.SeekerCanvas.SEEK_POINTER){var d=this.p;var e=this.spectrum.getInternalCoordinates(d.x,d.y)}else if(this.seekType===n.SeekerCanvas.SEEK_PLOT||this.seekType===n.SeekerCanvas.SEEK_PEAK){e=this.seekType===n.SeekerCanvas.SEEK_PLOT?
this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x);if(!e)return;d={x:this.spectrum.getTransformedX(e.x,this.styles,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(e.y/100,this.styles,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}p.fillStyle="white";p.strokeStyle=this.styles.plots_color;p.lineWidth=this.styles.plots_width;p.beginPath();p.arc(d.x,d.y,3,0,2*x.PI,!1);p.fill();
p.stroke();p.font=E.getFontString(this.styles.text_font_size,this.styles.text_font_families);p.textAlign="left";p.textBaseline="bottom";e="x:"+e.x.toFixed(3)+", y:"+e.y.toFixed(3);var c=d.x+3,a=p.measureText(e).width;c+a>this.width-2&&(c-=6+a);d=d.y;0>d-this.styles.text_font_size-2&&(d+=this.styles.text_font_size);p.fillRect(c,d-this.styles.text_font_size,a,this.styles.text_font_size);p.fillStyle="black";p.fillText(e,c,d)}};k.mouseout=function(p){this.p=v;this.repaint()};k.mousemove=function(p){this.p=
{x:p.p.x-2,y:p.p.y-3};this.repaint()};k.touchstart=function(p){this.mousemove(p)};k.touchmove=function(p){this.mousemove(p)};k.touchend=function(p){this.mouseout(p)};n.SeekerCanvas.SEEK_POINTER="pointer";n.SeekerCanvas.SEEK_PLOT="plot";n.SeekerCanvas.SEEK_PEAK="peak"})(ChemDoodle,ChemDoodle.extensions,Math);
(function(n,E,x,v,k,p,d,e,c,a,f,m,q,l){n._Canvas3D=function(y,w,A){y&&this.create(y,w,A)};a=n._Canvas3D.prototype=new n._Canvas;var r=n._Canvas.prototype;a.rotationMatrix=l;a.contentCenter=l;a.lastPoint=l;a.emptyMessage="WebGL is Unavailable!";a.lastPinchScale=1;a.lastGestureRotate=0;a.afterLoadContent=function(){for(var y=new x.Bounds,w=0,A=this.molecules.length;w<A;w++)y.expand(this.molecules[w].getBounds3D());A=f.dist([y.maxX,y.maxY,y.maxZ],[y.minX,y.minY,y.minZ])/2+1.5;Infinity===A&&(A=10);this.maxDimension=
d.max(y.maxX-y.minX,y.maxY-y.minY);y=d.min(179.9,d.max(this.styles.projectionPerspectiveVerticalFieldOfView_3D,.1));w=y/360*d.PI;var G=d.tan(w)/.8;G=A/G;var b=this.width/this.height;this.camera.fieldOfView=y;this.camera.near=G-A;this.camera.far=G+A;this.camera.aspect=b;c.translate(c.identity(this.camera.viewMatrix),[0,0,-G]);w=A/d.tan(w);this.lighting.camera.fieldOfView=y;this.lighting.camera.near=w-A;this.lighting.camera.far=w+A;this.lighting.updateView();this.setupScene()};a.renderDepthMap=function(){if(this.styles.shadow_3D&&
k.DepthShader){var y=this.gl.isEnabled(this.gl.CULL_FACE);y||this.gl.enable(this.gl.CULL_FACE);this.depthShader.useShaderProgram(this.gl);var w=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(1,1,1,0);this.lightDepthMapFramebuffer.bind(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.depthShader.setProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix);this.depthShader.enableAttribsArray(this.gl);
for(var A=0,G=this.molecules.length;A<G;A++)this.molecules[A].render(this.gl,this.styles);this.gl.flush();this.depthShader.disableAttribsArray(this.gl);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clearColor(w[0],w[1],w[2],w[3]);y||this.gl.disable(this.gl.CULL_FACE)}};a.renderExtras=function(){this.phongShader.useShaderProgram(this.gl);this.phongShader.enableAttribsArray(this.gl);for(var y=[],w=0,A=this.shapes.length;w<A;w++){var G=this.shapes[w];G instanceof k._Surface&&(!G.styles&&
1!==this.styles.surfaces_alpha||G.styles&&1!==G.styles.surfaces_alpha)?y.push(G):G.render(this.gl,this.styles)}if(0!==y.length){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);this.gl.enable(this.gl.BLEND);this.gl.depthMask(!1);w=0;for(A=y.length;w<A;w++)y[w].render(this.gl,this.styles);this.gl.depthMask(!0);this.gl.disable(this.gl.BLEND);this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)}this.phongShader.setShadow(this.gl,
!1);this.phongShader.setFogMode(this.gl,0);this.phongShader.setFlatColor(this.gl,!1);this.styles.compass_display&&(this.phongShader.setLightDirection(this.gl,[0,0,-1]),this.compass.render(this.gl,this.styles));this.phongShader.disableAttribsArray(this.gl);this.gl.flush();this.gl.enable(this.gl.BLEND);this.gl.depthMask(!1);this.labelShader.useShaderProgram(this.gl);this.labelShader.setMatrixUniforms(this.gl,this.gl.modelViewMatrix);this.labelShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);
this.labelShader.setDimension(this.gl,this.gl.canvas.clientWidth,this.gl.canvas.clientHeight);this.labelShader.enableAttribsArray(this.gl);this.styles.atoms_displayLabels_3D&&this.label3D.render(this.gl,this.styles,this.getMolecules());if(this.styles.measurement_displayText_3D)for(y=0,w=this.shapes.length;y<w;y++)A=this.shapes[y],A.renderText&&A.renderText(this.gl,this.styles);this.styles.compass_display&&this.styles.compass_displayText_3D&&this.compass.renderAxis(this.gl);this.labelShader.disableAttribsArray(this.gl);
this.gl.disable(this.gl.BLEND);this.gl.depthMask(!0);this.gl.flush();this.drawChildExtras&&this.drawChildExtras(this.gl);this.gl.flush()};a.renderColor=function(){this.phongShader.useShaderProgram(this.gl);this.gl.uniform1i(this.phongShader.shadowDepthSampleUniform,0);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.lightDepthMapTexture.texture);this.phongShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.phongShader.setShadow(this.gl,this.styles.shadow_3D);
this.phongShader.setFlatColor(this.gl,this.styles.flat_color_3D);this.phongShader.setGammaCorrection(this.gl,this.styles.gammaCorrection_3D);this.phongShader.setShadowTextureSize(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.phongShader.setShadowIntensity(this.gl,this.styles.shadow_intensity_3D);this.phongShader.setFogMode(this.gl,this.styles.fog_mode_3D);this.phongShader.setFogColor(this.gl,this.fogging.colorRGB);this.phongShader.setFogStart(this.gl,this.fogging.fogStart);this.phongShader.setFogEnd(this.gl,
this.fogging.fogEnd);this.phongShader.setFogDensity(this.gl,this.fogging.density);this.phongShader.setLightProjectionMatrix(this.gl,this.lighting.camera.projectionMatrix);this.phongShader.setLightDiffuseColor(this.gl,this.lighting.diffuseRGB);this.phongShader.setLightSpecularColor(this.gl,this.lighting.specularRGB);this.phongShader.setLightDirection(this.gl,this.lighting.direction);this.phongShader.enableAttribsArray(this.gl);for(var y=0,w=this.molecules.length;y<w;y++)this.molecules[y].render(this.gl,
this.styles);this.phongShader.disableAttribsArray(this.gl);this.gl.flush()};a.renderPosition=function(){this.positionShader.useShaderProgram(this.gl);this.positionShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.positionShader.enableAttribsArray(this.gl);for(var y=0,w=this.molecules.length;y<w;y++)this.molecules[y].render(this.gl,this.styles);this.positionShader.disableAttribsArray(this.gl);this.gl.flush()};a.renderNormal=function(){this.normalShader.useShaderProgram(this.gl);
this.normalShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.normalShader.enableAttribsArray(this.gl);for(var y=0,w=this.molecules.length;y<w;y++)this.molecules[y].render(this.gl,this.styles);this.normalShader.disableAttribsArray(this.gl);this.gl.flush()};a.renderSSAO=function(){this.ssaoShader.useShaderProgram(this.gl);this.ssaoShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.ssaoShader.setSampleKernel(this.gl,this.ssao.sampleKernel);this.ssaoShader.setKernelRadius(this.gl,
this.styles.ssao_kernel_radius);this.ssaoShader.setPower(this.gl,this.styles.ssao_power);this.ssaoShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.uniform1i(this.ssaoShader.positionSampleUniform,0);this.gl.uniform1i(this.ssaoShader.normalSampleUniform,1);this.gl.uniform1i(this.ssaoShader.noiseSampleUniform,2);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.positionTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);
this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture);this.gl.activeTexture(this.gl.TEXTURE2);this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssao.noiseTexture);this.gl.activeTexture(this.gl.TEXTURE0);this.ssaoShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.ssaoShader.disableAttribsArray(this.gl);this.gl.flush();this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.ssaoBlurShader.useShaderProgram(this.gl);this.ssaoBlurShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.uniform1i(this.ssaoBlurShader.aoSampleUniform,0);this.gl.uniform1i(this.ssaoBlurShader.depthSampleUniform,1);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);this.gl.bindTexture(this.gl.TEXTURE_2D,
this.depthTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.ssaoBlurShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.ssaoBlurShader.disableAttribsArray(this.gl);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.flush()};a.renderOutline=function(){this.outlineShader.useShaderProgram(this.gl);this.outlineShader.setGbufferTextureSize(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.outlineShader.setNormalThreshold(this.gl,this.styles.outline_normal_threshold);this.outlineShader.setDepthThreshold(this.gl,this.styles.outline_depth_threshold);this.outlineShader.setThickness(this.gl,this.styles.outline_thickness);this.gl.uniform1i(this.outlineShader.normalSampleUniform,0);this.gl.uniform1i(this.outlineShader.depthSampleUniform,1);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,this.normalTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);
this.gl.bindTexture(this.gl.TEXTURE_2D,this.depthTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.outlineShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.outlineShader.disableAttribsArray(this.gl);this.gl.flush()};a.deferredRender=function(){var y=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);this.gl.clearColor(0,0,0,0);this.colorFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderColor();this.positionFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderPosition();this.normalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.renderNormal();this.styles.ssao_3D&&k.SSAOShader?
(this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.renderSSAO()):(this.ssaoFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.gl.clearColor(1,1,1,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT));this.outlineFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clearColor(1,1,1,1);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.styles.outline_3D&&this.renderOutline();
this.gl.clearColor(y[0],y[1],y[2],y[3]);this.quadFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT);this.lightingShader.useShaderProgram(this.gl);this.gl.uniform1i(this.lightingShader.positionSampleUniform,0);this.gl.uniform1i(this.lightingShader.colorSampleUniform,1);this.gl.uniform1i(this.lightingShader.ssaoSampleUniform,2);this.gl.uniform1i(this.lightingShader.outlineSampleUniform,3);this.gl.activeTexture(this.gl.TEXTURE0);this.gl.bindTexture(this.gl.TEXTURE_2D,
this.positionTexture.texture);this.gl.activeTexture(this.gl.TEXTURE1);this.gl.bindTexture(this.gl.TEXTURE_2D,this.colorTexture.texture);this.gl.activeTexture(this.gl.TEXTURE2);this.gl.bindTexture(this.gl.TEXTURE_2D,this.ssaoTexture.texture);this.gl.activeTexture(this.gl.TEXTURE3);this.gl.bindTexture(this.gl.TEXTURE_2D,this.outlineTexture.texture);this.gl.activeTexture(this.gl.TEXTURE0);this.lightingShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,
0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.lightingShader.disableAttribsArray(this.gl);this.gl.flush();this.fxaaFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.bindTexture(this.gl.TEXTURE_2D,this.imageTexture.texture);this.fxaaShader.useShaderProgram(this.gl);this.fxaaShader.setBuffersize(this.gl,this.gl.drawingBufferWidth,
this.gl.drawingBufferHeight);this.fxaaShader.setAntialias(this.gl,this.styles.antialias_3D);this.fxaaShader.setEdgeThreshold(this.gl,this.styles.fxaa_edgeThreshold);this.fxaaShader.setEdgeThresholdMin(this.gl,this.styles.fxaa_edgeThresholdMin);this.fxaaShader.setSearchSteps(this.gl,this.styles.fxaa_searchSteps);this.fxaaShader.setSearchThreshold(this.gl,this.styles.fxaa_searchThreshold);this.fxaaShader.setSubpixCap(this.gl,this.styles.fxaa_subpixCap);this.fxaaShader.setSubpixTrim(this.gl,this.styles.fxaa_subpixTrim);
this.fxaaShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.fxaaShader.disableAttribsArray(this.gl);this.gl.flush();this.finalFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.renderExtras();this.gl.clearColor(y[0],y[1],y[2],y[3]);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);
this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.bindTexture(this.gl.TEXTURE_2D,this.fxaaTexture.texture);this.quadShader.useShaderProgram(this.gl);this.quadShader.enableAttribsArray(this.gl);this.gl.quadBuffer.bindBuffers(this.gl);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,this.gl.quadBuffer.vertexPositionBuffer.numItems);this.quadShader.disableAttribsArray(this.gl);this.gl.flush()};a.forwardRender=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);
this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.renderColor();this.renderExtras()};a.repaint=function(){this.gl&&(this.gl.lightViewMatrix=c.multiply(this.lighting.camera.viewMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,this.gl.modelViewMatrix=this.gl.lightViewMatrix,this.renderDepthMap(),this.gl.modelViewMatrix=c.multiply(this.camera.viewMatrix,this.rotationMatrix,[]),c.translate(this.gl.modelViewMatrix,
this.contentCenter),this.isSupportDeferred()&&(this.styles.ssao_3D||this.styles.outline_3D)?this.deferredRender():this.forwardRender())};a.pick=function(y,w,A,G){if(this.gl){var b=this.height-w;1!==this.pixelRatio&&(y*=this.pixelRatio,b*=this.pixelRatio);c.multiply(this.camera.viewMatrix,this.rotationMatrix,this.gl.modelViewMatrix);c.translate(this.gl.modelViewMatrix,this.contentCenter);this.gl.rotationMatrix=this.rotationMatrix;this.pickShader.useShaderProgram(this.gl);w=this.gl.getParameter(this.gl.COLOR_CLEAR_VALUE);
this.gl.clearColor(1,1,1,0);this.pickerFramebuffer.bind(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.pickShader.setProjectionMatrix(this.gl,this.camera.projectionMatrix);this.pickShader.enableAttribsArray(this.gl);for(var g=[],t=0,B=this.molecules.length;t<B;t++)this.molecules[t].renderPickFrame(this.gl,this.styles,g,A,G);this.pickShader.disableAttribsArray(this.gl);this.gl.flush();A=new Uint8Array(4);this.gl.readPixels(y-
2,b+2,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,A);G=l;0<A[3]&&(G=g[A[2]|A[1]<<8|A[0]<<16]);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null);this.gl.clearColor(w[0],w[1],w[2],w[3]);return G}return l};a.center=function(){for(var y=new v.Atom,w=this.molecules.length,A=0;A<w;A++)y.add3D(this.molecules[A].getCenter3D());y.x/=w;y.y/=w;y.z/=w;this.contentCenter=[-y.x,-y.y,-y.z]};a.isSupportDeferred=function(){return this.gl.textureFloatExt&&this.gl.depthTextureExt};a.create=function(y,w,A){r.create.call(this,
y,w,A);try{var G=e.getElementById(this.id);this.gl=G.getContext("webgl");this.gl||(this.gl=G.getContext("experimental-webgl"))}catch(b){}this.gl?(1!==this.pixelRatio&&this.gl.canvas.width===this.width&&(this.gl.canvas.style.width=this.width+"px",this.gl.canvas.style.height=this.height+"px",this.gl.canvas.width=this.width*this.pixelRatio,this.gl.canvas.height=this.height*this.pixelRatio),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.blendFuncSeparate(this.gl.SRC_ALPHA,
this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.clearDepth(1),this.shadowTextureSize=1024,this.rotationMatrix=c.identity([]),this.contentCenter=[0,0,0],this.camera=new k.Camera,this.label3D=new k.Label,this.lighting=new k.Light(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D),this.fogging=new k.Fog(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D),
this.gl.depthTextureExt=this.gl.getExtension("WEBGL_depth_texture")||this.gl.getExtension("WEBKIT_WEBGL_depth_texture")||this.gl.getExtension("MOZ_WEBGL_depth_texture"),this.gl.textureFloatExt=this.gl.getExtension("OES_texture_float")||this.gl.getExtension("WEBKIT_OES_texture_float")||this.gl.getExtension("MOZ_OES_texture_float"),this.ssao=new k.SSAO,this.pickerColorTexture=new k.Texture,this.pickerColorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.pickerDepthRenderbuffer=
new k.Renderbuffer,this.pickerDepthRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),this.pickerFramebuffer=new k.Framebuffer,this.pickerFramebuffer.init(this.gl),this.pickerFramebuffer.setColorTexture(this.gl,this.pickerColorTexture.texture),this.pickerFramebuffer.setDepthRenderbuffer(this.gl,this.pickerDepthRenderbuffer.renderbuffer),this.lightDepthMapTexture=new k.Texture,this.lightDepthMapRenderbuffer=new k.Renderbuffer,this.lightDepthMapFramebuffer=new k.Framebuffer,this.lightDepthMapFramebuffer.init(this.gl),
this.gl.depthTextureExt?(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.RGBA4),this.lightDepthMapFramebuffer.setColorRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer),this.lightDepthMapFramebuffer.setDepthTexture(this.gl,this.lightDepthMapTexture.texture)):(this.lightDepthMapTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA,this.gl.RGBA),this.lightDepthMapRenderbuffer.init(this.gl,this.gl.DEPTH_COMPONENT16),
this.lightDepthMapFramebuffer.setColorTexture(this.gl,this.lightDepthMapTexture.texture),this.lightDepthMapFramebuffer.setDepthRenderbuffer(this.gl,this.lightDepthMapRenderbuffer.renderbuffer)),this.isSupportDeferred()&&(this.depthTexture=new k.Texture,this.depthTexture.init(this.gl,this.gl.UNSIGNED_SHORT,this.gl.DEPTH_COMPONENT),this.colorTexture=new k.Texture,this.colorTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.positionTexture=new k.Texture,this.positionTexture.init(this.gl,this.gl.FLOAT,
this.gl.RGBA),this.normalTexture=new k.Texture,this.normalTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.ssaoTexture=new k.Texture,this.ssaoTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.outlineTexture=new k.Texture,this.outlineTexture.init(this.gl,this.gl.UNSIGNED_BYTE,this.gl.RGBA),this.fxaaTexture=new k.Texture,this.fxaaTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.imageTexture=new k.Texture,this.imageTexture.init(this.gl,this.gl.FLOAT,this.gl.RGBA),this.colorFramebuffer=
new k.Framebuffer,this.colorFramebuffer.init(this.gl),this.colorFramebuffer.setColorTexture(this.gl,this.colorTexture.texture),this.colorFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalFramebuffer=new k.Framebuffer,this.normalFramebuffer.init(this.gl),this.normalFramebuffer.setColorTexture(this.gl,this.normalTexture.texture),this.normalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.positionFramebuffer=new k.Framebuffer,this.positionFramebuffer.init(this.gl),
this.positionFramebuffer.setColorTexture(this.gl,this.positionTexture.texture),this.positionFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.ssaoFramebuffer=new k.Framebuffer,this.ssaoFramebuffer.init(this.gl),this.ssaoFramebuffer.setColorTexture(this.gl,this.ssaoTexture.texture),this.outlineFramebuffer=new k.Framebuffer,this.outlineFramebuffer.init(this.gl),this.outlineFramebuffer.setColorTexture(this.gl,this.outlineTexture.texture),this.fxaaFramebuffer=new k.Framebuffer,this.fxaaFramebuffer.init(this.gl),
this.fxaaFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.quadFramebuffer=new k.Framebuffer,this.quadFramebuffer.init(this.gl),this.quadFramebuffer.setColorTexture(this.gl,this.imageTexture.texture),this.finalFramebuffer=new k.Framebuffer,this.finalFramebuffer.init(this.gl),this.finalFramebuffer.setColorTexture(this.gl,this.fxaaTexture.texture),this.finalFramebuffer.setDepthTexture(this.gl,this.depthTexture.texture),this.normalShader=new k.NormalShader,this.normalShader.init(this.gl),
this.positionShader=new k.PositionShader,this.positionShader.init(this.gl),k.SSAOShader&&(this.ssaoShader=new k.SSAOShader,this.ssaoShader.init(this.gl),this.ssaoBlurShader=new k.SSAOBlurShader,this.ssaoBlurShader.init(this.gl)),this.outlineShader=new k.OutlineShader,this.outlineShader.init(this.gl),this.lightingShader=new k.LightingShader,this.lightingShader.init(this.gl),this.fxaaShader=new k.FXAAShader,this.fxaaShader.init(this.gl),this.quadShader=new k.QuadShader,this.quadShader.init(this.gl)),
this.labelShader=new k.LabelShader,this.labelShader.init(this.gl),this.pickShader=new k.PickShader,this.pickShader.init(this.gl),this.phongShader=new k.PhongShader,this.phongShader.init(this.gl),k.DepthShader&&(this.depthShader=new k.DepthShader,this.depthShader.init(this.gl)),this.textTextImage=new k.TextImage,this.textTextImage.init(this.gl),this.gl.textImage=new k.TextImage,this.gl.textImage.init(this.gl),this.gl.textMesh=new k.TextMesh,this.gl.textMesh.init(this.gl),this.gl.material=new k.Material,
this.setupScene()):this.displayMessage()};a.displayMessage=function(){var y=e.getElementById(this.id);y.getContext&&(y=y.getContext("2d"),this.styles.backgroundColor&&(y.fillStyle=this.styles.backgroundColor,y.fillRect(0,0,this.width,this.height)),this.emptyMessage&&(y.fillStyle="#737683",y.textAlign="center",y.textBaseline="middle",y.font="18px Helvetica, Verdana, Arial, Sans-serif",y.fillText(this.emptyMessage,this.width/2,this.height/2)))};a.renderText=function(y,w){var A={position:[],texCoord:[],
translation:[]};this.textTextImage.pushVertexData(y,w,0,A);this.gl.textMesh.storeData(this.gl,A.position,A.texCoord,A.translation);this.textTextImage.useTexture(this.gl);this.gl.textMesh.render(this.gl)};a.setupScene=function(){if(this.gl){var y=m("#"+this.id),w=this.styles.backgroundColor?this.styles.backgroundColor:"transparent";y.css("background-color",w);y="transparent"===w?[0,0,0,0]:x.getRGB(w,1);this.gl.clearColor(y[0],y[1],y[2],4==y.length?y[3]:1);this.styles.cullBackFace_3D?this.gl.enable(this.gl.CULL_FACE):
this.gl.disable(this.gl.CULL_FACE);this.gl.sphereBuffer=new k.Sphere(1,this.styles.atoms_resolution_3D,this.styles.atoms_resolution_3D);this.gl.starBuffer=new k.Star;this.gl.cylinderBuffer=new k.Cylinder(1,1,this.styles.bonds_resolution_3D);this.gl.cylinderClosedBuffer=new k.Cylinder(1,1,this.styles.bonds_resolution_3D,!0);this.gl.boxBuffer=new k.Box(1,1,1);this.gl.pillBuffer=new k.Pill(this.styles.bonds_pillDiameter_3D/2,this.styles.bonds_pillHeight_3D,this.styles.bonds_pillLatitudeResolution_3D,
this.styles.bonds_pillLongitudeResolution_3D);this.gl.lineBuffer=new k.Line;this.gl.lineArrowBuffer=new k.LineArrow;this.gl.arrowBuffer=new k.Arrow(.3,this.styles.compass_resolution_3D);this.gl.quadBuffer=new k.Quad;this.gl.textImage.updateFont(this.gl,this.styles.text_font_size,this.styles.text_font_families,this.styles.text_font_bold,this.styles.text_font_italic,this.styles.text_font_stroke_3D);this.lighting.lightScene(this.styles.lightDiffuseColor_3D,this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D);
this.fogging.fogScene(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D);this.compass=new k.Compass(this.gl,this.styles);this.lightDepthMapTexture.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.lightDepthMapRenderbuffer.setParameter(this.gl,this.shadowTextureSize,this.shadowTextureSize);this.pickerColorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.pickerDepthRenderbuffer.setParameter(this.gl,
this.gl.drawingBufferWidth,this.gl.drawingBufferHeight);this.isSupportDeferred()&&(this.depthTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.colorTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.imageTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.positionTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.normalTexture.setParameter(this.gl,
this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssaoTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.outlineTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.fxaaTexture.setParameter(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.ssao.initSampleKernel(this.styles.ssao_kernel_samples),this.ssao.initNoiseTexture(this.gl));this.camera.updateProjectionMatrix(this.styles.projectionPerspective_3D);
y=0;for(w=this.molecules.length;y<w;y++){var A=this.molecules[y];A.labelMesh instanceof k.TextMesh||(A.labelMesh=new k.TextMesh,A.labelMesh.init(this.gl));if(A.chains){A.ribbons=[];A.cartoons=[];A.tubes=[];A.pipePlanks=[];for(var G=0,b=A.chains.length;G<b;G++){for(var g=A.chains[G],t=0,B=g.length-1;t<B;t++)g[t].Test=t;t=3<g.length&&p[g[3].name]&&"#BEA06E"===p[g[3].name].aminoColor;if(0<g.length&&!g[0].lineSegments){B=0;for(var F=g.length-1;B<F;B++)g[B].setup(g[B+1].cp1,t?1:this.styles.proteins_horizontalResolution);
if(!t)for(B=1,F=g.length-1;B<F;B++)E.vec3AngleFrom(g[B-1].D,g[B].D)>d.PI/2&&(g[B].guidePointsSmall.reverse(),g[B].guidePointsLarge.reverse(),f.scale(g[B].D,-1));B=2;for(F=g.length-3;B<F;B++)g[B].computeLineSegments(g[B-2],g[B-1],g[B+1],!t,t?this.styles.nucleics_verticalResolution:this.styles.proteins_verticalResolution);g.pop();g.pop();g.pop();g.shift();g.shift()}B=x.hsl2rgb(1===b?.5:G/b,1,.5);B="rgb("+B[0]+","+B[1]+","+B[2]+")";g.chainColor=B;t?(g=new k.Tube(g,this.styles.nucleics_tubeThickness,
this.styles.nucleics_tubeResolution_3D),g.chainColor=B,A.tubes.push(g)):(t=new k.PipePlank(g,this.styles),A.pipePlanks.push(t),t=g.shift(),F={front:new k.Ribbon(g,this.styles.proteins_ribbonThickness,!1),back:new k.Ribbon(g,-this.styles.proteins_ribbonThickness,!1)},F.front.chainColor=B,F.back.chainColor=B,A.ribbons.push(F),F={front:new k.Ribbon(g,this.styles.proteins_ribbonThickness,!0),back:new k.Ribbon(g,-this.styles.proteins_ribbonThickness,!0)},F.front.chainColor=B,F.back.chainColor=B,A.cartoons.push(F),
g.unshift(t))}}}this.label3D.updateVerticesBuffer(this.gl,this.getMolecules(),this.styles);if(this instanceof n.MovieCanvas3D&&this.frames)for(y=0,w=this.frames.length;y<w;y++){A=this.frames[y];G=0;for(b=A.mols.length;G<b;G++)g=A.mols[G],g.labelMesh instanceof v.d3.TextMesh||(g.labelMesh=new v.d3.TextMesh,g.labelMesh.init(this.gl));this.label3D.updateVerticesBuffer(this.gl,A.mols,this.styles)}}};a.updateScene=function(){this.camera.updateProjectionMatrix(this.styles.projectionPerspective_3D);this.lighting.lightScene(this.styles.lightDiffuseColor_3D,
this.styles.lightSpecularColor_3D,this.styles.lightDirection_3D);this.fogging.fogScene(this.styles.fog_color_3D||this.styles.backgroundColor,this.styles.fog_start_3D,this.styles.fog_end_3D,this.styles.fog_density_3D);this.repaint()};a.mousedown=function(y){this.lastPoint=y.p};a.mouseup=function(y){this.lastPoint=l};a.rightmousedown=function(y){this.lastPoint=y.p};a.drag=function(y){if(this.lastPoint){if(n.monitor.ALT){var w=new v.Point(y.p.x,y.p.y);w.sub(this.lastPoint);var A=d.tan(this.camera.fieldOfView/
360*d.PI);A=this.height/2/this.camera.zoom/A;A=this.camera.focalLength()/A;c.translate(this.camera.viewMatrix,[w.x*A,-w.y*A,0])}else A=y.p.x-this.lastPoint.x,w=y.p.y-this.lastPoint.y,A=c.rotate(c.identity([]),A*d.PI/180,[0,1,0]),c.rotate(A,w*d.PI/180,[1,0,0]),this.rotationMatrix=c.multiply(A,this.rotationMatrix);this.lastPoint=y.p;this.repaint()}};a.mousewheel=function(y,w){0<w?this.camera.zoomIn():this.camera.zoomOut();this.updateScene()};a.multitouchmove=function(y,w){if(2===w)if(this.lastPoint&&
this.lastPoint.multi){w=new v.Point(y.p.x,y.p.y);w.sub(this.lastPoint);var A=d.tan(this.camera.fieldOfView/360*d.PI);A=this.height/2/this.camera.zoom/A;A=this.camera.focalLength()/A;c.translate(this.camera.viewMatrix,[w.x*A,-w.y*A,0]);this.lastPoint=y.p;this.repaint()}else this.lastPoint=y.p,this.lastPoint.multi=!0};a.gesturechange=function(y){if(0!==y.originalEvent.scale-this.lastPinchScale){var w=30*-(y.originalEvent.scale/this.lastPinchScale-1);if(isNaN(w))return;0<w?this.camera.zoomOut():this.camera.zoomIn();
this.updateScene();this.lastPinchScale=y.originalEvent.scale}this.repaint()};a.gestureend=function(y){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.structures.d3,ChemDoodle.RESIDUE,Math,document,ChemDoodle.lib.mat4,ChemDoodle.lib.mat3,ChemDoodle.lib.vec3,ChemDoodle.lib.jQuery,window);
(function(n,E,x,v,k){n.MolGrabberCanvas3D=function(p,d,e){p&&this.create(p,d,e);d=[];d.push('<br><input type="text" id="');d.push(p);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(p);d.push('_select">');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button type="button" id="');d.push(p);d.push('_submit">Show Molecule</button>');d.push("</nobr>");v.writeln(d.join(""));var c=this;x("#"+p+"_submit").click(function(){c.search()});
x("#"+p+"_query").keypress(function(a){13===a.which&&c.search()})};n=n.MolGrabberCanvas3D.prototype=new n._Canvas3D;n.setSearchTerm=function(p){x("#"+this.id+"_query").val(p);this.search()};n.search=function(){var p=this;E.getMoleculeFromDatabase(x("#"+this.id+"_query").val(),{database:x("#"+this.id+"_select").val(),dimension:3},function(d){p.loadMolecule(d)})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.lib.jQuery,document);
(function(n,E,x){n.MovieCanvas3D=function(v,k,p){v&&this.create(v,k,p);this.frames=[]};n.MovieCanvas3D.PLAY_ONCE=0;n.MovieCanvas3D.PLAY_LOOP=1;n.MovieCanvas3D.PLAY_SPRING=2;x=n.MovieCanvas3D.prototype=new n._Canvas3D;x.timeout=50;x.frameNumber=0;x.playMode=2;x.reverse=!1;x.startAnimation=n._AnimatorCanvas.prototype.startAnimation;x.stopAnimation=n._AnimatorCanvas.prototype.stopAnimation;x.isRunning=n._AnimatorCanvas.prototype.isRunning;x.dblclick=n.RotatorCanvas.prototype.dblclick;x.nextFrame=function(v){v=
this.frames[this.frameNumber];this.molecules=v.mols;this.shapes=v.shapes;2===this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.frames.length&&(2===this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0===this.playMode&&this.stopAnimation())))};x.center=function(){for(var v=new E.Atom,k=this.frames[0],p=0,d=k.mols.length;p<d;p++)v.add3D(k.mols[p].getCenter3D());v.x/=k.mols.length;v.y/=
k.mols.length;k=new E.Atom;k.sub3D(v);v=0;for(p=this.frames.length;v<p;v++){d=this.frames[v];for(var e=0,c=d.mols.length;e<c;e++)for(var a=d.mols[e],f=0,m=a.atoms.length;f<m;f++)a.atoms[f].add3D(k)}};x.addFrame=function(v,k){this.frames.push({mols:v,shapes:k})}})(ChemDoodle,ChemDoodle.structures);
(function(n,E,x,v){var k=[],p=[1,0,0],d=[0,1,0],e=[0,0,1];n.RotatorCanvas3D=function(a,f,m){a&&this.create(a,f,m)};var c=n.RotatorCanvas3D.prototype=new n._Canvas3D;c.timeout=33;E=E.PI/15;c.xIncrement=E;c.yIncrement=E;c.zIncrement=E;c.startAnimation=n._AnimatorCanvas.prototype.startAnimation;c.stopAnimation=n._AnimatorCanvas.prototype.stopAnimation;c.isRunning=n._AnimatorCanvas.prototype.isRunning;c.dblclick=n.RotatorCanvas.prototype.dblclick;c.mousedown=v;c.rightmousedown=v;c.drag=v;c.mousewheel=
v;c.nextFrame=function(a){0===this.molecules.length&&0===this.shapes.length?this.stopAnimation():(x.identity(k),a/=1E3,x.rotate(k,this.xIncrement*a,p),x.rotate(k,this.yIncrement*a,d),x.rotate(k,this.zIncrement*a,e),x.multiply(this.rotationMatrix,k))}})(ChemDoodle,Math,ChemDoodle.lib.mat4);(function(n,E){n.TransformCanvas3D=function(x,v,k){x&&this.create(x,v,k)};n.TransformCanvas3D.prototype=new n._Canvas3D})(ChemDoodle);
(function(n,E){n.ViewerCanvas3D=function(x,v,k){x&&this.create(x,v,k)};n=n.ViewerCanvas3D.prototype=new n._Canvas3D;n.mousedown=E;n.rightmousedown=E;n.drag=E;n.mousewheel=E})(ChemDoodle);
(function(n,E,x,v,k){function p(d,e,c,a){this.element=d;this.x=e;this.y=c;this.dimension=a;this.allowMultipleSelections=!1}n.PeriodicTableCanvas=function(d,e){this.padding=5;d&&this.create(d,18*e+2*this.padding,10*e+2*this.padding);this.cellDimension=e?e:20;this.setupTable();this.repaint()};v=n.PeriodicTableCanvas.prototype=new n._Canvas;v.loadMolecule=k;v.getMolecule=k;v.getHoveredElement=function(){return this.hovered?this.hovered.element:k};v.innerRepaint=function(d){for(var e=0,c=this.cells.length;e<
c;e++)this.drawCell(d,this.styles,this.cells[e]);this.hovered&&this.drawCell(d,this.styles,this.hovered);this.selected&&this.drawCell(d,this.styles,this.selected)};v.setupTable=function(){this.cells=[];for(var d=this.padding,e=this.padding,c=0,a=0,f=n.SYMBOLS.length;a<f;a++){18===c&&(c=0,e+=this.cellDimension,d=this.padding);var m=n.ELEMENT[n.SYMBOLS[a]];if(2===m.atomicNumber)d+=16*this.cellDimension,c+=16;else if(5===m.atomicNumber||13===m.atomicNumber)d+=10*this.cellDimension,c+=10;(58>m.atomicNumber||
71<m.atomicNumber&&90>m.atomicNumber||103<m.atomicNumber)&&118>=m.atomicNumber&&(this.cells.push(new p(m,d,e,this.cellDimension)),d+=this.cellDimension,c++)}e+=2*this.cellDimension;d=3*this.cellDimension+this.padding;for(c=57;104>c;c++)if(a=n.ELEMENT[n.SYMBOLS[c]],90===a.atomicNumber&&(e+=this.cellDimension,d=3*this.cellDimension+this.padding),58<=a.atomicNumber&&71>=a.atomicNumber||90<=a.atomicNumber&&103>=a.atomicNumber)this.cells.push(new p(a,d,e,this.cellDimension)),d+=this.cellDimension};v.drawCell=
function(d,e,c){var a=d.createRadialGradient(c.x+c.dimension/3,c.y+c.dimension/3,1.5*c.dimension,c.x+c.dimension/3,c.y+c.dimension/3,c.dimension/10);a.addColorStop(0,"#000000");a.addColorStop(.7,c.element.jmolColor);a.addColorStop(1,"#FFFFFF");d.fillStyle=a;E.contextRoundRect(d,c.x,c.y,c.dimension,c.dimension,c.dimension/8);if(c===this.hovered||c===this.selected||c.selected)d.lineWidth=2,d.strokeStyle="#c10000",d.stroke(),d.fillStyle="white";d.fill();d.font=E.getFontString(e.text_font_size,e.text_font_families);
d.fillStyle=e.text_color;d.textAlign="center";d.textBaseline="middle";d.fillText(c.element.symbol,c.x+c.dimension/2,c.y+c.dimension/2)};v.click=function(d){this.hovered&&(this.allowMultipleSelections?this.hovered.selected=!this.hovered.selected:this.selected=this.hovered,this.repaint())};v.touchstart=function(d){this.mousemove(d)};v.mousemove=function(d){var e=d.p.x;d=d.p.y;this.hovered=k;for(var c=0,a=this.cells.length;c<a;c++){var f=this.cells[c];if(x.isBetween(e,f.x,f.x+f.dimension)&&x.isBetween(d,
f.y,f.y+f.dimension)){this.hovered=f;break}}this.repaint()};v.mouseout=function(d){this.hovered=k;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);(function(n,E,x,v){n.png={};n.png.string=function(k){return E.getElementById(k.id).toDataURL("image/png")};n.png.open=function(k){x.open(this.string(k))}})(ChemDoodle.io,document,window);(function(n,E,x){n.file={};n.file.content=function(v,k){E.get(v,"",k)}})(ChemDoodle.io,ChemDoodle.lib.jQuery);
(function(n,E,x,v,k,p,d){E.SERVER_URL="https://ichemlabs.cloud.chemdoodle.com/icl_cdc_v090000/WebHQ";E.inRelay=!1;E.asynchronous=!0;E.INFO={userAgent:navigator.userAgent,platform:navigator.platform,v_cwc:n.getVersion(),v_jQuery:k.fn.jquery,v_jQuery_ui:"N/A"};var e=new x.JSONInterpreter,c=new v.Queue;E._contactServer=function(a,f,m,q,l){if(this.inRelay)c.enqueue({call:a,content:f,options:m,callback:q,errorback:l});else{E.inRelay=!0;var r=f instanceof FormData;a=JSON.stringify({call:a,content:r?{}:
f,options:m,info:ChemDoodle.iChemLabs.INFO});r&&f.append("jsonData",JSON.stringify(a));f={dataType:"text",type:"POST",data:r?f:a,url:this.SERVER_URL,success:function(y){y=JSON.parse(y);y.message&&alert(y.message);E.inRelay=!1;q&&y.content&&!y.stop&&q(y.content);y.stop&&l&&l();c.isEmpty()||(y=c.dequeue(),E._contactServer(y.call,y.content,y.options,y.callback,y.errorback))},error:function(y,w,A){E.inRelay=!1;l&&l();c.isEmpty()||(y=c.dequeue(),E._contactServer(y.call,y.content,y.options,y.callback,y.errorback))},
xhrFields:{withCredentials:!0},async:E.asynchronous};r&&(f.processData=!1,f.contentType=!1);k.ajax(f)}};E.authenticate=function(a,f,m,q){this._contactServer("authenticate",{credential:a},f,function(l){m(l)},q)};E.balanceReaction=function(a,f,m,q){var l={};"string"===typeof a||a instanceof String?l.equation=a:l.reaction=e.contentTo(a.molecules,a.shapes);this._contactServer("balanceReaction",l,f,function(r){m(r.result,r.message)},q)};E.calculate=function(a,f,m,q){this._contactServer("calculate",{mol:e.molTo(a)},
f,function(l){m(l)},q)};E.createLewisDotStructure=function(a,f,m,q){this._contactServer("createLewisDot",{mol:e.molTo(a)},f,function(l){m(e.molFrom(l.mol))},q)};E.cir=function(a,f,m,q){this._contactServer("cir",a,f,function(l){m(e.contentFrom(l.data),l.preview)},q)};E.fileToImage=function(a,f,m,q){this._contactServer("fileToImage",a,f,function(l){m(l.imgsrc,l.width,l.height)},q)};E.generateImage=function(a,f,m,q){this._contactServer("generateImage",{mol:e.molTo(a)},f,function(l){m(l.link)},q)};E.generateIUPACName=
function(a,f,m,q){this._contactServer("generateIUPACName",{mol:e.molTo(a)},f,function(l){m(l.iupac)},q)};E.getMoleculeFromContent=function(a,f,m,q){this._contactServer("getMoleculeFromContent",{content:a},f,function(l){for(var r=!1,y=0,w=l.mol.a.length;y<w;y++)if(0!==l.mol.a[y].z){r=!0;break}if(r)for(r=0,y=l.mol.a.length;r<y;r++)l.mol.a[r].x/=20,l.mol.a[r].y/=20,l.mol.a[r].z/=20;m(e.molFrom(l.mol))},q)};E.getMoleculeFromDatabase=function(a,f,m,q){this._contactServer("getMoleculeFromDatabase",{query:a},
f,function(l){if(3===f.dimension)for(var r=0,y=l.mol.a.length;r<y;r++)l.mol.a[r].x/=20,l.mol.a[r].y/=-20,l.mol.a[r].z/=20;m(e.molFrom(l.mol))},q)};E.getOptimizedPDBStructure=function(a,f,m,q){this._contactServer("getOptimizedPDBStructure",{id:a},f,function(l){var r=l.mol?e.molFrom(l.mol):new v.Molecule;r.chains=e.chainsFrom(l.ribbons);l=0;for(var y=r.chains.length;l<y;l++)for(var w=r.chains[l],A=0,G=w.length-1;A<G;A++)w[A+1].arrow&&(w[A+1].arrow=!1,w[A].arrow=!0);r.fromJSON=!0;m(r)},q)};E.getZeoliteFromIZA=
function(a,f,m,q){this._contactServer("getZeoliteFromIZA",{query:a},f,function(l){m(ChemDoodle.readCIF(l.cif,f.xSuper,f.ySuper,f.zSuper))},q)};E.isGraphIsomorphism=function(a,f,m,q,l){this._contactServer("isGraphIsomorphism",{arrow:e.molTo(a),target:e.molTo(f)},m,function(r){q(r.value)},l)};E.isSubgraphIsomorphism=function(a,f,m,q,l){this._contactServer("isSubgraphIsomorphism",{arrow:e.molTo(a),target:e.molTo(f)},m,function(r){q(r.value)},l)};E.isSupergraphIsomorphism=function(a,f,m,q,l){this._contactServer("isSupergraphIsomorphism",
{arrow:e.molTo(a),target:e.molTo(f)},m,function(r){q(r.value)},l)};E.getSimilarityMeasure=function(a,f,m,q,l){this._contactServer("getSimilarityMeasure",{first:e.molTo(a),second:e.molTo(f)},m,function(r){q(r.value)},l)};E.kekulize=function(a,f,m,q){this._contactServer("kekulize",{mol:e.molTo(a)},f,function(l){m(e.molFrom(l.mol))},q)};E.maximumCommonSubstructure=function(a,f,m,q,l){this._contactServer("maximumCommonSubstructure",{m1:e.molTo(a),m2:e.molTo(f)},m,function(r){q(r.map)},l)};E.mechanismMatch=
function(a,f,m,q,l){this._contactServer("matchMechanism",{arrow:a,targets:f},m,function(r){q(r)},l)};E.optimize=function(a,f,m,q){this._contactServer("optimize",{mol:e.molTo(a)},f,function(l){l=e.molFrom(l.mol);if(2===f.dimension){for(var r=0,y=l.atoms.length;r<y;r++)a.atoms[r].x=l.atoms[r].x,a.atoms[r].y=l.atoms[r].y;m()}else if(3===f.dimension){r=0;for(y=l.atoms.length;r<y;r++)l.atoms[r].x/=20,l.atoms[r].y/=-20,l.atoms[r].z/=20;m(l)}},q)};E.readIUPACName=function(a,f,m,q){this._contactServer("readIUPACName",
{iupac:a},f,function(l){for(var r=[],y=0,w=l.mols.length;y<w;y++)r.push(e.molFrom(l.mols[y]));m(r,l.warning)},q)};E.readSMILES=function(a,f,m,q){this._contactServer("readSMILES",{smiles:a},f,function(l){m(e.molFrom(l.mol))},q)};E.readWLN=function(a,f,m,q){this._contactServer("readWLN",{wln:a},f,function(l){m(e.contentFrom(l.content))},q)};E.resolveCIP=function(a,f,m,q){this._contactServer("resolveCIP",{mol:e.molTo(a)},f,function(l){m(l.atoms,l.bonds)},q)};E.saveFile=function(a,f,m,q){this._contactServer("saveFile",
{mol:e.molTo(a)},f,function(l){m(l.link)},q)};E.simulate13CNMR=function(a,f,m,q){f.nucleus="C";f.isotope=13;this._contactServer("simulateNMR",{mol:e.molTo(a)},f,function(l){m(n.readJCAMP(l.jcamp))},q)};E.simulate1HNMR=function(a,f,m,q){f.nucleus="H";f.isotope=1;this._contactServer("simulateNMR",{mol:e.molTo(a)},f,function(l){m(n.readJCAMP(l.jcamp))},q)};E.simulateMassParentPeak=function(a,f,m,q){this._contactServer("simulateMassParentPeak",{mol:e.molTo(a)},f,function(l){m(n.readJCAMP(l.jcamp))},q)};
E.stoichiometry=function(a,f,m,q){var l={};"string"===typeof a||a instanceof String?l.equation=a:a.molecules!==d?l.reaction=e.contentTo(a.molecules,a.shapes):a.table!==d&&(l.table=a.table);this._contactServer("stoichiometry",l,f,function(r){m(r.table,r.message)},q)};E.writeSMILES=function(a,f,m,q){this._contactServer("writeSMILES",{mol:e.molTo(a)},f,function(l){m(l.smiles)},q)};E.version=function(a,f,m){this._contactServer("version",{},a,function(q){f(q.value)},m)};E.checkForUpdates=function(a){this._contactServer("checkForUpdates",
{value:p.href},a,function(f){},function(){})}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.lib.jQuery,location);
